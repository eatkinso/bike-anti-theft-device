ARM GAS  /tmp/ccw9RQ3F.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"LoRaMacClassB.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.LoRaMacClassBInit,"ax",%progbits
  16              		.align	1
  17              		.global	LoRaMacClassBInit
  18              		.arch armv7e-m
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	LoRaMacClassBInit:
  25              	.LVL0:
  26              	.LFB104:
  27              		.file 1 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c"
   1:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
   2:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \file      LoRaMacClassB.c
   3:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
   4:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief     LoRa MAC Class B layer implementation
   5:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
   6:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \copyright Revised BSD License, see section \ref LICENSE.
   7:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
   8:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \code
   9:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *                ______                              _
  10:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *               / _____)             _              | |
  11:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              ( (____  _____ ____ _| |_ _____  ____| |__
  12:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *               \____ \| ___ |    (_   _) ___ |/ ___)  _ \
  13:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *               _____) ) ____| | | || |_| ____( (___| | | |
  14:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              (______/|_____)_|_|_| \__)_____)\____)_| |_|
  15:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              (C)2013 Semtech
  16:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
  17:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *               ___ _____ _   ___ _  _____ ___  ___  ___ ___
  18:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              / __|_   _/_\ / __| |/ / __/ _ \| _ \/ __| __|
  19:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              \__ \ | |/ _ \ (__| ' <| _| (_) |   / (__| _|
  20:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              |___/ |_/_/ \_\___|_|\_\_| \___/|_|_\\___|___|
  21:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *              embedded.connectivity.solutions===============
  22:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
  23:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \endcode
  24:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
  25:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \author    Miguel Luis ( Semtech )
  26:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
  27:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \author    Gregory Cristian ( Semtech )
  28:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
  29:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \author    Daniel Jaeckle ( STACKFORCE )
  30:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
  31:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /**
ARM GAS  /tmp/ccw9RQ3F.s 			page 2


  32:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   ******************************************************************************
  33:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   *
  34:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   *          Portions COPYRIGHT 2020 STMicroelectronics
  35:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   *
  36:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   * @file    LoRaMacClassB.c
  37:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   * @author  MCD Application Team
  38:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   * @brief   LoRa MAC Class B layer implementation
  39:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   ******************************************************************************
  40:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   */
  41:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include <math.h>
  42:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "utilities.h"
  43:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "secure-element.h"
  44:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "LoRaMac.h"
  45:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "LoRaMacClassB.h"
  46:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "LoRaMacClassBNvm.h"
  47:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "LoRaMacClassBConfig.h"
  48:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "LoRaMacCrypto.h"
  49:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "LoRaMacConfirmQueue.h"
  50:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "radio.h"
  51:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #include "Region.h"
  52:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
  53:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
  54:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
  55:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
  56:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*
  57:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * LoRaMac Class B Context structure
  58:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
  59:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** typedef struct sLoRaMacClassBCtx
  60:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
  61:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  62:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Class B ping slot context
  63:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  64:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PingSlotContext_t PingSlotCtx;
  65:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  66:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Class B beacon context
  67:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  68:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     BeaconContext_t BeaconCtx;
  69:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  70:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * State of the beaconing mechanism
  71:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  72:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     BeaconState_t BeaconState;
  73:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  74:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * State of the ping slot mechanism
  75:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  76:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PingSlotState_t PingSlotState;
  77:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  78:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * State of the multicast slot mechanism
  79:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  80:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PingSlotState_t MulticastSlotState;
  81:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  82:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Timer for CLASS B beacon acquisition and tracking.
  83:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  84:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerEvent_t BeaconTimer;
  85:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  86:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Timer for CLASS B ping slot timer.
  87:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  88:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerEvent_t PingSlotTimer;
ARM GAS  /tmp/ccw9RQ3F.s 			page 3


  89:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  90:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Timer for CLASS B multicast ping slot timer.
  91:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  92:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerEvent_t MulticastSlotTimer;
  93:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  94:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Container for the callbacks related to class b.
  95:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
  96:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBCallback_t LoRaMacClassBCallbacks;
  97:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /*!
  98:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * Data structure which holds the parameters which needs to be set
  99:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     * in class b operation.
 100:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     */
 101:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBParams_t LoRaMacClassBParams;
 102:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** } LoRaMacClassBCtx_t;
 103:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 104:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 105:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * Defines the LoRaMac radio events status
 106:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 107:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** typedef union uLoRaMacClassBEvents
 108:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 109:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint32_t Value;
 110:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     struct sEvents
 111:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 112:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         uint32_t Beacon        : 1;
 113:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         uint32_t PingSlot      : 1;
 114:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         uint32_t MulticastSlot : 1;
 115:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }Events;
 116:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }LoRaMacClassBEvents_t;
 117:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 118:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** LoRaMacClassBEvents_t LoRaMacClassBEvents = { .Value = 0 };
 119:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 120:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*
 121:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * Module context.
 122:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 123:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static LoRaMacClassBCtx_t Ctx;
 124:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 125:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 126:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * Data structure which holds the parameters which needs to be stored
 127:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * in the NVM.
 128:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 129:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static LoRaMacClassBNvmData_t* ClassBNvm;
 130:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 131:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /* ST_WORKAROUND_BEGIN: Move timer function (ClassB specific) */
 132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Computes the temperature compensation for a period of time on a
 134:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *        specific temperature.
 135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 136:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] period Time period to compensate
 137:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] temperature Current temperature
 138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \retval Compensated time period
 140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static TimerTime_t TimerTempCompensation( TimerTime_t period, float temperature )
 142:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 143:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   float k = RTC_TEMP_COEFFICIENT;
 144:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   float kDev = RTC_TEMP_DEV_COEFFICIENT;
 145:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   float t = RTC_TEMP_TURNOVER;
ARM GAS  /tmp/ccw9RQ3F.s 			page 4


 146:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   float tDev = RTC_TEMP_DEV_TURNOVER;
 147:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   float interim = 0.0f;
 148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   float ppm = 0.0f;
 149:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 150:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   if (k < 0.0f)
 151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   {
 152:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ppm = (k - kDev);
 153:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   }
 154:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   else
 155:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   {
 156:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ppm = (k + kDev);
 157:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   }
 158:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   interim = (temperature - (t - tDev));
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   ppm *=  interim * interim;
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 161:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   // Calculate the drift in time
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   interim = ((float) period * ppm) / 1000000.0f;
 163:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   // Calculate the resulting time period
 164:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   interim += period;
 165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   interim = floor(interim);
 166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   if (interim < 0.0f)
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   {
 169:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     interim = (float)period;
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   }
 171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   // Calculate the resulting period
 173:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****   return ( UTIL_TIMER_Time_t ) interim;
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /* ST_WORKAROUND_END */
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 178:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * Computes the Ping Offset
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN]  beaconTime      - Time of the recent received beacon
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN]  address         - Frame address
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN]  pingPeriod      - Ping period of the node
 183:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [OUT] pingOffset      - Pseudo random ping offset
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void ComputePingOffset( uint64_t beaconTime, uint32_t address, uint16_t pingPeriod, uint16_t
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint8_t buffer[16];
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint8_t cipher[16];
 189:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint32_t result = 0;
 190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     /* Refer to chapter 15.2 of the LoRaWAN specification v1.1. The beacon time
 191:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****      * GPS time in seconds modulo 2^32
 192:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****      */
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint32_t time = ( beaconTime % ( ( ( uint64_t ) 1 ) << 32 ) );
 194:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     memset1( buffer, 0, 16 );
 196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     memset1( cipher, 0, 16 );
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[0] = ( time ) & 0xFF;
 199:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[1] = ( time >> 8 ) & 0xFF;
 200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[2] = ( time >> 16 ) & 0xFF;
 201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[3] = ( time >> 24 ) & 0xFF;
 202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
ARM GAS  /tmp/ccw9RQ3F.s 			page 5


 203:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[4] = ( address ) & 0xFF;
 204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[5] = ( address >> 8 ) & 0xFF;
 205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[6] = ( address >> 16 ) & 0xFF;
 206:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     buffer[7] = ( address >> 24 ) & 0xFF;
 207:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 208:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     SecureElementAesEncrypt( buffer, 16, SLOT_RAND_ZERO_KEY, cipher );
 209:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     result = ( ( ( uint32_t ) cipher[0] ) + ( ( ( uint32_t ) cipher[1] ) * 256 ) );
 211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 212:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     *pingOffset = ( uint16_t )( result % pingPeriod );
 213:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 214:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 215:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 216:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Calculates the downlink frequency for a given channel.
 217:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 218:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] channel The channel according to the channel plan.
 219:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 220:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] isBeacon Set to true, if the function shall
 221:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *                      calculate the frequency for a beacon.
 222:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 223:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \retval The downlink frequency
 224:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 225:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static uint32_t CalcDownlinkFrequency( uint8_t channel, bool isBeacon )
 226:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 227:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     GetPhyParams_t getPhy;
 228:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PhyParam_t phyParam;
 229:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 230:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     getPhy.Attribute = PHY_PING_SLOT_CHANNEL_FREQ;
 231:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 232:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( isBeacon == true )
 233:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 234:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         getPhy.Attribute = PHY_BEACON_CHANNEL_FREQ;
 235:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 236:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     getPhy.Channel = channel;
 237:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
 238:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 239:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return phyParam.Value;
 240:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 241:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 242:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 243:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Calculates the downlink channel for the beacon and for
 244:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *        ping slot downlinks.
 245:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 246:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] devAddr The address of the device. Assign 0 if its a beacon.
 247:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 248:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] beaconTime The beacon time of the beacon.
 249:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] beaconInterval The beacon interval.
 251:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] isBeacon Set to true, if the function shall
 253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *                      calculate the frequency for a beacon.
 254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 255:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \retval The downlink channel
 256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static uint32_t CalcDownlinkChannelAndFrequency( uint32_t devAddr, TimerTime_t beaconTime,
 258:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                  TimerTime_t beaconInterval, bool isBeacon )
 259:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
ARM GAS  /tmp/ccw9RQ3F.s 			page 6


 260:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     GetPhyParams_t getPhy;
 261:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PhyParam_t phyParam;
 262:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint32_t channel = 0;
 263:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint8_t nbChannels = 0;
 264:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint8_t offset = 0;
 265:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 266:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Default initialization - ping slot channels
 267:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     getPhy.Attribute = PHY_PING_SLOT_NB_CHANNELS;
 268:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 269:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( isBeacon == true )
 270:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 271:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Beacon channels
 272:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         getPhy.Attribute = PHY_BEACON_NB_CHANNELS;
 273:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 274:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
 275:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     nbChannels = ( uint8_t ) phyParam.Value;
 276:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 277:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // nbChannels is > 1, when the channel plan requires more than one possible channel
 278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // defined by the calculation below.
 279:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( nbChannels > 1 )
 280:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         getPhy.Attribute = PHY_BEACON_CHANNEL_OFFSET;
 282:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
 283:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         offset = ( uint8_t ) phyParam.Value;
 284:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 285:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Calculate the channel for the next downlink
 286:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         channel = devAddr + ( beaconTime / ( beaconInterval / 1000 ) );
 287:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         channel = channel % nbChannels;
 288:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         channel += offset;
 289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 290:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 291:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Calculate the frequency for the next downlink. This holds
 292:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // for beacons and ping slots.
 293:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return CalcDownlinkFrequency( channel, isBeacon );
 294:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Calculates the correct frequency and opens up the beacon reception window. Please
 298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *        note that the variable WindowTimeout and WindowOffset will be updated according
 299:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *        to the current settings. Also, the function perform a calculation only, when
 300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *        Ctx.BeaconCtx.Ctrl.BeaconAcquired OR Ctx.BeaconCtx.Ctrl.AcquisitionPending is
 301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *        set to 1.
 302:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 303:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] rxConfig Reception parameters for the beacon window.
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 305:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] currentSymbolTimeout Current symbol timeout.
 306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 307:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void CalculateBeaconRxWindowConfig( RxConfigParams_t* rxConfig, uint16_t currentSymbolTimeou
 308:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 309:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     GetPhyParams_t getPhy;
 310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PhyParam_t phyParam;
 311:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 312:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     rxConfig->WindowTimeout = currentSymbolTimeout;
 313:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     rxConfig->WindowOffset = 0;
 314:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     //if( ( Ctx.BeaconCtx.Ctrl.BeaconAcquired == 1 ) || ( Ctx.BeaconCtx.Ctrl.AcquisitionPending == 
 316:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
ARM GAS  /tmp/ccw9RQ3F.s 			page 7


 317:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Apply the symbol timeout only if we have acquired the beacon
 318:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Otherwise, take the window enlargement into account
 319:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Read beacon datarate
 320:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         getPhy.Attribute = PHY_BEACON_CHANNEL_DR;
 321:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
 322:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 323:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Calculate downlink symbols
 324:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         RegionComputeRxWindowParameters( *Ctx.LoRaMacClassBParams.LoRaMacRegion,
 325:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                         ( int8_t )phyParam.Value, // datarate
 326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                         Ctx.LoRaMacClassBParams.LoRaMacParams->MinRxSymbols,
 327:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                         Ctx.LoRaMacClassBParams.LoRaMacParams->SystemMaxRxError,
 328:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                         rxConfig );
 329:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 330:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 331:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 332:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 333:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Calculates the correct frequency and opens up the beacon reception window.
 334:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 335:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] rxTime The reception time which should be setup
 336:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 337:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] activateDefaultChannel Set to true, if the function shall setup the default channel
 338:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 339:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] symbolTimeout Symbol timeout
 340:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 341:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void RxBeaconSetup( TimerTime_t rxTime, bool activateDefaultChannel, uint16_t symbolTimeout 
 342:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 343:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     RxBeaconSetup_t rxBeaconSetup;
 344:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint32_t frequency = 0;
 345:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 346:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( activateDefaultChannel == true )
 347:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 348:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // This is the default frequency in case we don't know when the next
 349:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // beacon will be transmitted. We select channel 0 as default.
 350:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         frequency = CalcDownlinkFrequency( 0, true );
 351:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 352:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     else
 353:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 354:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // This is the frequency according to the channel plan
 355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         frequency = CalcDownlinkChannelAndFrequency( 0, Ctx.BeaconCtx.BeaconTime.Seconds + ( CLASSB
 356:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                      CLASSB_BEACON_INTERVAL, true );
 357:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 358:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 359:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ClassBNvm->BeaconCtx.Ctrl.CustomFreq == 1 )
 360:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 361:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Set the frequency from the BeaconFreqReq
 362:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         frequency = ClassBNvm->BeaconCtx.Frequency;
 363:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 364:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 365:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconCtx.Ctrl.BeaconChannelSet == 1 )
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Set the frequency which was provided by BeaconTimingAns MAC command
 368:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.BeaconCtx.Ctrl.BeaconChannelSet = 0;
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         frequency = CalcDownlinkFrequency( Ctx.BeaconCtx.BeaconTimingChannel, true );
 370:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 372:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     rxBeaconSetup.SymbolTimeout = symbolTimeout;
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     rxBeaconSetup.RxTime = rxTime;
ARM GAS  /tmp/ccw9RQ3F.s 			page 8


 374:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     rxBeaconSetup.Frequency = frequency;
 375:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     RegionRxBeaconSetup( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &rxBeaconSetup, &Ctx.LoRaMacClassB
 377:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 378:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.LoRaMacClassBParams.MlmeIndication->BeaconInfo.Frequency = frequency;
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.LoRaMacClassBParams.MlmeIndication->BeaconInfo.Datarate = Ctx.LoRaMacClassBParams.McpsIndic
 380:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 382:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Calculates the next ping slot time.
 384:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 385:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] slotOffset The ping slot offset
 386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] pingPeriod The ping period
 387:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [OUT] timeOffset Time offset of the next slot, based on current time
 388:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 389:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \retval [true: ping slot found, false: no ping slot found]
 390:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 391:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static bool CalcNextSlotTime( uint16_t slotOffset, uint16_t pingPeriod, uint16_t pingNb, TimerTime_
 392:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 393:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint8_t currentPingSlot = 0;
 394:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t slotTime = 0;
 395:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t currentTime = TimerGetCurrentTime( );
 396:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 397:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Calculate the point in time of the last beacon even if we missed it
 398:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     slotTime = ( ( currentTime - SysTimeToMs( Ctx.BeaconCtx.LastBeaconRx ) ) % CLASSB_BEACON_INTERV
 399:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     slotTime = currentTime - slotTime;
 400:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 401:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Add the reserved time and the ping offset
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     slotTime += CLASSB_BEACON_RESERVED;
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     slotTime += slotOffset * CLASSB_PING_SLOT_WINDOW;
 404:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( slotTime < currentTime )
 406:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         currentPingSlot = ( ( currentTime - slotTime ) /
 408:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                           ( pingPeriod * CLASSB_PING_SLOT_WINDOW ) ) + 1;
 409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         slotTime += ( ( TimerTime_t )( currentPingSlot * pingPeriod ) *
 410:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     CLASSB_PING_SLOT_WINDOW );
 411:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( currentPingSlot < pingNb )
 414:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( slotTime <= ( SysTimeToMs( Ctx.BeaconCtx.NextBeaconRx ) - CLASSB_BEACON_GUARD - CLASSB_
 416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 417:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Calculate the relative ping slot time
 418:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             slotTime -= currentTime;
 419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             slotTime -= Radio.GetWakeupTime( );
 420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             slotTime = TimerTempCompensation( slotTime, Ctx.BeaconCtx.Temperature );
 421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             *timeOffset = slotTime;
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             return true;
 423:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 425:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 426:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 427:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** /*!
 429:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \brief Calculates CRC's of the beacon frame
 430:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
ARM GAS  /tmp/ccw9RQ3F.s 			page 9


 431:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] buffer Pointer to the data
 432:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \param [IN] length Length of the data
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  *
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  * \retval CRC
 435:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****  */
 436:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static uint16_t BeaconCrc( uint8_t *buffer, uint16_t length )
 437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 438:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // The CRC calculation follows CCITT
 439:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     const uint16_t polynom = 0x1021;
 440:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // CRC initial value
 441:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint16_t crc = 0x0000;
 442:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 443:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( buffer == NULL )
 444:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 445:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return 0;
 446:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 447:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 448:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     for( uint16_t i = 0; i < length; ++i )
 449:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 450:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         crc ^= ( uint16_t ) buffer[i] << 8;
 451:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         for( uint16_t j = 0; j < 8; ++j )
 452:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             crc = ( crc & 0x8000 ) ? ( crc << 1 ) ^ polynom : ( crc << 1 );
 454:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 455:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 456:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 457:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return crc;
 458:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 459:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 460:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void GetTemperature( LoRaMacClassBCallback_t *callbacks, BeaconContext_t *beaconCtx )
 461:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 462:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Measure temperature, if available
 463:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ( callbacks != NULL ) && ( callbacks->GetTemperatureLevel != NULL ) )
 464:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 465:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         beaconCtx->Temperature = callbacks->GetTemperatureLevel( );
 466:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 467:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 468:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 469:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void InitClassB( void )
 470:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 471:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     GetPhyParams_t getPhy;
 472:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PhyParam_t phyParam;
 473:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 474:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Init events
 475:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Value = 0;
 476:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 477:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Init variables to default
 478:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     memset1( ( uint8_t* ) ClassBNvm, 0, sizeof( LoRaMacClassBNvmData_t ) );
 479:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     memset1( ( uint8_t* ) &Ctx.PingSlotCtx, 0, sizeof( PingSlotContext_t ) );
 480:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     memset1( ( uint8_t* ) &Ctx.BeaconCtx, 0, sizeof( BeaconContext_t ) );
 481:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 482:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Setup default temperature
 483:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.Temperature = 25.0;
 484:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     GetTemperature( &Ctx.LoRaMacClassBCallbacks, &Ctx.BeaconCtx );
 485:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 486:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Setup default ping slot datarate
 487:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     getPhy.Attribute = PHY_PING_SLOT_CHANNEL_DR;
ARM GAS  /tmp/ccw9RQ3F.s 			page 10


 488:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
 489:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->PingSlotCtx.Datarate = ( int8_t )( phyParam.Value );
 490:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 491:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Setup default states
 492:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconState = BEACON_STATE_ACQUISITION;
 493:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.PingSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
 494:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.MulticastSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
 495:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 496:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 497:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void InitClassBDefaults( void )
 498:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 499:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // This function shall reset the Class B settings to default,
 500:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // but should keep important configurations
 501:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBBeaconNvmData_t beaconCtx = ClassBNvm->BeaconCtx;
 502:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBPingSlotNvmData_t pingSlotCtx = ClassBNvm->PingSlotCtx;
 503:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 504:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     InitClassB( );
 505:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 506:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Parameters from BeaconFreqReq
 507:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->BeaconCtx.Frequency = beaconCtx.Frequency;
 508:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->BeaconCtx.Ctrl.CustomFreq = beaconCtx.Ctrl.CustomFreq;
 509:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Parameters from PingSlotChannelReq
 511:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->PingSlotCtx.Ctrl.CustomFreq = pingSlotCtx.Ctrl.CustomFreq;
 512:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->PingSlotCtx.Frequency = pingSlotCtx.Frequency;
 513:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->PingSlotCtx.Datarate = pingSlotCtx.Datarate;
 514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 515:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 516:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void EnlargeWindowTimeout( void )
 517:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 518:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Update beacon movement
 519:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.BeaconWindowMovement *= CLASSB_WINDOW_MOVE_EXPANSION_FACTOR;
 520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconCtx.BeaconWindowMovement > CLASSB_WINDOW_MOVE_EXPANSION_MAX )
 521:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 522:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.BeaconCtx.BeaconWindowMovement = CLASSB_WINDOW_MOVE_EXPANSION_MAX;
 523:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Update symbol timeout
 525:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.SymbolTimeout *= CLASSB_BEACON_SYMBOL_TO_EXPANSION_FACTOR;
 526:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconCtx.SymbolTimeout > CLASSB_BEACON_SYMBOL_TO_EXPANSION_MAX )
 527:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 528:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.BeaconCtx.SymbolTimeout = CLASSB_BEACON_SYMBOL_TO_EXPANSION_MAX;
 529:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 530:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.PingSlotCtx.SymbolTimeout *= CLASSB_BEACON_SYMBOL_TO_EXPANSION_FACTOR;
 531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.PingSlotCtx.SymbolTimeout > CLASSB_PING_SLOT_SYMBOL_TO_EXPANSION_MAX )
 532:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 533:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.PingSlotCtx.SymbolTimeout = CLASSB_PING_SLOT_SYMBOL_TO_EXPANSION_MAX;
 534:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 535:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 536:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void ResetWindowTimeout( void )
 538:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.SymbolTimeout = CLASSB_BEACON_SYMBOL_TO_DEFAULT;
 540:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.PingSlotCtx.SymbolTimeout = CLASSB_BEACON_SYMBOL_TO_DEFAULT;
 541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.BeaconWindowMovement  = CLASSB_WINDOW_MOVE_DEFAULT;
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 543:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 544:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static TimerTime_t CalcDelayForNextBeacon( TimerTime_t currentTime, TimerTime_t lastBeaconRx )
ARM GAS  /tmp/ccw9RQ3F.s 			page 11


 545:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 546:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t nextBeaconRxTime = 0;
 547:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Calculate the point in time of the next beacon
 549:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     nextBeaconRxTime = ( ( currentTime - lastBeaconRx ) % CLASSB_BEACON_INTERVAL );
 550:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return ( CLASSB_BEACON_INTERVAL - nextBeaconRxTime );
 551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 552:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 553:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void IndicateBeaconStatus( LoRaMacEventInfoStatus_t status )
 554:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 555:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconCtx.Ctrl.ResumeBeaconing == 0 )
 556:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 557:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBParams.MlmeIndication->MlmeIndication = MLME_BEACON;
 558:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBParams.MlmeIndication->Status = status;
 559:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBParams.LoRaMacFlags->Bits.MlmeInd = 1;
 560:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 561:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBParams.LoRaMacFlags->Bits.MacDone = 1;
 562:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.Ctrl.ResumeBeaconing = 0;
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 565:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 566:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static TimerTime_t ApplyGuardTime( TimerTime_t beaconEventTime )
 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t timeGuard = beaconEventTime;
 569:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( timeGuard > CLASSB_BEACON_GUARD )
 571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         timeGuard -= CLASSB_BEACON_GUARD;
 573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return timeGuard;
 575:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static TimerTime_t UpdateBeaconState( LoRaMacEventInfoStatus_t status,
 578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                       TimerTime_t windowMovement, TimerTime_t currentTime )
 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 581:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t beaconEventTime = 0;
 582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 583:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Calculate the next beacon RX time
 584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     beaconEventTime = CalcDelayForNextBeacon( currentTime, SysTimeToMs( Ctx.BeaconCtx.LastBeaconRx 
 585:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.NextBeaconRx = SysTimeFromMs( currentTime + beaconEventTime );
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Take temperature compensation into account
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     beaconEventTime = TimerTempCompensation( beaconEventTime, Ctx.BeaconCtx.Temperature );
 589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Move the window
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( beaconEventTime > windowMovement )
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 593:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         beaconEventTime -= windowMovement;
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.NextBeaconRxAdjusted = currentTime + beaconEventTime;
 596:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Start the RX slot state machine for ping and multicast slots
 598:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBStartRxSlots( );
 599:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 600:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Setup an MLME_BEACON indication to inform the upper layer
 601:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     IndicateBeaconStatus( status );
ARM GAS  /tmp/ccw9RQ3F.s 			page 12


 602:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 603:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Apply guard time
 604:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return ApplyGuardTime( beaconEventTime );
 605:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 606:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 607:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static uint8_t CalcPingNb( uint16_t periodicity )
 608:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 609:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return 128 / ( 1 << periodicity );
 610:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 611:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 612:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static uint16_t CalcPingPeriod( uint8_t pingNb )
 613:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 614:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return CLASSB_BEACON_WINDOW_SLOTS / pingNb;
 615:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 616:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 617:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 618:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBInit( LoRaMacClassBParams_t *classBParams, LoRaMacClassBCallback_t *callbacks,
 619:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         LoRaMacClassBNvmData_t* nvm )
 620:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
  28              		.loc 1 620 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
 621:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 622:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Assign non-volatile context
 623:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( nvm == NULL )
 624:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 625:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return;
 626:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 627:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm = nvm;
 628:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 629:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Store callbacks
 630:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.LoRaMacClassBCallbacks = *callbacks;
 631:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 632:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Store parameter pointers
 633:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.LoRaMacClassBParams = *classBParams;
 634:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 635:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Initialize timers
 636:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerInit( &Ctx.BeaconTimer, LoRaMacClassBBeaconTimerEvent );
 637:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerInit( &Ctx.PingSlotTimer, LoRaMacClassBPingSlotTimerEvent );
 638:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerInit( &Ctx.MulticastSlotTimer, LoRaMacClassBMulticastSlotTimerEvent );
 639:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 640:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     InitClassB( );
 641:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 642:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
  33              		.loc 1 642 1 view .LVU1
  34 0000 7047     		bx	lr
  35              		.cfi_endproc
  36              	.LFE104:
  38              		.section	.text.LoRaMacClassBSetBeaconState,"ax",%progbits
  39              		.align	1
  40              		.global	LoRaMacClassBSetBeaconState
  41              		.syntax unified
  42              		.thumb
  43              		.thumb_func
  44              		.fpu softvfp
ARM GAS  /tmp/ccw9RQ3F.s 			page 13


  46              	LoRaMacClassBSetBeaconState:
  47              	.LVL1:
  48              	.LFB105:
 643:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 644:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBSetBeaconState( BeaconState_t beaconState )
 645:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
  49              		.loc 1 645 1 view -0
  50              		.cfi_startproc
  51              		@ args = 0, pretend = 0, frame = 0
  52              		@ frame_needed = 0, uses_anonymous_args = 0
  53              		@ link register save eliminated.
 646:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 647:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( beaconState == BEACON_STATE_ACQUISITION )
 648:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 649:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // If the MAC has received a time reference for the beacon,
 650:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // apply the state BEACON_STATE_ACQUISITION_BY_TIME.
 651:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( ( Ctx.BeaconCtx.Ctrl.BeaconDelaySet == 1 ) &&
 652:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ( LoRaMacClassBIsAcquisitionPending( ) == false ) )
 653:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 654:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_ACQUISITION_BY_TIME;
 655:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 656:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         else
 657:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 658:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****            Ctx.BeaconState = beaconState;
 659:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 660:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 661:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     else
 662:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 663:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( ( Ctx.BeaconState != BEACON_STATE_ACQUISITION ) &&
 664:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ( Ctx.BeaconState != BEACON_STATE_ACQUISITION_BY_TIME ) )
 665:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 666:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = beaconState;
 667:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 668:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 669:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 670:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
  54              		.loc 1 670 1 view .LVU3
  55 0000 7047     		bx	lr
  56              		.cfi_endproc
  57              	.LFE105:
  59              		.section	.text.LoRaMacClassBSetPingSlotState,"ax",%progbits
  60              		.align	1
  61              		.global	LoRaMacClassBSetPingSlotState
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  65              		.fpu softvfp
  67              	LoRaMacClassBSetPingSlotState:
  68              	.LVL2:
  69              	.LFB106:
 671:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 672:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBSetPingSlotState( PingSlotState_t pingSlotState )
 673:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
  70              		.loc 1 673 1 view -0
  71              		.cfi_startproc
  72              		@ args = 0, pretend = 0, frame = 0
  73              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccw9RQ3F.s 			page 14


  74              		@ link register save eliminated.
 674:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 675:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.PingSlotState = pingSlotState;
 676:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 677:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
  75              		.loc 1 677 1 view .LVU5
  76 0000 7047     		bx	lr
  77              		.cfi_endproc
  78              	.LFE106:
  80              		.section	.text.LoRaMacClassBSetMulticastSlotState,"ax",%progbits
  81              		.align	1
  82              		.global	LoRaMacClassBSetMulticastSlotState
  83              		.syntax unified
  84              		.thumb
  85              		.thumb_func
  86              		.fpu softvfp
  88              	LoRaMacClassBSetMulticastSlotState:
  89              	.LVL3:
  90              	.LFB107:
 678:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 679:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBSetMulticastSlotState( PingSlotState_t multicastSlotState )
 680:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
  91              		.loc 1 680 1 view -0
  92              		.cfi_startproc
  93              		@ args = 0, pretend = 0, frame = 0
  94              		@ frame_needed = 0, uses_anonymous_args = 0
  95              		@ link register save eliminated.
 681:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 682:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.MulticastSlotState = multicastSlotState;
 683:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 684:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
  96              		.loc 1 684 1 view .LVU7
  97 0000 7047     		bx	lr
  98              		.cfi_endproc
  99              	.LFE107:
 101              		.section	.text.LoRaMacClassBIsAcquisitionInProgress,"ax",%progbits
 102              		.align	1
 103              		.global	LoRaMacClassBIsAcquisitionInProgress
 104              		.syntax unified
 105              		.thumb
 106              		.thumb_func
 107              		.fpu softvfp
 109              	LoRaMacClassBIsAcquisitionInProgress:
 110              	.LFB108:
 685:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 686:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBIsAcquisitionInProgress( void )
 687:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 111              		.loc 1 687 1 view -0
 112              		.cfi_startproc
 113              		@ args = 0, pretend = 0, frame = 0
 114              		@ frame_needed = 0, uses_anonymous_args = 0
 115              		@ link register save eliminated.
 688:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 689:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconState == BEACON_STATE_ACQUISITION_BY_TIME )
 690:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 691:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // In this case the acquisition is in progress, as the MAC has
 692:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // a time reference for the next beacon RX.
ARM GAS  /tmp/ccw9RQ3F.s 			page 15


 693:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
 694:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 695:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( LoRaMacClassBIsAcquisitionPending( ) == true )
 696:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 697:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // In this case the acquisition is in progress, as the MAC
 698:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // searches for a beacon.
 699:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
 700:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 701:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 702:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
 703:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 116              		.loc 1 703 5 view .LVU9
 704:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 705:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 117              		.loc 1 705 1 is_stmt 0 view .LVU10
 118 0000 0020     		movs	r0, #0
 119 0002 7047     		bx	lr
 120              		.cfi_endproc
 121              	.LFE108:
 123              		.section	.text.LoRaMacClassBBeaconTimerEvent,"ax",%progbits
 124              		.align	1
 125              		.global	LoRaMacClassBBeaconTimerEvent
 126              		.syntax unified
 127              		.thumb
 128              		.thumb_func
 129              		.fpu softvfp
 131              	LoRaMacClassBBeaconTimerEvent:
 132              	.LVL4:
 133              	.LFB109:
 706:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 707:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBBeaconTimerEvent( void* context )
 708:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 134              		.loc 1 708 1 is_stmt 1 view -0
 135              		.cfi_startproc
 136              		@ args = 0, pretend = 0, frame = 0
 137              		@ frame_needed = 0, uses_anonymous_args = 0
 138              		@ link register save eliminated.
 709:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 710:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.TimeStamp = TimerGetCurrentTime( );
 711:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerStop( &Ctx.BeaconTimer );
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Events.Beacon = 1;
 713:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 714:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.LoRaMacClassBCallbacks.MacProcessNotify != NULL )
 715:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 716:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBCallbacks.MacProcessNotify( );
 717:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 718:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 719:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 139              		.loc 1 719 1 view .LVU12
 140 0000 7047     		bx	lr
 141              		.cfi_endproc
 142              	.LFE109:
 144              		.section	.text.LoRaMacClassBPingSlotTimerEvent,"ax",%progbits
 145              		.align	1
 146              		.global	LoRaMacClassBPingSlotTimerEvent
 147              		.syntax unified
 148              		.thumb
ARM GAS  /tmp/ccw9RQ3F.s 			page 16


 149              		.thumb_func
 150              		.fpu softvfp
 152              	LoRaMacClassBPingSlotTimerEvent:
 153              	.LVL5:
 154              	.LFB110:
 720:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void LoRaMacClassBProcessBeacon( void )
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 724:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     bool activateTimer = false;
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t beaconEventTime = 1;
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     RxConfigParams_t beaconRxConfig;
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t currentTime = Ctx.BeaconCtx.TimeStamp;
 728:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 729:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Beacon state machine
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     switch( Ctx.BeaconState )
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 732:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_ACQUISITION_BY_TIME:
 733:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 734:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             activateTimer = true;
 735:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 736:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.BeaconCtx.Ctrl.AcquisitionPending == 1 )
 737:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 738:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Radio.Sleep();
 739:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_LOST;
 740:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 741:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
 742:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 743:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Default symbol timeouts
 744:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 ResetWindowTimeout( );
 745:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 746:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( Ctx.BeaconCtx.Ctrl.BeaconDelaySet == 1 )
 747:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
 748:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     // The goal is to calculate beaconRxConfig.WindowTimeout
 749:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     CalculateBeaconRxWindowConfig( &beaconRxConfig, Ctx.BeaconCtx.SymbolTimeout );
 750:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 751:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     if( Ctx.BeaconCtx.BeaconTimingDelay > 0 )
 752:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     {
 753:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         if( SysTimeToMs( Ctx.BeaconCtx.NextBeaconRx ) > currentTime )
 754:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         {
 755:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             // Calculate the time when we expect the next beacon
 756:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             beaconEventTime = TimerTempCompensation( SysTimeToMs( Ctx.BeaconCtx.Nex
 757:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 758:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             if( ( int32_t ) beaconEventTime > beaconRxConfig.WindowOffset )
 759:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             {
 760:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                 // Apply the offset of the system error respectively beaconing prec
 761:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                 beaconEventTime += beaconRxConfig.WindowOffset;
 762:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             }
 763:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         }
 764:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         else
 765:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         {
 766:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             // Reset status provides by BeaconTimingAns
 767:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             Ctx.BeaconCtx.Ctrl.BeaconDelaySet = 0;
 768:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             Ctx.BeaconCtx.Ctrl.BeaconChannelSet = 0;
 769:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                             Ctx.BeaconState = BEACON_STATE_ACQUISITION;
 770:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         }
 771:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         Ctx.BeaconCtx.BeaconTimingDelay = 0;
ARM GAS  /tmp/ccw9RQ3F.s 			page 17


 772:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     }
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     else
 774:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     {
 775:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         activateTimer = false;
 776:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 777:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         // Reset status provides by BeaconTimingAns
 778:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         Ctx.BeaconCtx.Ctrl.BeaconDelaySet = 0;
 779:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         // Set the node into acquisition mode
 780:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         Ctx.BeaconCtx.Ctrl.AcquisitionPending = 1;
 781:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 782:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         // Don't use the default channel. We know on which
 783:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         // channel the next beacon will be transmitted
 784:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         RxBeaconSetup( CLASSB_BEACON_RESERVED, false, beaconRxConfig.WindowTimeout 
 785:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     }
 786:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
 787:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 else
 788:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
 789:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.BeaconCtx.NextBeaconRx.Seconds = 0;
 790:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.BeaconCtx.NextBeaconRx.SubSeconds = 0;
 791:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.BeaconCtx.BeaconTimingDelay = 0;
 792:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 793:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.BeaconState = BEACON_STATE_ACQUISITION;
 794:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
 795:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 796:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 797:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 798:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_ACQUISITION:
 799:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 800:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             activateTimer = true;
 801:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 802:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.BeaconCtx.Ctrl.AcquisitionPending == 1 )
 803:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 804:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Radio.Sleep();
 805:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_LOST;
 806:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 807:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
 808:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 809:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Default symbol timeouts
 810:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 ResetWindowTimeout( );
 811:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 812:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.Ctrl.AcquisitionPending = 1;
 813:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 beaconEventTime = CLASSB_BEACON_INTERVAL;
 814:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 815:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // The goal is to calculate beaconRxConfig.WindowTimeout
 816:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 CalculateBeaconRxWindowConfig( &beaconRxConfig, Ctx.BeaconCtx.SymbolTimeout );
 817:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 818:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Start the beacon acquisition. When the MAC has received a beacon in function
 819:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // RxBeacon successfully, the next state is BEACON_STATE_LOCKED. If the MAC does no
 820:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // find a beacon, the state machine will stay in state BEACON_STATE_ACQUISITION.
 821:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // This state detects that a acquisition was pending previously and will change the
 822:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // state to BEACON_STATE_LOST.
 823:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 RxBeaconSetup( 0, true, beaconRxConfig.WindowTimeout );
 824:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 825:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 826:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 827:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_TIMEOUT:
 828:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
ARM GAS  /tmp/ccw9RQ3F.s 			page 18


 829:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // We have to update the beacon time, since we missed a beacon
 830:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTime.Seconds += ( CLASSB_BEACON_INTERVAL / 1000 );
 831:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTime.SubSeconds = 0;
 832:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 833:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Enlarge window timeouts to increase the chance to receive the next beacon
 834:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             EnlargeWindowTimeout( );
 835:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 836:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Setup next state
 837:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_REACQUISITION;
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 839:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Intentional fall through
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_REACQUISITION:
 841:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 842:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             activateTimer = true;
 843:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 844:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // The beacon is no longer acquired
 845:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.Ctrl.BeaconAcquired = 0;
 846:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 847:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Verify if the maximum beacon less period has been elapsed
 848:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( ( currentTime - SysTimeToMs( Ctx.BeaconCtx.LastBeaconRx ) ) > CLASSB_MAX_BEACON_LES
 849:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 850:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_LOST;
 851:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 852:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
 853:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 854:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Handle beacon miss
 855:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 beaconEventTime = UpdateBeaconState( LORAMAC_EVENT_INFO_STATUS_BEACON_LOST,
 856:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                      Ctx.BeaconCtx.BeaconWindowMovement, currentTim
 857:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 858:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Setup next state
 859:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_IDLE;
 860:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 861:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 862:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 863:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_LOCKED:
 864:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 865:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             activateTimer = true;
 866:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 867:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // We have received a beacon. Acquisition is no longer pending.
 868:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.Ctrl.AcquisitionPending = 0;
 869:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 870:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Handle beacon reception
 871:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             beaconEventTime = UpdateBeaconState( LORAMAC_EVENT_INFO_STATUS_BEACON_LOCKED,
 872:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                  0, currentTime );
 873:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 874:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Setup the MLME confirm for the MLME_BEACON_ACQUISITION
 875:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.LoRaMacClassBParams.LoRaMacFlags->Bits.MlmeReq == 1 )
 876:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 877:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( LoRaMacConfirmQueueIsCmdActive( MLME_BEACON_ACQUISITION ) == true )
 878:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
 879:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_OK, MLME_BEACON_ACQUISI
 880:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.LoRaMacClassBParams.MlmeConfirm->TxTimeOnAir = 0;
 881:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
 882:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 883:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 884:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Setup next state
 885:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_IDLE;
ARM GAS  /tmp/ccw9RQ3F.s 			page 19


 886:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 887:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 888:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_IDLE:
 889:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 890:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             activateTimer = true;
 891:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             GetTemperature( &Ctx.LoRaMacClassBCallbacks, &Ctx.BeaconCtx );
 892:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             beaconEventTime = Ctx.BeaconCtx.NextBeaconRxAdjusted - Radio.GetWakeupTime( );
 893:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             currentTime = TimerGetCurrentTime( );
 894:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 895:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // The goal is to calculate beaconRxConfig.WindowTimeout and beaconRxConfig.WindowOffse
 896:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             CalculateBeaconRxWindowConfig( &beaconRxConfig, Ctx.BeaconCtx.SymbolTimeout );
 897:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( beaconEventTime > currentTime )
 899:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 900:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_GUARD;
 901:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 beaconEventTime -= currentTime;
 902:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 beaconEventTime = TimerTempCompensation( beaconEventTime, Ctx.BeaconCtx.Temperature
 903:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 904:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( ( int32_t ) beaconEventTime > beaconRxConfig.WindowOffset )
 905:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
 906:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     // Apply the offset of the system error respectively beaconing precision settin
 907:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     beaconEventTime += beaconRxConfig.WindowOffset;
 908:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
 909:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
 911:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 912:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_REACQUISITION;
 913:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 beaconEventTime = 1;
 914:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 915:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 916:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 917:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_GUARD:
 918:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 919:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_RX;
 920:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Stop slot timers
 922:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBStopRxSlots( );
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Don't use the default channel. We know on which
 925:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // channel the next beacon will be transmitted
 926:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             RxBeaconSetup( CLASSB_BEACON_RESERVED, false, beaconRxConfig.WindowTimeout );
 927:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 929:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case BEACON_STATE_LOST:
 930:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 931:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Handle events
 932:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.LoRaMacClassBParams.LoRaMacFlags->Bits.MlmeReq == 1 )
 933:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 934:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( LoRaMacConfirmQueueIsCmdActive( MLME_BEACON_ACQUISITION ) == true )
 935:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
 936:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_BEACON_NOT_FOUND, MLME_
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
 938:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 939:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
 940:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
 941:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.LoRaMacClassBParams.MlmeIndication->MlmeIndication = MLME_BEACON_LOST;
 942:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.LoRaMacClassBParams.MlmeIndication->Status = LORAMAC_EVENT_INFO_STATUS_OK;
ARM GAS  /tmp/ccw9RQ3F.s 			page 20


 943:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.LoRaMacClassBParams.LoRaMacFlags->Bits.MlmeInd = 1;
 944:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
 945:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 946:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Stop slot timers
 947:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBStopRxSlots( );
 948:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 949:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Initialize default state for class b
 950:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             InitClassBDefaults( );
 951:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 952:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.LoRaMacClassBParams.LoRaMacFlags->Bits.MacDone = 1;
 953:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 954:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 955:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 956:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         default:
 957:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 958:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_ACQUISITION;
 959:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
 960:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 961:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 962:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 963:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( activateTimer == true )
 964:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 965:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerSetValue( &Ctx.BeaconTimer, beaconEventTime );
 966:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerStart( &Ctx.BeaconTimer );
 967:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 968:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 969:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 970:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 971:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBPingSlotTimerEvent( void* context )
 972:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 155              		.loc 1 972 1 view -0
 156              		.cfi_startproc
 157              		@ args = 0, pretend = 0, frame = 0
 158              		@ frame_needed = 0, uses_anonymous_args = 0
 159              		@ link register save eliminated.
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 974:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Events.PingSlot = 1;
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 976:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.LoRaMacClassBCallbacks.MacProcessNotify != NULL )
 977:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 978:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBCallbacks.MacProcessNotify( );
 979:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
 980:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 981:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 160              		.loc 1 981 1 view .LVU14
 161 0000 7047     		bx	lr
 162              		.cfi_endproc
 163              	.LFE110:
 165              		.section	.text.LoRaMacClassBMulticastSlotTimerEvent,"ax",%progbits
 166              		.align	1
 167              		.global	LoRaMacClassBMulticastSlotTimerEvent
 168              		.syntax unified
 169              		.thumb
 170              		.thumb_func
 171              		.fpu softvfp
 173              	LoRaMacClassBMulticastSlotTimerEvent:
 174              	.LVL6:
ARM GAS  /tmp/ccw9RQ3F.s 			page 21


 175              	.LFB111:
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 984:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void LoRaMacClassBProcessPingSlot( void )
 985:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 986:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     static RxConfigParams_t pingSlotRxConfig;
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t pingSlotTime = 0;
 988:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
 989:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     switch( Ctx.PingSlotState )
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
 991:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case PINGSLOT_STATE_CALC_PING_OFFSET:
 992:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
 993:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ComputePingOffset( Ctx.BeaconCtx.BeaconTime.Seconds,
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                *Ctx.LoRaMacClassBParams.LoRaMacDevAddr,
 995:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                ClassBNvm->PingSlotCtx.PingPeriod,
 996:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                &( Ctx.PingSlotCtx.PingOffset ) );
 997:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.PingSlotState = PINGSLOT_STATE_SET_TIMER;
 998:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
 999:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Intentional fall through
1000:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case PINGSLOT_STATE_SET_TIMER:
1001:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1002:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( CalcNextSlotTime( Ctx.PingSlotCtx.PingOffset, ClassBNvm->PingSlotCtx.PingPeriod, Cl
1003:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1004:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( Ctx.BeaconCtx.Ctrl.BeaconAcquired == 1 )
1005:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
1006:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     // Compute the symbol timeout. Apply it only, if the beacon is acquired
1007:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     // Otherwise, take the enlargement of the symbols into account.
1008:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     RegionComputeRxWindowParameters( *Ctx.LoRaMacClassBParams.LoRaMacRegion,
1009:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                      ClassBNvm->PingSlotCtx.Datarate,
1010:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                      Ctx.LoRaMacClassBParams.LoRaMacParams->MinRxSy
1011:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                      Ctx.LoRaMacClassBParams.LoRaMacParams->SystemM
1012:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                      &pingSlotRxConfig );
1013:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.PingSlotCtx.SymbolTimeout = pingSlotRxConfig.WindowTimeout;
1014:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1015:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     if( ( int32_t )pingSlotTime > pingSlotRxConfig.WindowOffset )
1016:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     {// Apply the window offset
1017:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         pingSlotTime += pingSlotRxConfig.WindowOffset;
1018:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     }
1019:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
1020:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1021:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Start the timer if the ping slot time is in range
1022:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.PingSlotState = PINGSLOT_STATE_IDLE;
1023:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerSetValue( &Ctx.PingSlotTimer, pingSlotTime );
1024:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerStart( &Ctx.PingSlotTimer );
1025:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1026:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1027:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1028:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case PINGSLOT_STATE_IDLE:
1029:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1030:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             uint32_t frequency = ClassBNvm->PingSlotCtx.Frequency;
1031:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1032:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Apply a custom frequency if the following bit is set
1033:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( ClassBNvm->PingSlotCtx.Ctrl.CustomFreq == 0 )
1034:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1035:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Restore floor plan
1036:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 frequency = CalcDownlinkChannelAndFrequency( *Ctx.LoRaMacClassBParams.LoRaMacDevAdd
1037:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                              CLASSB_BEACON_INTERVAL, false );
ARM GAS  /tmp/ccw9RQ3F.s 			page 22


1038:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1039:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1040:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Open the ping slot window only, if there is no multicast ping slot
1041:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // open. Multicast ping slots have always priority
1042:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.MulticastSlotState != PINGSLOT_STATE_RX )
1043:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1044:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.PingSlotState = PINGSLOT_STATE_RX;
1045:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1046:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 pingSlotRxConfig.Datarate = ClassBNvm->PingSlotCtx.Datarate;
1047:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 pingSlotRxConfig.DownlinkDwellTime = Ctx.LoRaMacClassBParams.LoRaMacParams->Downlin
1048:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 pingSlotRxConfig.RepeaterSupport = Ctx.LoRaMacClassBParams.LoRaMacParams->RepeaterS
1049:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 pingSlotRxConfig.Frequency = frequency;
1050:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 pingSlotRxConfig.RxContinuous = false;
1051:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 pingSlotRxConfig.RxSlot = RX_SLOT_WIN_CLASS_B_PING_SLOT;
1052:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1053:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 RegionRxConfig( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &pingSlotRxConfig, ( int8_t
1054:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1055:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( pingSlotRxConfig.RxContinuous == false )
1056:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
1057:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Radio.Rx( Ctx.LoRaMacClassBParams.LoRaMacParams->MaxRxWindow );
1058:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
1059:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 else
1060:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
1061:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Radio.Rx( 0 ); // Continuous mode
1062:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
1063:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1064:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
1065:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1066:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Multicast slots have priority. Skip Rx
1067:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.PingSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1068:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerSetValue( &Ctx.PingSlotTimer, CLASSB_PING_SLOT_WINDOW );
1069:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerStart( &Ctx.PingSlotTimer );
1070:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1071:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1072:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1073:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         default:
1074:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1075:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.PingSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1076:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1077:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1078:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1079:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
1080:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1081:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1082:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBMulticastSlotTimerEvent( void* context )
1083:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 176              		.loc 1 1083 1 view -0
 177              		.cfi_startproc
 178              		@ args = 0, pretend = 0, frame = 0
 179              		@ frame_needed = 0, uses_anonymous_args = 0
 180              		@ link register save eliminated.
1084:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1085:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Events.MulticastSlot = 1;
1086:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1087:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.LoRaMacClassBCallbacks.MacProcessNotify != NULL )
1088:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1089:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBCallbacks.MacProcessNotify( );
ARM GAS  /tmp/ccw9RQ3F.s 			page 23


1090:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1091:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1092:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 181              		.loc 1 1092 1 view .LVU16
 182 0000 7047     		bx	lr
 183              		.cfi_endproc
 184              	.LFE111:
 186              		.section	.text.LoRaMacClassBRxBeacon,"ax",%progbits
 187              		.align	1
 188              		.global	LoRaMacClassBRxBeacon
 189              		.syntax unified
 190              		.thumb
 191              		.thumb_func
 192              		.fpu softvfp
 194              	LoRaMacClassBRxBeacon:
 195              	.LVL7:
 196              	.LFB112:
1093:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1094:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1095:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** static void LoRaMacClassBProcessMulticastSlot( void )
1096:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
1097:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     static RxConfigParams_t multicastSlotRxConfig;
1098:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t multicastSlotTime = 0;
1099:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t slotTime = 0;
1100:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     MulticastCtx_t *cur = Ctx.LoRaMacClassBParams.MulticastChannels;
1101:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1102:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1103:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( cur == NULL )
1104:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1105:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return;
1106:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1107:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1108:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.MulticastSlotState == PINGSLOT_STATE_RX )
1109:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1110:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // A multicast slot is already open
1111:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return;
1112:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1113:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1114:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     switch( Ctx.MulticastSlotState )
1115:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1116:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case PINGSLOT_STATE_CALC_PING_OFFSET:
1117:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1118:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Compute all offsets for every multicast slots
1119:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             for( uint8_t i = 0; i < LORAMAC_MAX_MC_CTX; i++ ) /* ST_WORKAROUND: reduced LORAMAC_MAX
1120:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1121:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 ComputePingOffset( Ctx.BeaconCtx.BeaconTime.Seconds,
1122:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                    cur->ChannelParams.Address,
1123:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                    cur->PingPeriod,
1124:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                    &( cur->PingOffset ) );
1125:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 cur++;
1126:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1127:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.MulticastSlotState = PINGSLOT_STATE_SET_TIMER;
1128:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1129:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Intentional fall through
1130:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case PINGSLOT_STATE_SET_TIMER:
1131:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             cur = Ctx.LoRaMacClassBParams.MulticastChannels;
ARM GAS  /tmp/ccw9RQ3F.s 			page 24


1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.PingSlotCtx.NextMulticastChannel = NULL;
1134:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             for( uint8_t i = 0; i < LORAMAC_MAX_MC_CTX; i++ )
1136:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1137:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Calculate the next slot time for every multicast slot
1138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( CalcNextSlotTime( cur->PingOffset, cur->PingPeriod, cur->PingNb, &slotTime ) ==
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     if( ( multicastSlotTime == 0 ) || ( multicastSlotTime > slotTime ) )
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     {
1142:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         // Update the slot time and the next multicast channel
1143:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         multicastSlotTime = slotTime;
1144:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                         Ctx.PingSlotCtx.NextMulticastChannel = cur;
1145:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     }
1146:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
1147:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 cur++;
1148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1149:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1150:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Schedule the next multicast slot
1151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.PingSlotCtx.NextMulticastChannel != NULL )
1152:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1153:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( Ctx.BeaconCtx.Ctrl.BeaconAcquired == 1 )
1154:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {
1155:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     RegionComputeRxWindowParameters( *Ctx.LoRaMacClassBParams.LoRaMacRegion,
1156:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                     ClassBNvm->PingSlotCtx.Datarate,
1157:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                     Ctx.LoRaMacClassBParams.LoRaMacParams->MinRxSym
1158:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                     Ctx.LoRaMacClassBParams.LoRaMacParams->SystemMa
1159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                     &multicastSlotRxConfig );
1160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     Ctx.PingSlotCtx.SymbolTimeout = multicastSlotRxConfig.WindowTimeout;
1161:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
1162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1163:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 if( ( int32_t )multicastSlotTime > multicastSlotRxConfig.WindowOffset )
1164:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 {// Apply the window offset
1165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                     multicastSlotTime += multicastSlotRxConfig.WindowOffset;
1166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 }
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Start the timer if the ping slot time is in range
1169:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.MulticastSlotState = PINGSLOT_STATE_IDLE;
1170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerSetValue( &Ctx.MulticastSlotTimer, multicastSlotTime );
1171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerStart( &Ctx.MulticastSlotTimer );
1172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1173:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case PINGSLOT_STATE_IDLE:
1176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             uint32_t frequency = 0;
1178:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Verify if the multicast channel is valid
1180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.PingSlotCtx.NextMulticastChannel == NULL )
1181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.MulticastSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1183:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerSetValue( &Ctx.MulticastSlotTimer, 1 );
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerStart( &Ctx.MulticastSlotTimer );
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 break;
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Apply frequency
1189:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             frequency = Ctx.PingSlotCtx.NextMulticastChannel->ChannelParams.RxParams.ClassB.Frequen
ARM GAS  /tmp/ccw9RQ3F.s 			page 25


1190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1191:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Restore the floor plan frequency if there is no individual frequency assigned
1192:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( frequency == 0 )
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1194:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Restore floor plan
1195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 frequency = CalcDownlinkChannelAndFrequency( Ctx.PingSlotCtx.NextMulticastChannel->
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                                                              Ctx.BeaconCtx.BeaconTime.Seconds, CLAS
1197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1199:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.MulticastSlotState = PINGSLOT_STATE_RX;
1200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             multicastSlotRxConfig.Datarate = Ctx.PingSlotCtx.NextMulticastChannel->ChannelParams.Rx
1202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             multicastSlotRxConfig.DownlinkDwellTime = Ctx.LoRaMacClassBParams.LoRaMacParams->Downli
1203:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             multicastSlotRxConfig.RepeaterSupport = Ctx.LoRaMacClassBParams.LoRaMacParams->Repeater
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             multicastSlotRxConfig.Frequency = frequency;
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             multicastSlotRxConfig.RxContinuous = false;
1206:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             multicastSlotRxConfig.RxSlot = RX_SLOT_WIN_CLASS_B_MULTICAST_SLOT;
1207:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1208:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             RegionRxConfig( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &multicastSlotRxConfig, ( int8_
1209:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( Ctx.PingSlotState == PINGSLOT_STATE_RX )
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1212:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Close ping slot window, if necessary. Multicast slots have priority
1213:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Radio.Standby( );
1214:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.PingSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1215:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerSetValue( &Ctx.PingSlotTimer, CLASSB_PING_SLOT_WINDOW );
1216:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerStart( &Ctx.PingSlotTimer );
1217:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1218:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1219:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( multicastSlotRxConfig.RxContinuous == false )
1220:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1221:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Radio.Rx( Ctx.LoRaMacClassBParams.LoRaMacParams->MaxRxWindow );
1222:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1223:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             else
1224:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1225:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Radio.Rx( 0 ); // Continuous mode
1226:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1227:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1228:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1229:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         default:
1230:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1231:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.MulticastSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1232:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1233:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1234:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1235:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
1236:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1237:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1238:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBRxBeacon( uint8_t *payload, uint16_t size )
1239:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 197              		.loc 1 1239 1 view -0
 198              		.cfi_startproc
 199              		@ args = 0, pretend = 0, frame = 0
 200              		@ frame_needed = 0, uses_anonymous_args = 0
 201              		@ link register save eliminated.
1240:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1241:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     GetPhyParams_t getPhy;
ARM GAS  /tmp/ccw9RQ3F.s 			page 26


1242:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     PhyParam_t phyParam;
1243:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     bool beaconProcessed = false;
1244:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint16_t crc0 = 0;
1245:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint16_t crc1 = 0;
1246:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint16_t beaconCrc0 = 0;
1247:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint16_t beaconCrc1 = 0;
1248:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1249:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     getPhy.Attribute = PHY_BEACON_FORMAT;
1250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
1251:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Verify if we are in the state where we expect a beacon
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ( Ctx.BeaconState == BEACON_STATE_RX ) || ( Ctx.BeaconCtx.Ctrl.AcquisitionPending == 1 ) )
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1255:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( size == phyParam.BeaconFormat.BeaconSize )
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // A beacon frame is defined as:
1258:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Bytes: |  x   |  4   |  2   |     7      |  y   |  2   |
1259:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             //        |------|------|------|------------|------|------|
1260:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Field: | RFU1 | Time | CRC1 | GwSpecific | RFU2 | CRC2 |
1261:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             //
1262:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Field RFU1 and RFU2 have variable sizes. It depends on the region specific implement
1263:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1264:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Read CRC1 field from the frame
1265:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             beaconCrc0 = ( ( uint16_t )payload[phyParam.BeaconFormat.Rfu1Size + 4] ) & 0x00FF;
1266:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             beaconCrc0 |= ( ( uint16_t )payload[phyParam.BeaconFormat.Rfu1Size + 4 + 1] << 8 ) & 0x
1267:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             crc0 = BeaconCrc( payload, phyParam.BeaconFormat.Rfu1Size + 4 );
1268:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1269:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Validate the first crc of the beacon frame
1270:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( crc0 == beaconCrc0 )
1271:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1272:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Read Time field from the frame
1273:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.BeaconTime.Seconds  = ( ( uint32_t )payload[phyParam.BeaconFormat.Rfu
1274:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.BeaconTime.Seconds |= ( ( uint32_t )( payload[phyParam.BeaconFormat.R
1275:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.BeaconTime.Seconds |= ( ( uint32_t )( payload[phyParam.BeaconFormat.R
1276:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.BeaconTime.Seconds |= ( ( uint32_t )( payload[phyParam.BeaconFormat.R
1277:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.BeaconTime.SubSeconds = 0;
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.LoRaMacClassBParams.MlmeIndication->BeaconInfo.Time = Ctx.BeaconCtx.BeaconTime;
1279:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 beaconProcessed = true;
1280:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1282:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Read CRC2 field from the frame
1283:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             beaconCrc1 = ( ( uint16_t )payload[phyParam.BeaconFormat.Rfu1Size + 4 + 2 + 7 + phyPara
1284:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             beaconCrc1 |= ( ( uint16_t )payload[phyParam.BeaconFormat.Rfu1Size + 4 + 2 + 7 + phyPar
1285:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             crc1 = BeaconCrc( &payload[phyParam.BeaconFormat.Rfu1Size + 4 + 2], 7 + phyParam.Beacon
1286:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1287:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Validate the second crc of the beacon frame
1288:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( crc1 == beaconCrc1 )
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
1290:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Read GwSpecific field from the frame
1291:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // The GwSpecific field contains 1 byte InfoDesc and 6 bytes Info
1292:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.LoRaMacClassBParams.MlmeIndication->BeaconInfo.GwSpecific.InfoDesc = payload[ph
1293:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 memcpy1( Ctx.LoRaMacClassBParams.MlmeIndication->BeaconInfo.GwSpecific.Info, &paylo
1294:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Reset beacon variables, if one of the crc is valid
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             if( beaconProcessed == true )
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             {
ARM GAS  /tmp/ccw9RQ3F.s 			page 27


1299:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 uint32_t spreadingFactor = 0;
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 uint32_t bandwidth = 0;
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1302:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 getPhy.Attribute = PHY_BEACON_CHANNEL_DR;
1303:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
1304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1305:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 getPhy.Attribute = PHY_SF_FROM_DR;
1306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 getPhy.Datarate = phyParam.Value;
1307:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
1308:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 spreadingFactor = phyParam.Value;
1309:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 getPhy.Attribute = PHY_BW_FROM_DR;
1311:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 phyParam = RegionGetPhyParam( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &getPhy );
1312:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 bandwidth = phyParam.Value;
1313:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1314:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 TimerTime_t time = Radio.TimeOnAir( MODEM_LORA, bandwidth, spreadingFactor, 1, 10, 
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 SysTime_t timeOnAir;
1316:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 timeOnAir.Seconds = time / 1000;
1317:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 timeOnAir.SubSeconds = time - timeOnAir.Seconds * 1000;
1318:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1319:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.LastBeaconRx = Ctx.BeaconCtx.BeaconTime;
1320:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.LastBeaconRx.Seconds += UNIX_GPS_EPOCH_OFFSET;
1321:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1322:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 // Update system time.
1323:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 SysTimeSet( SysTimeAdd( Ctx.BeaconCtx.LastBeaconRx, timeOnAir ) );
1324:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1325:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.Ctrl.BeaconAcquired = 1;
1326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconCtx.Ctrl.BeaconMode = 1;
1327:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 ResetWindowTimeout( );
1328:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 Ctx.BeaconState = BEACON_STATE_LOCKED;
1329:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1330:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                 LoRaMacClassBBeaconTimerEvent( NULL );
1331:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             }
1332:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1333:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1334:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( Ctx.BeaconState == BEACON_STATE_RX )
1335:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1336:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_TIMEOUT;
1337:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBBeaconTimerEvent( NULL );
1338:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1339:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // When the MAC listens for a beacon, it is not allowed to process any other
1340:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // downlink except the beacon frame itself. The reason for this is that no valid downlink w
1341:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // If it receives a frame which is
1342:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // 1. not a beacon or
1343:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // 2. a beacon with a crc fail
1344:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // the MAC shall ignore the frame completely. Thus, the function must always return true, e
1345:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // valid beacon has been received.
1346:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         beaconProcessed = true;
1347:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1348:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return beaconProcessed;
1349:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1350:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 202              		.loc 1 1350 5 view .LVU18
1351:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1352:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 203              		.loc 1 1352 1 is_stmt 0 view .LVU19
 204 0000 0020     		movs	r0, #0
ARM GAS  /tmp/ccw9RQ3F.s 			page 28


 205              	.LVL8:
 206              		.loc 1 1352 1 view .LVU20
 207 0002 7047     		bx	lr
 208              		.cfi_endproc
 209              	.LFE112:
 211              		.section	.text.LoRaMacClassBIsBeaconExpected,"ax",%progbits
 212              		.align	1
 213              		.global	LoRaMacClassBIsBeaconExpected
 214              		.syntax unified
 215              		.thumb
 216              		.thumb_func
 217              		.fpu softvfp
 219              	LoRaMacClassBIsBeaconExpected:
 220              	.LFB113:
1353:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1354:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBIsBeaconExpected( void )
1355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 221              		.loc 1 1355 1 is_stmt 1 view -0
 222              		.cfi_startproc
 223              		@ args = 0, pretend = 0, frame = 0
 224              		@ frame_needed = 0, uses_anonymous_args = 0
 225              		@ link register save eliminated.
1356:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1357:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ( Ctx.BeaconCtx.Ctrl.AcquisitionPending == 1 ) ||
1358:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         ( Ctx.BeaconState == BEACON_STATE_RX ) )
1359:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1360:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
1361:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1362:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
1363:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1364:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 226              		.loc 1 1364 5 view .LVU22
1365:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 227              		.loc 1 1366 1 is_stmt 0 view .LVU23
 228 0000 0020     		movs	r0, #0
 229 0002 7047     		bx	lr
 230              		.cfi_endproc
 231              	.LFE113:
 233              		.section	.text.LoRaMacClassBIsPingExpected,"ax",%progbits
 234              		.align	1
 235              		.global	LoRaMacClassBIsPingExpected
 236              		.syntax unified
 237              		.thumb
 238              		.thumb_func
 239              		.fpu softvfp
 241              	LoRaMacClassBIsPingExpected:
 242              	.LFB114:
1367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1368:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBIsPingExpected( void )
1369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 243              		.loc 1 1369 1 is_stmt 1 view -0
 244              		.cfi_startproc
 245              		@ args = 0, pretend = 0, frame = 0
 246              		@ frame_needed = 0, uses_anonymous_args = 0
 247              		@ link register save eliminated.
1370:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
ARM GAS  /tmp/ccw9RQ3F.s 			page 29


1371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.PingSlotState == PINGSLOT_STATE_RX )
1372:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
1374:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1375:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
1376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1377:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 248              		.loc 1 1377 5 view .LVU25
1378:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 249              		.loc 1 1379 1 is_stmt 0 view .LVU26
 250 0000 0020     		movs	r0, #0
 251 0002 7047     		bx	lr
 252              		.cfi_endproc
 253              	.LFE114:
 255              		.section	.text.LoRaMacClassBIsMulticastExpected,"ax",%progbits
 256              		.align	1
 257              		.global	LoRaMacClassBIsMulticastExpected
 258              		.syntax unified
 259              		.thumb
 260              		.thumb_func
 261              		.fpu softvfp
 263              	LoRaMacClassBIsMulticastExpected:
 264              	.LFB115:
1380:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBIsMulticastExpected( void )
1382:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 265              		.loc 1 1382 1 is_stmt 1 view -0
 266              		.cfi_startproc
 267              		@ args = 0, pretend = 0, frame = 0
 268              		@ frame_needed = 0, uses_anonymous_args = 0
 269              		@ link register save eliminated.
1383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1384:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.MulticastSlotState == PINGSLOT_STATE_RX )
1385:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
1387:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1388:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
1389:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1390:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 270              		.loc 1 1390 5 view .LVU28
1391:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1392:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 271              		.loc 1 1392 1 is_stmt 0 view .LVU29
 272 0000 0020     		movs	r0, #0
 273 0002 7047     		bx	lr
 274              		.cfi_endproc
 275              	.LFE115:
 277              		.section	.text.LoRaMacClassBIsAcquisitionPending,"ax",%progbits
 278              		.align	1
 279              		.global	LoRaMacClassBIsAcquisitionPending
 280              		.syntax unified
 281              		.thumb
 282              		.thumb_func
 283              		.fpu softvfp
 285              	LoRaMacClassBIsAcquisitionPending:
 286              	.LFB116:
ARM GAS  /tmp/ccw9RQ3F.s 			page 30


1393:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1394:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBIsAcquisitionPending( void )
1395:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 287              		.loc 1 1395 1 is_stmt 1 view -0
 288              		.cfi_startproc
 289              		@ args = 0, pretend = 0, frame = 0
 290              		@ frame_needed = 0, uses_anonymous_args = 0
 291              		@ link register save eliminated.
1396:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1397:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconCtx.Ctrl.AcquisitionPending == 1 )
1398:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1399:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
1400:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1401:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
1402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 292              		.loc 1 1403 5 view .LVU31
1404:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 293              		.loc 1 1405 1 is_stmt 0 view .LVU32
 294 0000 0020     		movs	r0, #0
 295 0002 7047     		bx	lr
 296              		.cfi_endproc
 297              	.LFE116:
 299              		.section	.text.LoRaMacClassBIsBeaconModeActive,"ax",%progbits
 300              		.align	1
 301              		.global	LoRaMacClassBIsBeaconModeActive
 302              		.syntax unified
 303              		.thumb
 304              		.thumb_func
 305              		.fpu softvfp
 307              	LoRaMacClassBIsBeaconModeActive:
 308              	.LFB117:
1406:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBIsBeaconModeActive( void )
1408:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 309              		.loc 1 1408 1 is_stmt 1 view -0
 310              		.cfi_startproc
 311              		@ args = 0, pretend = 0, frame = 0
 312              		@ frame_needed = 0, uses_anonymous_args = 0
 313              		@ link register save eliminated.
1409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1410:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ( Ctx.BeaconCtx.Ctrl.BeaconMode == 1 ) ||
1411:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         ( Ctx.BeaconState == BEACON_STATE_ACQUISITION_BY_TIME ) )
1412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
1414:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
1416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1417:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 314              		.loc 1 1417 5 view .LVU34
1418:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 315              		.loc 1 1419 1 is_stmt 0 view .LVU35
 316 0000 0020     		movs	r0, #0
 317 0002 7047     		bx	lr
 318              		.cfi_endproc
ARM GAS  /tmp/ccw9RQ3F.s 			page 31


 319              	.LFE117:
 321              		.section	.text.LoRaMacClassBSetPingSlotInfo,"ax",%progbits
 322              		.align	1
 323              		.global	LoRaMacClassBSetPingSlotInfo
 324              		.syntax unified
 325              		.thumb
 326              		.thumb_func
 327              		.fpu softvfp
 329              	LoRaMacClassBSetPingSlotInfo:
 330              	.LVL9:
 331              	.LFB118:
1420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBSetPingSlotInfo( uint8_t periodicity )
1422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 332              		.loc 1 1422 1 is_stmt 1 view -0
 333              		.cfi_startproc
 334              		@ args = 0, pretend = 0, frame = 0
 335              		@ frame_needed = 0, uses_anonymous_args = 0
 336              		@ link register save eliminated.
1423:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->PingSlotCtx.PingNb = CalcPingNb( periodicity );
1425:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     ClassBNvm->PingSlotCtx.PingPeriod = CalcPingPeriod( ClassBNvm->PingSlotCtx.PingNb );
1426:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1427:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 337              		.loc 1 1427 1 view .LVU37
 338 0000 7047     		bx	lr
 339              		.cfi_endproc
 340              	.LFE118:
 342              		.section	.text.LoRaMacClassBHaltBeaconing,"ax",%progbits
 343              		.align	1
 344              		.global	LoRaMacClassBHaltBeaconing
 345              		.syntax unified
 346              		.thumb
 347              		.thumb_func
 348              		.fpu softvfp
 350              	LoRaMacClassBHaltBeaconing:
 351              	.LFB119:
1428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1429:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBHaltBeaconing( void )
1430:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 352              		.loc 1 1430 1 view -0
 353              		.cfi_startproc
 354              		@ args = 0, pretend = 0, frame = 0
 355              		@ frame_needed = 0, uses_anonymous_args = 0
 356              		@ link register save eliminated.
1431:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1432:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconCtx.Ctrl.BeaconMode == 1 )
1433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( ( Ctx.BeaconState == BEACON_STATE_TIMEOUT ) ||
1435:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ( Ctx.BeaconState == BEACON_STATE_LOST ) )
1436:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Update the state machine before halt
1438:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBBeaconTimerEvent( NULL );
1439:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1440:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1441:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         CRITICAL_SECTION_BEGIN( );
1442:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         LoRaMacClassBEvents.Events.Beacon = 0;
ARM GAS  /tmp/ccw9RQ3F.s 			page 32


1443:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         CRITICAL_SECTION_END( );
1444:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1445:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Halt ping slot state machine
1446:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerStop( &Ctx.BeaconTimer );
1447:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1448:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Halt beacon state machine
1449:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.BeaconState = BEACON_STATE_HALT;
1450:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1451:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Halt ping and multicast slot state machines
1452:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         LoRaMacClassBStopRxSlots( );
1453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1454:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1455:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 357              		.loc 1 1455 1 view .LVU39
 358 0000 7047     		bx	lr
 359              		.cfi_endproc
 360              	.LFE119:
 362              		.section	.text.LoRaMacClassBResumeBeaconing,"ax",%progbits
 363              		.align	1
 364              		.global	LoRaMacClassBResumeBeaconing
 365              		.syntax unified
 366              		.thumb
 367              		.thumb_func
 368              		.fpu softvfp
 370              	LoRaMacClassBResumeBeaconing:
 371              	.LFB120:
1456:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1457:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBResumeBeaconing( void )
1458:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 372              		.loc 1 1458 1 view -0
 373              		.cfi_startproc
 374              		@ args = 0, pretend = 0, frame = 0
 375              		@ frame_needed = 0, uses_anonymous_args = 0
 376              		@ link register save eliminated.
1459:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1460:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( Ctx.BeaconState == BEACON_STATE_HALT )
1461:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1462:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.BeaconCtx.Ctrl.ResumeBeaconing = 1;
1463:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1464:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Set default state
1465:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.BeaconState = BEACON_STATE_LOCKED;
1466:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1467:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( Ctx.BeaconCtx.Ctrl.BeaconAcquired == 0 )
1468:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1469:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // Set the default state for beacon less operation
1470:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconState = BEACON_STATE_REACQUISITION;
1471:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1472:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1473:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         LoRaMacClassBBeaconTimerEvent( NULL );
1474:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1475:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1476:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 377              		.loc 1 1476 1 view .LVU41
 378 0000 7047     		bx	lr
 379              		.cfi_endproc
 380              	.LFE120:
 382              		.section	.text.LoRaMacClassBSwitchClass,"ax",%progbits
ARM GAS  /tmp/ccw9RQ3F.s 			page 33


 383              		.align	1
 384              		.global	LoRaMacClassBSwitchClass
 385              		.syntax unified
 386              		.thumb
 387              		.thumb_func
 388              		.fpu softvfp
 390              	LoRaMacClassBSwitchClass:
 391              	.LVL10:
 392              	.LFB121:
1477:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1478:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** LoRaMacStatus_t LoRaMacClassBSwitchClass( DeviceClass_t nextClass )
1479:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 393              		.loc 1 1479 1 view -0
 394              		.cfi_startproc
 395              		@ args = 0, pretend = 0, frame = 0
 396              		@ frame_needed = 0, uses_anonymous_args = 0
 397              		@ link register save eliminated.
1480:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1481:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( nextClass == CLASS_B )
1482:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {// Switch to from class a to class b
1483:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( ( Ctx.BeaconCtx.Ctrl.BeaconMode == 1 ) && ( ClassBNvm->PingSlotCtx.Ctrl.Assigned == 1 )
1484:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1485:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             return LORAMAC_STATUS_OK;
1486:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1487:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1488:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( nextClass == CLASS_A )
1489:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {// Switch from class b to class a
1490:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         LoRaMacClassBHaltBeaconing( );
1491:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1492:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         // Initialize default state for class b
1493:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         InitClassBDefaults( );
1494:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1495:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return LORAMAC_STATUS_OK;
1496:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1497:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return LORAMAC_STATUS_SERVICE_UNKNOWN;
1498:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1499:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return LORAMAC_STATUS_SERVICE_UNKNOWN;
 398              		.loc 1 1499 5 view .LVU43
1500:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1501:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 399              		.loc 1 1501 1 is_stmt 0 view .LVU44
 400 0000 0220     		movs	r0, #2
 401              	.LVL11:
 402              		.loc 1 1501 1 view .LVU45
 403 0002 7047     		bx	lr
 404              		.cfi_endproc
 405              	.LFE121:
 407              		.section	.text.LoRaMacClassBMibGetRequestConfirm,"ax",%progbits
 408              		.align	1
 409              		.global	LoRaMacClassBMibGetRequestConfirm
 410              		.syntax unified
 411              		.thumb
 412              		.thumb_func
 413              		.fpu softvfp
 415              	LoRaMacClassBMibGetRequestConfirm:
 416              	.LVL12:
 417              	.LFB122:
ARM GAS  /tmp/ccw9RQ3F.s 			page 34


1502:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1503:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** LoRaMacStatus_t LoRaMacClassBMibGetRequestConfirm( MibRequestConfirm_t *mibGet )
1504:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 418              		.loc 1 1504 1 is_stmt 1 view -0
 419              		.cfi_startproc
 420              		@ args = 0, pretend = 0, frame = 0
 421              		@ frame_needed = 0, uses_anonymous_args = 0
 422              		@ link register save eliminated.
1505:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1506:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacStatus_t status = LORAMAC_STATUS_OK;
1507:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1508:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     switch( mibGet->Type )
1509:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case MIB_PING_SLOT_DATARATE:
1511:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1512:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             mibGet->Param.PingSlotDatarate = ClassBNvm->PingSlotCtx.Datarate;
1513:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1515:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case MIB_BEACON_STATE:
1516:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1517:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             mibGet->Param.BeaconState = Ctx.BeaconState;
1518:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1519:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         default:
1521:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1522:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             status = LORAMAC_STATUS_SERVICE_UNKNOWN;
1523:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1525:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1526:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return status;
1527:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1528:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return LORAMAC_STATUS_SERVICE_UNKNOWN;
 423              		.loc 1 1528 5 view .LVU47
1529:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1530:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 424              		.loc 1 1530 1 is_stmt 0 view .LVU48
 425 0000 0220     		movs	r0, #2
 426              	.LVL13:
 427              		.loc 1 1530 1 view .LVU49
 428 0002 7047     		bx	lr
 429              		.cfi_endproc
 430              	.LFE122:
 432              		.section	.text.LoRaMacMibClassBSetRequestConfirm,"ax",%progbits
 433              		.align	1
 434              		.global	LoRaMacMibClassBSetRequestConfirm
 435              		.syntax unified
 436              		.thumb
 437              		.thumb_func
 438              		.fpu softvfp
 440              	LoRaMacMibClassBSetRequestConfirm:
 441              	.LVL14:
 442              	.LFB123:
1531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1532:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** LoRaMacStatus_t LoRaMacMibClassBSetRequestConfirm( MibRequestConfirm_t *mibSet )
1533:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 443              		.loc 1 1533 1 is_stmt 1 view -0
 444              		.cfi_startproc
ARM GAS  /tmp/ccw9RQ3F.s 			page 35


 445              		@ args = 0, pretend = 0, frame = 0
 446              		@ frame_needed = 0, uses_anonymous_args = 0
 447              		@ link register save eliminated.
1534:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1535:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacStatus_t status = LORAMAC_STATUS_OK;
1536:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     switch( mibSet->Type )
1538:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         case MIB_PING_SLOT_DATARATE:
1540:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->PingSlotCtx.Datarate = mibSet->Param.PingSlotDatarate;
1542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1543:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1544:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         default:
1545:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1546:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             status = LORAMAC_STATUS_SERVICE_UNKNOWN;
1547:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             break;
1548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1549:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1550:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return status;
1551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1552:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return LORAMAC_STATUS_SERVICE_UNKNOWN;
 448              		.loc 1 1552 5 view .LVU51
1553:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1554:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 449              		.loc 1 1554 1 is_stmt 0 view .LVU52
 450 0000 0220     		movs	r0, #2
 451              	.LVL15:
 452              		.loc 1 1554 1 view .LVU53
 453 0002 7047     		bx	lr
 454              		.cfi_endproc
 455              	.LFE123:
 457              		.section	.text.LoRaMacClassBPingSlotInfoAns,"ax",%progbits
 458              		.align	1
 459              		.global	LoRaMacClassBPingSlotInfoAns
 460              		.syntax unified
 461              		.thumb
 462              		.thumb_func
 463              		.fpu softvfp
 465              	LoRaMacClassBPingSlotInfoAns:
 466              	.LFB124:
1555:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1556:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBPingSlotInfoAns( void )
1557:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 467              		.loc 1 1557 1 is_stmt 1 view -0
 468              		.cfi_startproc
 469              		@ args = 0, pretend = 0, frame = 0
 470              		@ frame_needed = 0, uses_anonymous_args = 0
 471              		@ link register save eliminated.
1558:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1559:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( LoRaMacConfirmQueueIsCmdActive( MLME_PING_SLOT_INFO ) == true )
1560:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1561:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_OK, MLME_PING_SLOT_INFO );
1562:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         ClassBNvm->PingSlotCtx.Ctrl.Assigned = 1;
1563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1565:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
ARM GAS  /tmp/ccw9RQ3F.s 			page 36


 472              		.loc 1 1565 1 view .LVU55
 473 0000 7047     		bx	lr
 474              		.cfi_endproc
 475              	.LFE124:
 477              		.section	.text.LoRaMacClassBPingSlotChannelReq,"ax",%progbits
 478              		.align	1
 479              		.global	LoRaMacClassBPingSlotChannelReq
 480              		.syntax unified
 481              		.thumb
 482              		.thumb_func
 483              		.fpu softvfp
 485              	LoRaMacClassBPingSlotChannelReq:
 486              	.LVL16:
 487              	.LFB125:
1566:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** uint8_t LoRaMacClassBPingSlotChannelReq( uint8_t datarate, uint32_t frequency )
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 488              		.loc 1 1568 1 view -0
 489              		.cfi_startproc
 490              		@ args = 0, pretend = 0, frame = 0
 491              		@ frame_needed = 0, uses_anonymous_args = 0
 492              		@ link register save eliminated.
1569:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint8_t status = 0x03;
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     VerifyParams_t verify;
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     bool isCustomFreq = false;
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( frequency != 0 )
1575:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         isCustomFreq = true;
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         verify.Frequency = frequency;
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( RegionVerify( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &verify, PHY_FREQUENCY ) == false
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             status &= 0xFE; // Channel frequency KO
1581:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1583:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     verify.DatarateParams.Datarate = datarate;
1585:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     verify.DatarateParams.DownlinkDwellTime = Ctx.LoRaMacClassBParams.LoRaMacParams->DownlinkDwellT
1586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( RegionVerify( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &verify, PHY_RX_DR ) == false )
1588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         status &= 0xFD; // Datarate range KO
1590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( status == 0x03 )
1593:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( isCustomFreq == true )
1595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1596:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->PingSlotCtx.Ctrl.CustomFreq = 1;
1597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->PingSlotCtx.Frequency = frequency;
1598:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1599:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         else
1600:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1601:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->PingSlotCtx.Ctrl.CustomFreq = 0;
1602:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->PingSlotCtx.Frequency = 0;
1603:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
ARM GAS  /tmp/ccw9RQ3F.s 			page 37


1604:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         ClassBNvm->PingSlotCtx.Datarate = datarate;
1605:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1606:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1607:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return status;
1608:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1609:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return 0;
 493              		.loc 1 1609 5 view .LVU57
1610:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1611:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 494              		.loc 1 1611 1 is_stmt 0 view .LVU58
 495 0000 0020     		movs	r0, #0
 496              	.LVL17:
 497              		.loc 1 1611 1 view .LVU59
 498 0002 7047     		bx	lr
 499              		.cfi_endproc
 500              	.LFE125:
 502              		.section	.text.LoRaMacClassBBeaconTimingAns,"ax",%progbits
 503              		.align	1
 504              		.global	LoRaMacClassBBeaconTimingAns
 505              		.syntax unified
 506              		.thumb
 507              		.thumb_func
 508              		.fpu softvfp
 510              	LoRaMacClassBBeaconTimingAns:
 511              	.LVL18:
 512              	.LFB126:
1612:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1613:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBBeaconTimingAns( uint16_t beaconTimingDelay, uint8_t beaconTimingChannel, TimerTi
1614:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 513              		.loc 1 1614 1 is_stmt 1 view -0
 514              		.cfi_startproc
 515              		@ args = 0, pretend = 0, frame = 0
 516              		@ frame_needed = 0, uses_anonymous_args = 0
 517              		@ link register save eliminated.
1615:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1616:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.BeaconTimingDelay = ( CLASSB_BEACON_DELAY_BEACON_TIMING_ANS * beaconTimingDelay )
1617:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.BeaconTimingChannel = beaconTimingChannel;
1618:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1619:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( LoRaMacConfirmQueueIsCmdActive( MLME_BEACON_TIMING ) == true )
1620:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1621:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( Ctx.BeaconCtx.BeaconTimingDelay > CLASSB_BEACON_INTERVAL )
1622:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1623:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // We missed the beacon already
1624:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTimingDelay = 0;
1625:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTimingChannel = 0;
1626:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_BEACON_NOT_FOUND, MLME_BEACON_T
1627:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1628:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         else
1629:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1630:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.Ctrl.BeaconDelaySet = 1;
1631:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.Ctrl.BeaconChannelSet = 1;
1632:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.NextBeaconRx = SysTimeFromMs( lastRxDone + Ctx.BeaconCtx.BeaconTimingDela
1633:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_OK, MLME_BEACON_TIMING );
1634:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1635:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1636:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBParams.MlmeConfirm->BeaconTimingDelay = Ctx.BeaconCtx.BeaconTimingDelay;
1637:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.LoRaMacClassBParams.MlmeConfirm->BeaconTimingChannel = Ctx.BeaconCtx.BeaconTimingChanne
ARM GAS  /tmp/ccw9RQ3F.s 			page 38


1638:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1639:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1640:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 518              		.loc 1 1640 1 view .LVU61
 519 0000 7047     		bx	lr
 520              		.cfi_endproc
 521              	.LFE126:
 523              		.section	.text.LoRaMacClassBDeviceTimeAns,"ax",%progbits
 524              		.align	1
 525              		.global	LoRaMacClassBDeviceTimeAns
 526              		.syntax unified
 527              		.thumb
 528              		.thumb_func
 529              		.fpu softvfp
 531              	LoRaMacClassBDeviceTimeAns:
 532              	.LFB127:
1641:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1642:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBDeviceTimeAns( void )
1643:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 533              		.loc 1 1643 1 view -0
 534              		.cfi_startproc
 535              		@ args = 0, pretend = 0, frame = 0
 536              		@ frame_needed = 0, uses_anonymous_args = 0
 537              		@ link register save eliminated.
1644:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1645:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1646:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     SysTime_t nextBeacon = SysTimeGet( );
1647:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     uint32_t currentTimeMs = SysTimeToMs( nextBeacon );
1648:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1649:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     nextBeacon.Seconds = nextBeacon.Seconds + ( 128 - ( nextBeacon.Seconds % 128 ) );
1650:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     nextBeacon.SubSeconds = 0;
1651:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1652:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.NextBeaconRx = nextBeacon;
1653:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     Ctx.BeaconCtx.LastBeaconRx = SysTimeSub( Ctx.BeaconCtx.NextBeaconRx, ( SysTime_t ){ .Seconds = 
1654:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1655:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( LoRaMacConfirmQueueIsCmdActive( MLME_DEVICE_TIME ) == true )
1656:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1657:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( currentTimeMs > SysTimeToMs( Ctx.BeaconCtx.NextBeaconRx ) )
1658:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1659:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             // We missed the beacon already
1660:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.LastBeaconRx.Seconds = 0;
1661:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.LastBeaconRx.SubSeconds = 0;
1662:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.NextBeaconRx.Seconds = 0;
1663:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.NextBeaconRx.SubSeconds = 0;
1664:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_BEACON_NOT_FOUND, MLME_DEVICE_T
1665:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1666:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         else
1667:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1668:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.Ctrl.BeaconDelaySet = 1;
1669:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTimingDelay = SysTimeToMs( Ctx.BeaconCtx.NextBeaconRx ) - currentTi
1670:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTime.Seconds = nextBeacon.Seconds - UNIX_GPS_EPOCH_OFFSET - 128;
1671:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             Ctx.BeaconCtx.BeaconTime.SubSeconds = 0;
1672:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacConfirmQueueSetStatus( LORAMAC_EVENT_INFO_STATUS_OK, MLME_DEVICE_TIME );
1673:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1674:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1675:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1676:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
ARM GAS  /tmp/ccw9RQ3F.s 			page 39


 538              		.loc 1 1676 1 view .LVU63
 539 0000 7047     		bx	lr
 540              		.cfi_endproc
 541              	.LFE127:
 543              		.section	.text.LoRaMacClassBBeaconFreqReq,"ax",%progbits
 544              		.align	1
 545              		.global	LoRaMacClassBBeaconFreqReq
 546              		.syntax unified
 547              		.thumb
 548              		.thumb_func
 549              		.fpu softvfp
 551              	LoRaMacClassBBeaconFreqReq:
 552              	.LVL19:
 553              	.LFB128:
1677:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1678:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** bool LoRaMacClassBBeaconFreqReq( uint32_t frequency )
1679:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 554              		.loc 1 1679 1 view -0
 555              		.cfi_startproc
 556              		@ args = 0, pretend = 0, frame = 0
 557              		@ frame_needed = 0, uses_anonymous_args = 0
 558              		@ link register save eliminated.
1680:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1681:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     VerifyParams_t verify;
1682:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1683:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( frequency != 0 )
1684:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1685:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         verify.Frequency = frequency;
1686:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1687:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( RegionVerify( *Ctx.LoRaMacClassBParams.LoRaMacRegion, &verify, PHY_FREQUENCY ) == true 
1688:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1689:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->BeaconCtx.Ctrl.CustomFreq = 1;
1690:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             ClassBNvm->BeaconCtx.Frequency = frequency;
1691:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             return true;
1692:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1693:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1694:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     else
1695:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1696:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         ClassBNvm->BeaconCtx.Ctrl.CustomFreq = 0;
1697:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return true;
1698:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1699:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
1700:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1701:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return false;
 559              		.loc 1 1701 5 view .LVU65
1702:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1703:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 560              		.loc 1 1703 1 is_stmt 0 view .LVU66
 561 0000 0020     		movs	r0, #0
 562              	.LVL20:
 563              		.loc 1 1703 1 view .LVU67
 564 0002 7047     		bx	lr
 565              		.cfi_endproc
 566              	.LFE128:
 568              		.section	.text.LoRaMacClassBIsUplinkCollision,"ax",%progbits
 569              		.align	1
 570              		.global	LoRaMacClassBIsUplinkCollision
ARM GAS  /tmp/ccw9RQ3F.s 			page 40


 571              		.syntax unified
 572              		.thumb
 573              		.thumb_func
 574              		.fpu softvfp
 576              	LoRaMacClassBIsUplinkCollision:
 577              	.LVL21:
 578              	.LFB129:
1704:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1705:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** TimerTime_t LoRaMacClassBIsUplinkCollision( TimerTime_t txTimeOnAir )
1706:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 579              		.loc 1 1706 1 is_stmt 1 view -0
 580              		.cfi_startproc
 581              		@ args = 0, pretend = 0, frame = 0
 582              		@ frame_needed = 0, uses_anonymous_args = 0
 583              		@ link register save eliminated.
1707:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1708:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t currentTime = TimerGetCurrentTime( );
1709:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t beaconReserved = 0;
1710:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerTime_t nextBeacon = SysTimeToMs( Ctx.BeaconCtx.NextBeaconRx );
1711:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     beaconReserved = nextBeacon -
1713:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                      CLASSB_BEACON_GUARD -
1714:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                      Ctx.LoRaMacClassBParams.LoRaMacParams->ReceiveDelay1 -
1715:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                      Ctx.LoRaMacClassBParams.LoRaMacParams->ReceiveDelay2 -
1716:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****                      txTimeOnAir;
1717:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1718:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     // Check if the next beacon will be received during the next uplink.
1719:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ( currentTime >= beaconReserved ) && ( currentTime < ( nextBeacon + CLASSB_BEACON_RESERVED 
1720:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {// Next beacon will be sent during the next uplink.
1721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         return CLASSB_BEACON_RESERVED;
1722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return 0;
1724:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #else
1725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     return 0;
 584              		.loc 1 1725 5 view .LVU69
1726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 585              		.loc 1 1727 1 is_stmt 0 view .LVU70
 586 0000 0020     		movs	r0, #0
 587              	.LVL22:
 588              		.loc 1 1727 1 view .LVU71
 589 0002 7047     		bx	lr
 590              		.cfi_endproc
 591              	.LFE129:
 593              		.section	.text.LoRaMacClassBStopRxSlots,"ax",%progbits
 594              		.align	1
 595              		.global	LoRaMacClassBStopRxSlots
 596              		.syntax unified
 597              		.thumb
 598              		.thumb_func
 599              		.fpu softvfp
 601              	LoRaMacClassBStopRxSlots:
 602              	.LFB130:
1728:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1729:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBStopRxSlots( void )
1730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 603              		.loc 1 1730 1 is_stmt 1 view -0
ARM GAS  /tmp/ccw9RQ3F.s 			page 41


 604              		.cfi_startproc
 605              		@ args = 0, pretend = 0, frame = 0
 606              		@ frame_needed = 0, uses_anonymous_args = 0
 607              		@ link register save eliminated.
1731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1732:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerStop( &Ctx.PingSlotTimer );
1733:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     TimerStop( &Ctx.MulticastSlotTimer );
1734:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1735:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     CRITICAL_SECTION_BEGIN( );
1736:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Events.PingSlot = 0;
1737:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Events.MulticastSlot = 0;
1738:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     CRITICAL_SECTION_END( );
1739:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1740:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 608              		.loc 1 1740 1 view .LVU73
 609 0000 7047     		bx	lr
 610              		.cfi_endproc
 611              	.LFE130:
 613              		.section	.text.LoRaMacClassBStartRxSlots,"ax",%progbits
 614              		.align	1
 615              		.global	LoRaMacClassBStartRxSlots
 616              		.syntax unified
 617              		.thumb
 618              		.thumb_func
 619              		.fpu softvfp
 621              	LoRaMacClassBStartRxSlots:
 622              	.LFB131:
1741:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1742:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBStartRxSlots( void )
1743:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 623              		.loc 1 1743 1 view -0
 624              		.cfi_startproc
 625              		@ args = 0, pretend = 0, frame = 0
 626              		@ frame_needed = 0, uses_anonymous_args = 0
 627              		@ link register save eliminated.
1744:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1745:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( ClassBNvm->PingSlotCtx.Ctrl.Assigned == 1 )
1746:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1747:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.PingSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1748:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerSetValue( &Ctx.PingSlotTimer, 1 );
1749:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerStart( &Ctx.PingSlotTimer );
1750:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1751:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         Ctx.MulticastSlotState = PINGSLOT_STATE_CALC_PING_OFFSET;
1752:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerSetValue( &Ctx.MulticastSlotTimer, 1 );
1753:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         TimerStart( &Ctx.MulticastSlotTimer );
1754:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1755:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1756:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 628              		.loc 1 1756 1 view .LVU75
 629 0000 7047     		bx	lr
 630              		.cfi_endproc
 631              	.LFE131:
 633              		.section	.text.LoRaMacClassBSetMulticastPeriodicity,"ax",%progbits
 634              		.align	1
 635              		.global	LoRaMacClassBSetMulticastPeriodicity
 636              		.syntax unified
 637              		.thumb
ARM GAS  /tmp/ccw9RQ3F.s 			page 42


 638              		.thumb_func
 639              		.fpu softvfp
 641              	LoRaMacClassBSetMulticastPeriodicity:
 642              	.LVL23:
 643              	.LFB132:
1757:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1758:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBSetMulticastPeriodicity( MulticastCtx_t* multicastChannel )
1759:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 644              		.loc 1 1759 1 view -0
 645              		.cfi_startproc
 646              		@ args = 0, pretend = 0, frame = 0
 647              		@ frame_needed = 0, uses_anonymous_args = 0
 648              		@ link register save eliminated.
1760:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1761:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( multicastChannel != NULL )
1762:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1763:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         multicastChannel->PingNb = CalcPingNb( multicastChannel->ChannelParams.RxParams.ClassB.Peri
1764:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         multicastChannel->PingPeriod = CalcPingPeriod( multicastChannel->PingNb );
1765:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1766:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1767:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 649              		.loc 1 1767 1 view .LVU77
 650 0000 7047     		bx	lr
 651              		.cfi_endproc
 652              	.LFE132:
 654              		.section	.text.LoRaMacClassBProcess,"ax",%progbits
 655              		.align	1
 656              		.global	LoRaMacClassBProcess
 657              		.syntax unified
 658              		.thumb
 659              		.thumb_func
 660              		.fpu softvfp
 662              	LoRaMacClassBProcess:
 663              	.LFB133:
1768:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1769:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** void LoRaMacClassBProcess( void )
1770:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** {
 664              		.loc 1 1770 1 view -0
 665              		.cfi_startproc
 666              		@ args = 0, pretend = 0, frame = 0
 667              		@ frame_needed = 0, uses_anonymous_args = 0
 668              		@ link register save eliminated.
1771:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
1772:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents_t events;
1773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1774:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     CRITICAL_SECTION_BEGIN( );
1775:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     events = LoRaMacClassBEvents;
1776:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     LoRaMacClassBEvents.Value = 0;
1777:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     CRITICAL_SECTION_END( );
1778:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** 
1779:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     if( events.Value != 0 )
1780:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     {
1781:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( events.Events.Beacon == 1 )
1782:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1783:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBProcessBeacon( );
1784:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1785:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( events.Events.PingSlot == 1 )
ARM GAS  /tmp/ccw9RQ3F.s 			page 43


1786:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1787:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBProcessPingSlot( );
1788:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1789:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         if( events.Events.MulticastSlot == 1 )
1790:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         {
1791:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****             LoRaMacClassBProcessMulticastSlot( );
1792:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****         }
1793:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c ****     }
1794:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** #endif /* LORAMAC_CLASSB_ENABLED */
1795:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.c **** }
 669              		.loc 1 1795 1 view .LVU79
 670 0000 7047     		bx	lr
 671              		.cfi_endproc
 672              	.LFE133:
 674              		.text
 675              	.Letext0:
 676              		.file 2 "/home/eatkinso/Downloads/gcc-arm-none-eabi-10.3-2021.07/gcc-arm-none-eabi-10.3-2021.07/ar
 677              		.file 3 "/home/eatkinso/Downloads/gcc-arm-none-eabi-10.3-2021.07/gcc-arm-none-eabi-10.3-2021.07/ar
 678              		.file 4 "Middlewares/Third_Party/LoRaWAN/Utilities/utilities.h"
 679              		.file 5 "Utilities/timer/stm32_timer.h"
 680              		.file 6 "Utilities/misc/stm32_systime.h"
 681              		.file 7 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacTypes.h"
 682              		.file 8 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCryptoNvm.h"
 683              		.file 9 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element-nvm.h"
 684              		.file 10 "Middlewares/Third_Party/LoRaWAN/Mac/Region/RegionNvm.h"
 685              		.file 11 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassBNvm.h"
 686              		.file 12 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMac.h"
 687              		.file 13 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacClassB.h"
ARM GAS  /tmp/ccw9RQ3F.s 			page 44


DEFINED SYMBOLS
                            *ABS*:0000000000000000 LoRaMacClassB.c
     /tmp/ccw9RQ3F.s:16     .text.LoRaMacClassBInit:0000000000000000 $t
     /tmp/ccw9RQ3F.s:24     .text.LoRaMacClassBInit:0000000000000000 LoRaMacClassBInit
     /tmp/ccw9RQ3F.s:39     .text.LoRaMacClassBSetBeaconState:0000000000000000 $t
     /tmp/ccw9RQ3F.s:46     .text.LoRaMacClassBSetBeaconState:0000000000000000 LoRaMacClassBSetBeaconState
     /tmp/ccw9RQ3F.s:60     .text.LoRaMacClassBSetPingSlotState:0000000000000000 $t
     /tmp/ccw9RQ3F.s:67     .text.LoRaMacClassBSetPingSlotState:0000000000000000 LoRaMacClassBSetPingSlotState
     /tmp/ccw9RQ3F.s:81     .text.LoRaMacClassBSetMulticastSlotState:0000000000000000 $t
     /tmp/ccw9RQ3F.s:88     .text.LoRaMacClassBSetMulticastSlotState:0000000000000000 LoRaMacClassBSetMulticastSlotState
     /tmp/ccw9RQ3F.s:102    .text.LoRaMacClassBIsAcquisitionInProgress:0000000000000000 $t
     /tmp/ccw9RQ3F.s:109    .text.LoRaMacClassBIsAcquisitionInProgress:0000000000000000 LoRaMacClassBIsAcquisitionInProgress
     /tmp/ccw9RQ3F.s:124    .text.LoRaMacClassBBeaconTimerEvent:0000000000000000 $t
     /tmp/ccw9RQ3F.s:131    .text.LoRaMacClassBBeaconTimerEvent:0000000000000000 LoRaMacClassBBeaconTimerEvent
     /tmp/ccw9RQ3F.s:145    .text.LoRaMacClassBPingSlotTimerEvent:0000000000000000 $t
     /tmp/ccw9RQ3F.s:152    .text.LoRaMacClassBPingSlotTimerEvent:0000000000000000 LoRaMacClassBPingSlotTimerEvent
     /tmp/ccw9RQ3F.s:166    .text.LoRaMacClassBMulticastSlotTimerEvent:0000000000000000 $t
     /tmp/ccw9RQ3F.s:173    .text.LoRaMacClassBMulticastSlotTimerEvent:0000000000000000 LoRaMacClassBMulticastSlotTimerEvent
     /tmp/ccw9RQ3F.s:187    .text.LoRaMacClassBRxBeacon:0000000000000000 $t
     /tmp/ccw9RQ3F.s:194    .text.LoRaMacClassBRxBeacon:0000000000000000 LoRaMacClassBRxBeacon
     /tmp/ccw9RQ3F.s:212    .text.LoRaMacClassBIsBeaconExpected:0000000000000000 $t
     /tmp/ccw9RQ3F.s:219    .text.LoRaMacClassBIsBeaconExpected:0000000000000000 LoRaMacClassBIsBeaconExpected
     /tmp/ccw9RQ3F.s:234    .text.LoRaMacClassBIsPingExpected:0000000000000000 $t
     /tmp/ccw9RQ3F.s:241    .text.LoRaMacClassBIsPingExpected:0000000000000000 LoRaMacClassBIsPingExpected
     /tmp/ccw9RQ3F.s:256    .text.LoRaMacClassBIsMulticastExpected:0000000000000000 $t
     /tmp/ccw9RQ3F.s:263    .text.LoRaMacClassBIsMulticastExpected:0000000000000000 LoRaMacClassBIsMulticastExpected
     /tmp/ccw9RQ3F.s:278    .text.LoRaMacClassBIsAcquisitionPending:0000000000000000 $t
     /tmp/ccw9RQ3F.s:285    .text.LoRaMacClassBIsAcquisitionPending:0000000000000000 LoRaMacClassBIsAcquisitionPending
     /tmp/ccw9RQ3F.s:300    .text.LoRaMacClassBIsBeaconModeActive:0000000000000000 $t
     /tmp/ccw9RQ3F.s:307    .text.LoRaMacClassBIsBeaconModeActive:0000000000000000 LoRaMacClassBIsBeaconModeActive
     /tmp/ccw9RQ3F.s:322    .text.LoRaMacClassBSetPingSlotInfo:0000000000000000 $t
     /tmp/ccw9RQ3F.s:329    .text.LoRaMacClassBSetPingSlotInfo:0000000000000000 LoRaMacClassBSetPingSlotInfo
     /tmp/ccw9RQ3F.s:343    .text.LoRaMacClassBHaltBeaconing:0000000000000000 $t
     /tmp/ccw9RQ3F.s:350    .text.LoRaMacClassBHaltBeaconing:0000000000000000 LoRaMacClassBHaltBeaconing
     /tmp/ccw9RQ3F.s:363    .text.LoRaMacClassBResumeBeaconing:0000000000000000 $t
     /tmp/ccw9RQ3F.s:370    .text.LoRaMacClassBResumeBeaconing:0000000000000000 LoRaMacClassBResumeBeaconing
     /tmp/ccw9RQ3F.s:383    .text.LoRaMacClassBSwitchClass:0000000000000000 $t
     /tmp/ccw9RQ3F.s:390    .text.LoRaMacClassBSwitchClass:0000000000000000 LoRaMacClassBSwitchClass
     /tmp/ccw9RQ3F.s:408    .text.LoRaMacClassBMibGetRequestConfirm:0000000000000000 $t
     /tmp/ccw9RQ3F.s:415    .text.LoRaMacClassBMibGetRequestConfirm:0000000000000000 LoRaMacClassBMibGetRequestConfirm
     /tmp/ccw9RQ3F.s:433    .text.LoRaMacMibClassBSetRequestConfirm:0000000000000000 $t
     /tmp/ccw9RQ3F.s:440    .text.LoRaMacMibClassBSetRequestConfirm:0000000000000000 LoRaMacMibClassBSetRequestConfirm
     /tmp/ccw9RQ3F.s:458    .text.LoRaMacClassBPingSlotInfoAns:0000000000000000 $t
     /tmp/ccw9RQ3F.s:465    .text.LoRaMacClassBPingSlotInfoAns:0000000000000000 LoRaMacClassBPingSlotInfoAns
     /tmp/ccw9RQ3F.s:478    .text.LoRaMacClassBPingSlotChannelReq:0000000000000000 $t
     /tmp/ccw9RQ3F.s:485    .text.LoRaMacClassBPingSlotChannelReq:0000000000000000 LoRaMacClassBPingSlotChannelReq
     /tmp/ccw9RQ3F.s:503    .text.LoRaMacClassBBeaconTimingAns:0000000000000000 $t
     /tmp/ccw9RQ3F.s:510    .text.LoRaMacClassBBeaconTimingAns:0000000000000000 LoRaMacClassBBeaconTimingAns
     /tmp/ccw9RQ3F.s:524    .text.LoRaMacClassBDeviceTimeAns:0000000000000000 $t
     /tmp/ccw9RQ3F.s:531    .text.LoRaMacClassBDeviceTimeAns:0000000000000000 LoRaMacClassBDeviceTimeAns
     /tmp/ccw9RQ3F.s:544    .text.LoRaMacClassBBeaconFreqReq:0000000000000000 $t
     /tmp/ccw9RQ3F.s:551    .text.LoRaMacClassBBeaconFreqReq:0000000000000000 LoRaMacClassBBeaconFreqReq
     /tmp/ccw9RQ3F.s:569    .text.LoRaMacClassBIsUplinkCollision:0000000000000000 $t
     /tmp/ccw9RQ3F.s:576    .text.LoRaMacClassBIsUplinkCollision:0000000000000000 LoRaMacClassBIsUplinkCollision
     /tmp/ccw9RQ3F.s:594    .text.LoRaMacClassBStopRxSlots:0000000000000000 $t
     /tmp/ccw9RQ3F.s:601    .text.LoRaMacClassBStopRxSlots:0000000000000000 LoRaMacClassBStopRxSlots
     /tmp/ccw9RQ3F.s:614    .text.LoRaMacClassBStartRxSlots:0000000000000000 $t
ARM GAS  /tmp/ccw9RQ3F.s 			page 45


     /tmp/ccw9RQ3F.s:621    .text.LoRaMacClassBStartRxSlots:0000000000000000 LoRaMacClassBStartRxSlots
     /tmp/ccw9RQ3F.s:634    .text.LoRaMacClassBSetMulticastPeriodicity:0000000000000000 $t
     /tmp/ccw9RQ3F.s:641    .text.LoRaMacClassBSetMulticastPeriodicity:0000000000000000 LoRaMacClassBSetMulticastPeriodicity
     /tmp/ccw9RQ3F.s:655    .text.LoRaMacClassBProcess:0000000000000000 $t
     /tmp/ccw9RQ3F.s:662    .text.LoRaMacClassBProcess:0000000000000000 LoRaMacClassBProcess

NO UNDEFINED SYMBOLS
