ARM GAS  /tmp/ccgjJaEg.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"LoRaMacCrypto.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.PrepareB0,"ax",%progbits
  16              		.align	1
  17              		.arch armv7e-m
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	PrepareB0:
  24              	.LVL0:
  25              	.LFB105:
  26              		.file 1 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c"
   1:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
   2:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \file      LoRaMacCrypto.c
   3:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
   4:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \brief     LoRa MAC layer cryptography implementation
   5:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
   6:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \copyright Revised BSD License, see section \ref LICENSE.
   7:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
   8:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \code
   9:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *                ______                              _
  10:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               / _____)             _              | |
  11:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              ( (____  _____ ____ _| |_ _____  ____| |__
  12:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               \____ \| ___ |    (_   _) ___ |/ ___)  _ \
  13:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               _____) ) ____| | | || |_| ____( (___| | | |
  14:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              (______/|_____)_|_|_| \__)_____)\____)_| |_|
  15:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              (C)2013-2017 Semtech
  16:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  17:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               ___ _____ _   ___ _  _____ ___  ___  ___ ___
  18:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              / __|_   _/_\ / __| |/ / __/ _ \| _ \/ __| __|
  19:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              \__ \ | |/ _ \ (__| ' <| _| (_) |   / (__| _|
  20:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              |___/ |_/_/ \_\___|_|\_\_| \___/|_|_\\___|___|
  21:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              embedded.connectivity.solutions===============
  22:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  23:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \endcode
  24:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  25:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Miguel Luis ( Semtech )
  26:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  27:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Gregory Cristian ( Semtech )
  28:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  29:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Daniel Jaeckle ( STACKFORCE )
  30:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  31:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Johannes Bruder ( STACKFORCE )
  32:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
ARM GAS  /tmp/ccgjJaEg.s 			page 2


  33:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /**
  34:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   ******************************************************************************
  35:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   *
  36:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   *          Portions COPYRIGHT 2020 STMicroelectronics
  37:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   *
  38:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   * @file    LoRaMacCrypto.c
  39:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   * @author  MCD Application Team
  40:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   * @brief   LoRa MAC layer cryptography implementation
  41:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   ******************************************************************************
  42:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   */
  43:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include <stdbool.h>
  44:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include <stdlib.h>
  45:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include <stdint.h>
  46:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  47:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "utilities.h"
  48:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "secure-element.h"
  49:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  50:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "LoRaMacParser.h"
  51:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "LoRaMacSerializer.h"
  52:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "LoRaMacCrypto.h"
  53:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  54:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  55:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Frame direction definition for uplink communications
  56:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  57:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define UPLINK                          0
  58:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  59:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  60:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Frame direction definition for downlink communications
  61:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  62:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define DOWNLINK                        1
  63:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  64:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  65:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * CMAC/AES Message Integrity Code (MIC) Block B0 size
  66:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  67:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define MIC_BLOCK_BX_SIZE               16
  68:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  69:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
  70:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  71:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Number of security context entries
  72:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  73:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define NUM_OF_SEC_CTX                  LORAMAC_MAX_MC_CTX + 1
  74:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_END */
  75:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  76:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  77:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Maximum size of the message that can be handled by the crypto operations
  78:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  79:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define CRYPTO_MAXMESSAGE_SIZE          256
  80:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  81:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  82:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Maximum size of the buffer for crypto operations
  83:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  84:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define CRYPTO_BUFFER_SIZE              CRYPTO_MAXMESSAGE_SIZE + MIC_BLOCK_BX_SIZE
  85:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  86:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  87:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Key-Address item
  88:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  89:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** typedef struct sKeyAddr
ARM GAS  /tmp/ccgjJaEg.s 			page 3


  90:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
  91:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
  92:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Address identifier
  93:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
  94:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     AddressIdentifier_t AddrID;
  95:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
  96:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Application session key
  97:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
  98:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t AppSkey;
  99:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
 100:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Network session key
 101:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
 102:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t NwkSkey;
 103:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
 104:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Rootkey (Multicast only)
 105:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
 106:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t RootKey;
 107:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }KeyAddr_t;
 108:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 109:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 110:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 111:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * RJcount0 is a counter incremented with every Type 0 or 2 Rejoin frame transmitted.
 112:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 113:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static uint16_t RJcount0;
 114:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 115:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 116:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 117:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Non volatile module context.
 118:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 119:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoNvmData_t* CryptoNvm;
 120:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 121:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 122:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Key-Address list
 123:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 124:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static KeyAddr_t KeyAddrList[NUM_OF_SEC_CTX] =
 125:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 126:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
 127:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 128:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_0_ADDR, MC_APP_S_KEY_0, MC_NWK_S_KEY_0, MC_KEY_0 },
 129:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 130:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 131:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_1_ADDR, MC_APP_S_KEY_1, MC_NWK_S_KEY_1, MC_KEY_1 },
 132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 2 )
 134:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_2_ADDR, MC_APP_S_KEY_2, MC_NWK_S_KEY_2, MC_KEY_2 },
 135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 2 */
 136:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 3 )
 137:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_3_ADDR, MC_APP_S_KEY_3, MC_NWK_S_KEY_3, MC_KEY_3 },
 138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 3 */
 139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_END */
 140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 ) /* ST_WORKAROUND: integrate 1.1.x keys only if required */
 141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { UNICAST_DEV_ADDR, APP_S_KEY, S_NWK_S_INT_KEY, NO_KEY }
 142:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 143:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { UNICAST_DEV_ADDR, APP_S_KEY, NWK_S_KEY, NO_KEY }
 144:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 145:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     };
 146:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 4


 147:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Encrypts the payload
 149:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 150:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID            - Key identifier
 151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  address          - Address
 152:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir              - Frame direction ( Uplink or Downlink )
 153:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  frameCounter     - Frame counter
 154:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  size             - Size of data
 155:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  buffer       - Data buffer
 156:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                      - Status of the operation
 157:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 158:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t PayloadEncrypt( uint8_t* buffer, int16_t size, KeyIdentifier_t keyID, 
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 161:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 163:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 164:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t bufferIndex = 0;
 166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t ctr = 1;
 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t sBlock[16] = { 0 };
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 169:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[0] = 0x01;
 171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[5] = dir;
 173:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[6] = address & 0xFF;
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 178:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[10] = frameCounter & 0xFF;
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 183:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     while( size > 0 )
 185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         aBlock[15] = ctr & 0xFF;
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ctr++;
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 189:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 191:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 192:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         for( uint8_t i = 0; i < ( ( size > 16 ) ? 16 : size ); i++ )
 194:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             buffer[bufferIndex + i] = buffer[bufferIndex + i] ^ sBlock[i];
 196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         size -= 16;
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 199:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 203:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 5


 204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 206:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Encrypts the FOpts
 207:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 208:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  address          - Address
 209:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir              - Frame direction ( Uplink or Downlink )
 210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCntID           - Frame counter identifier
 211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  frameCounter     - Frame counter
 212:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  size             - Size of data
 213:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  buffer       - Data buffer
 214:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                      - Status of the operation
 215:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 216:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t FOptsEncrypt( uint16_t size, uint32_t address, uint8_t dir, FCntIdenti
 217:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 218:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 219:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 220:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 221:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 222:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 223:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t bufferIndex = 0;
 224:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t sBlock[16] = { 0 };
 225:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 226:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 227:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[0] = 0x01;
 228:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 229:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Value > 0x01010000 )
 230:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 231:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Introduced in LoRaWAN 1.1.1 specification
 232:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         switch( fCntID )
 233:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 234:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             case FCNT_UP:
 235:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
 236:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 aBlock[4] = 0x01;
 237:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 break;
 238:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
 239:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             case N_FCNT_DOWN:
 240:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
 241:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 aBlock[4] = 0x01;
 242:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 break;
 243:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
 244:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             case A_FCNT_DOWN:
 245:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
 246:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 aBlock[4] = 0x02;
 247:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 break;
 248:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
 249:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             default:
 250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 return LORAMAC_CRYPTO_FAIL_PARAM;
 251:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[5] = dir;
 255:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[6] = address & 0xFF;
 257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 258:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 259:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 260:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 6


 261:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[10] = frameCounter & 0xFF;
 262:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 263:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 264:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 265:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 266:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Value > 0x01010000 )
 267:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 268:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Introduced in LoRaWAN 1.1.1 specification
 269:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         aBlock[15] = 0x01;
 270:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 271:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 272:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( size > 0 )
 273:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 274:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, NWK_S_ENC_KEY, sBlock ) != SECURE_ELEMENT_SUCCESS 
 275:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 276:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 277:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         for( uint8_t i = 0; i < size; i++ )
 279:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 280:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             buffer[bufferIndex + i] = buffer[bufferIndex + i] ^ sBlock[i];
 281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 282:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 283:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 284:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 285:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 286:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 287:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 288:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Prepares B0 block for cmac computation.
 290:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 291:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msgLen         - Length of message
 292:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 293:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 294:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir            - Frame direction ( Uplink:0, Downlink:1 )
 296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCnt           - Frame counter
 297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  b0         - B0 block
 298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 299:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t PrepareB0( uint16_t msgLen, KeyIdentifier_t keyID, bool isAck, uint8_t
 301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
  27              		.loc 1 301 1 view -0
  28              		.cfi_startproc
  29              		@ args = 12, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
  32              		.loc 1 301 1 is_stmt 0 view .LVU1
  33 0000 10B4     		push	{r4}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 4
  36              		.cfi_offset 4, -4
  37 0002 019C     		ldr	r4, [sp, #4]
  38 0004 0299     		ldr	r1, [sp, #8]
  39              	.LVL1:
  40              		.loc 1 301 1 view .LVU2
  41 0006 039A     		ldr	r2, [sp, #12]
  42              	.LVL2:
ARM GAS  /tmp/ccgjJaEg.s 			page 7


 302:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( b0 == 0 )
  43              		.loc 1 302 5 is_stmt 1 view .LVU3
  44              		.loc 1 302 7 is_stmt 0 view .LVU4
  45 0008 DAB1     		cbz	r2, .L3
  46 000a 8446     		mov	ip, r0
 303:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 305:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 307:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[0] = 0x49;
  47              		.loc 1 307 5 is_stmt 1 view .LVU5
  48              		.loc 1 307 11 is_stmt 0 view .LVU6
  49 000c 4920     		movs	r0, #73
  50              	.LVL3:
  51              		.loc 1 307 11 view .LVU7
  52 000e 1070     		strb	r0, [r2]
 308:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORAROUND_BEGIN: These bytes are only used for the LRWAN 1.1.x */
 309:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( isAck == true ) && ( dir == DOWNLINK ) )
 311:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 312:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // confFCnt contains the frame counter value modulo 2^16 of the "confirmed" uplink or downl
 313:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint16_t confFCnt = 0;
 314:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         confFCnt = ( uint16_t )( CryptoNvm->FCntList.FCntUp % 65536 );
 316:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 317:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[1] = confFCnt & 0xFF;
 318:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[2] = ( confFCnt >> 8 ) & 0xFF;
 319:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 320:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 321:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 322:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORAROUND_END */
 323:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 324:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[1] = 0x00;
  53              		.loc 1 324 9 is_stmt 1 view .LVU8
  54              		.loc 1 324 15 is_stmt 0 view .LVU9
  55 0010 0020     		movs	r0, #0
  56 0012 5070     		strb	r0, [r2, #1]
 325:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[2] = 0x00;
  57              		.loc 1 325 9 is_stmt 1 view .LVU10
  58              		.loc 1 325 15 is_stmt 0 view .LVU11
  59 0014 9070     		strb	r0, [r2, #2]
 326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 327:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 328:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[3] = 0x00;
  60              		.loc 1 328 5 is_stmt 1 view .LVU12
  61              		.loc 1 328 11 is_stmt 0 view .LVU13
  62 0016 D070     		strb	r0, [r2, #3]
 329:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[4] = 0x00;
  63              		.loc 1 329 5 is_stmt 1 view .LVU14
  64              		.loc 1 329 11 is_stmt 0 view .LVU15
  65 0018 1071     		strb	r0, [r2, #4]
 330:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 331:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[5] = dir;
  66              		.loc 1 331 5 is_stmt 1 view .LVU16
  67              		.loc 1 331 11 is_stmt 0 view .LVU17
  68 001a 5371     		strb	r3, [r2, #5]
 332:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 8


 333:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[6] = devAddr & 0xFF;
  69              		.loc 1 333 5 is_stmt 1 view .LVU18
  70              		.loc 1 333 11 is_stmt 0 view .LVU19
  71 001c 9471     		strb	r4, [r2, #6]
 334:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[7] = ( devAddr >> 8 ) & 0xFF;
  72              		.loc 1 334 5 is_stmt 1 view .LVU20
  73              		.loc 1 334 23 is_stmt 0 view .LVU21
  74 001e 230A     		lsrs	r3, r4, #8
  75              	.LVL4:
  76              		.loc 1 334 11 view .LVU22
  77 0020 D371     		strb	r3, [r2, #7]
 335:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[8] = ( devAddr >> 16 ) & 0xFF;
  78              		.loc 1 335 5 is_stmt 1 view .LVU23
  79              		.loc 1 335 23 is_stmt 0 view .LVU24
  80 0022 230C     		lsrs	r3, r4, #16
  81              		.loc 1 335 11 view .LVU25
  82 0024 1372     		strb	r3, [r2, #8]
 336:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[9] = ( devAddr >> 24 ) & 0xFF;
  83              		.loc 1 336 5 is_stmt 1 view .LVU26
  84              		.loc 1 336 23 is_stmt 0 view .LVU27
  85 0026 240E     		lsrs	r4, r4, #24
  86              		.loc 1 336 11 view .LVU28
  87 0028 5472     		strb	r4, [r2, #9]
 337:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 338:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[10] = fCnt & 0xFF;
  88              		.loc 1 338 5 is_stmt 1 view .LVU29
  89              		.loc 1 338 12 is_stmt 0 view .LVU30
  90 002a 9172     		strb	r1, [r2, #10]
 339:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[11] = ( fCnt >> 8 ) & 0xFF;
  91              		.loc 1 339 5 is_stmt 1 view .LVU31
  92              		.loc 1 339 21 is_stmt 0 view .LVU32
  93 002c 0B0A     		lsrs	r3, r1, #8
  94              		.loc 1 339 12 view .LVU33
  95 002e D372     		strb	r3, [r2, #11]
 340:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[12] = ( fCnt >> 16 ) & 0xFF;
  96              		.loc 1 340 5 is_stmt 1 view .LVU34
  97              		.loc 1 340 21 is_stmt 0 view .LVU35
  98 0030 0B0C     		lsrs	r3, r1, #16
  99              		.loc 1 340 12 view .LVU36
 100 0032 1373     		strb	r3, [r2, #12]
 341:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[13] = ( fCnt >> 24 ) & 0xFF;
 101              		.loc 1 341 5 is_stmt 1 view .LVU37
 102              		.loc 1 341 21 is_stmt 0 view .LVU38
 103 0034 090E     		lsrs	r1, r1, #24
 104              		.loc 1 341 12 view .LVU39
 105 0036 5173     		strb	r1, [r2, #13]
 342:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 343:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[14] = 0x00;
 106              		.loc 1 343 5 is_stmt 1 view .LVU40
 107              		.loc 1 343 12 is_stmt 0 view .LVU41
 108 0038 9073     		strb	r0, [r2, #14]
 344:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 345:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[15] = msgLen & 0xFF;
 109              		.loc 1 345 5 is_stmt 1 view .LVU42
 110              		.loc 1 345 12 is_stmt 0 view .LVU43
 111 003a 82F80FC0 		strb	ip, [r2, #15]
 346:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 9


 347:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 112              		.loc 1 347 5 is_stmt 1 view .LVU44
 113              	.LVL5:
 114              	.L2:
 348:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 115              		.loc 1 348 1 is_stmt 0 view .LVU45
 116 003e 10BC     		pop	{r4}
 117              	.LCFI1:
 118              		.cfi_remember_state
 119              		.cfi_restore 4
 120              		.cfi_def_cfa_offset 0
 121              	.LVL6:
 122              		.loc 1 348 1 view .LVU46
 123 0040 7047     		bx	lr
 124              	.LVL7:
 125              	.L3:
 126              	.LCFI2:
 127              		.cfi_restore_state
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 128              		.loc 1 304 16 view .LVU47
 129 0042 0A20     		movs	r0, #10
 130              	.LVL8:
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 131              		.loc 1 304 16 view .LVU48
 132 0044 FBE7     		b	.L2
 133              		.cfi_endproc
 134              	.LFE105:
 136              		.section	.text.GetKeyAddrItem,"ax",%progbits
 137              		.align	1
 138              		.syntax unified
 139              		.thumb
 140              		.thumb_func
 141              		.fpu softvfp
 143              	GetKeyAddrItem:
 144              	.LVL9:
 145              	.LFB108:
 349:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 350:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 351:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Computes cmac with adding B0 block in front.
 352:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 353:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *  cmac = aes128_cmac(keyID, B0 | msg)
 354:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msg            - Message to compute the integrity code
 356:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  len            - Length of message
 357:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 358:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 359:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 360:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir            - Frame direction ( Uplink:0, Downlink:1 )
 361:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCnt           - Frame counter
 362:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[OUT] cmac           - Computed cmac
 363:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 364:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 365:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t ComputeCmacB0( uint8_t* msg, uint16_t len, KeyIdentifier_t keyID, bool
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 368:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
ARM GAS  /tmp/ccgjJaEg.s 			page 10


 370:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( len > CRYPTO_MAXMESSAGE_SIZE )
 372:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_BUF_SIZE;
 374:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 375:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t micBuff[MIC_BLOCK_BX_SIZE];
 377:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 378:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize the first Block
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     PrepareB0( len, keyID, isAck, dir, devAddr, fCnt, micBuff );
 380:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( micBuff, msg, len, keyID, cmac ) != SECURE_ELEMENT_SUCCESS )
 382:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 384:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 385:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 387:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 388:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
 389:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Verifies cmac with adding B0 block in front.
 390:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 391:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msg            - Message to compute the integrity code
 392:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  len            - Length of message
 393:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 394:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 395:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 396:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir            - Frame direction ( Uplink:0, Downlink:1 )
 397:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCnt           - Frame counter
 398:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[in]  expectedCmac   - Expected cmac
 399:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 400:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 401:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t VerifyCmacB0( uint8_t* msg, uint16_t len, KeyIdentifier_t keyID, bool 
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( msg == 0 )
 404:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 406:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( len > CRYPTO_MAXMESSAGE_SIZE )
 408:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_BUF_SIZE;
 410:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 411:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t micBuff[CRYPTO_BUFFER_SIZE];
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memset1( micBuff, 0, CRYPTO_BUFFER_SIZE );
 414:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize the first Block
 416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     PrepareB0( len, keyID, isAck, dir, devAddr, fCnt, micBuff );
 417:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 418:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Copy the given data to the mic computation buffer
 419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpy1( ( micBuff + MIC_BLOCK_BX_SIZE ), msg, len );
 420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = SecureElementVerifyAesCmac( micBuff, ( len + MIC_BLOCK_BX_SIZE ), expectedCmac, keyID 
 423:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval == SECURE_ELEMENT_SUCCESS )
 425:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 426:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_SUCCESS;
ARM GAS  /tmp/ccgjJaEg.s 			page 11


 427:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else if( retval == SECURE_ELEMENT_FAIL_CMAC )
 429:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 430:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_MIC;
 431:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 432:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 435:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 436:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 438:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Prpares B1 block for cmac computation.
 439:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 440:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msgLen         - Length of message
 441:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 442:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 443:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txDr           - Data rate used for the transmission
 444:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txCh           - Index of the channel used for the transmission
 445:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 446:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCntUp         - Frame counter
 447:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  b0         - B0 block
 448:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 449:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 450:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t PrepareB1( uint16_t msgLen, KeyIdentifier_t keyID, bool isAck, uint8_t
 451:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 452:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( b1 == 0 )
 453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 454:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 455:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 456:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 457:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[0] = 0x49;
 458:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 459:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( isAck == true )
 460:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 461:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // confFCnt contains the frame counter value modulo 2^16 of the "confirmed" uplink frame th
 462:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint16_t confFCnt = ( uint16_t )( *CryptoNvm->LastDownFCnt % 65536 );
 463:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[1] = confFCnt & 0xFF;
 464:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[2] = ( confFCnt >> 8 ) & 0xFF;
 465:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 466:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 467:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 468:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[1] = 0x00;
 469:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[2] = 0x00;
 470:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 471:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 472:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[3] = txDr;
 473:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[4] = txCh;
 474:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[5] = UPLINK;  // dir = Uplink
 475:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 476:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[6] = devAddr & 0xFF;
 477:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[7] = ( devAddr >> 8 ) & 0xFF;
 478:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[8] = ( devAddr >> 16 ) & 0xFF;
 479:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[9] = ( devAddr >> 24 ) & 0xFF;
 480:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 481:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[10] = fCntUp & 0xFF;
 482:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[11] = ( fCntUp >> 8 ) & 0xFF;
 483:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[12] = ( fCntUp >> 16 ) & 0xFF;
ARM GAS  /tmp/ccgjJaEg.s 			page 12


 484:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[13] = ( fCntUp >> 24 ) & 0xFF;
 485:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 486:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[14] = 0x00;
 487:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 488:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[15] = msgLen & 0xFF;
 489:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 490:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 491:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 492:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 493:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 494:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Computes cmac with adding B1 block in front ( only for Uplink frames LoRaWAN 1.1 )
 495:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 496:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *  cmac = aes128_cmac(keyID, B1 | msg)
 497:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 498:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msg            - Message to calculate the Integrity code
 499:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  len            - Length of message
 500:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 501:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 502:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txDr           - Data rate used for the transmission
 503:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txCh           - Index of the channel used for the transmission
 504:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 505:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCntUp         - Uplink Frame counter
 506:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[OUT] cmac           - Computed cmac
 507:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 508:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 509:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t ComputeCmacB1( uint8_t* msg, uint16_t len, KeyIdentifier_t keyID, bool
 510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 511:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 512:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 513:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 515:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( len > CRYPTO_MAXMESSAGE_SIZE )
 516:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 517:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_BUF_SIZE;
 518:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 519:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t micBuff[MIC_BLOCK_BX_SIZE];
 521:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 522:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize the first Block
 523:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     PrepareB1( len, keyID, isAck, txDr, txCh, devAddr, fCntUp, micBuff );
 524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 525:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( micBuff, msg, len, keyID, cmac ) != SECURE_ELEMENT_SUCCESS )
 526:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 527:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 528:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 529:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 530:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 532:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 533:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 534:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Gets security item from list.
 535:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 536:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  addrID          - Address identifier
 537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[OUT] keyItem        - Key item reference
 538:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 540:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t GetKeyAddrItem( AddressIdentifier_t addrID, KeyAddr_t** item )
ARM GAS  /tmp/ccgjJaEg.s 			page 13


 541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 146              		.loc 1 541 1 is_stmt 1 view -0
 147              		.cfi_startproc
 148              		@ args = 0, pretend = 0, frame = 0
 149              		@ frame_needed = 0, uses_anonymous_args = 0
 150              		@ link register save eliminated.
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 151              		.loc 1 542 5 view .LVU50
 152              	.LBB2:
 153              		.loc 1 542 10 view .LVU51
 154              		.loc 1 542 18 is_stmt 0 view .LVU52
 155 0000 0023     		movs	r3, #0
 156              	.LVL10:
 157              	.L6:
 158              		.loc 1 542 25 is_stmt 1 discriminator 1 view .LVU53
 159              		.loc 1 542 5 is_stmt 0 discriminator 1 view .LVU54
 160 0002 012B     		cmp	r3, #1
 161 0004 0ED8     		bhi	.L10
 543:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 544:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( KeyAddrList[i].AddrID == addrID )
 162              		.loc 1 544 9 is_stmt 1 view .LVU55
 163              		.loc 1 544 27 is_stmt 0 view .LVU56
 164 0006 9C46     		mov	ip, r3
 165 0008 074A     		ldr	r2, .L12
 166 000a 12F82320 		ldrb	r2, [r2, r3, lsl #2]	@ zero_extendqisi2
 167              		.loc 1 544 11 view .LVU57
 168 000e 8242     		cmp	r2, r0
 169 0010 02D0     		beq	.L11
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 170              		.loc 1 542 45 is_stmt 1 discriminator 2 view .LVU58
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 171              		.loc 1 542 46 is_stmt 0 discriminator 2 view .LVU59
 172 0012 0133     		adds	r3, r3, #1
 173              	.LVL11:
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 174              		.loc 1 542 46 discriminator 2 view .LVU60
 175 0014 DBB2     		uxtb	r3, r3
 176              	.LVL12:
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 177              		.loc 1 542 46 discriminator 2 view .LVU61
 178 0016 F4E7     		b	.L6
 179              	.L11:
 545:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 546:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *item = &( KeyAddrList[i] );
 180              		.loc 1 546 13 is_stmt 1 view .LVU62
 181              		.loc 1 546 21 is_stmt 0 view .LVU63
 182 0018 034B     		ldr	r3, .L12
 183              	.LVL13:
 184              		.loc 1 546 21 view .LVU64
 185 001a 03EB8C03 		add	r3, r3, ip, lsl #2
 186              		.loc 1 546 19 view .LVU65
 187 001e 0B60     		str	r3, [r1]
 547:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_SUCCESS;
 188              		.loc 1 547 13 is_stmt 1 view .LVU66
 189              		.loc 1 547 20 is_stmt 0 view .LVU67
 190 0020 0020     		movs	r0, #0
 191              	.LVL14:
ARM GAS  /tmp/ccgjJaEg.s 			page 14


 192              		.loc 1 547 20 view .LVU68
 193 0022 7047     		bx	lr
 194              	.LVL15:
 195              	.L10:
 196              		.loc 1 547 20 view .LVU69
 197              	.LBE2:
 548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 549:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 550:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_ERROR_INVALID_ADDR_ID;
 198              		.loc 1 550 12 view .LVU70
 199 0024 0C20     		movs	r0, #12
 200              	.LVL16:
 551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 201              		.loc 1 551 1 view .LVU71
 202 0026 7047     		bx	lr
 203              	.L13:
 204              		.align	2
 205              	.L12:
 206 0028 00000000 		.word	.LANCHOR0
 207              		.cfi_endproc
 208              	.LFE108:
 210              		.section	.text.GetLastFcntDown,"ax",%progbits
 211              		.align	1
 212              		.syntax unified
 213              		.thumb
 214              		.thumb_func
 215              		.fpu softvfp
 217              	GetLastFcntDown:
 218              	.LVL17:
 219              	.LFB110:
 552:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 553:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 554:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Derives a session key as of LoRaWAN versions prior to 1.1.0
 555:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 556:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key Identifier for the key to be calculated
 557:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  joinNonce      - Sever nonce
 558:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  netID          - Network Identifier
 559:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  deviceNonce    - Device nonce
 560:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 561:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 562:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t DeriveSessionKey10x( KeyIdentifier_t keyID, uint32_t joinNonce, uint32
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 565:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 566:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( keyID )
 568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 569:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case F_NWK_S_INT_KEY:
 571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case S_NWK_S_INT_KEY:
 572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case NWK_S_ENC_KEY:
 573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case NWK_S_KEY:
 575:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x01;
 577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case APP_S_KEY:
ARM GAS  /tmp/ccgjJaEg.s 			page 15


 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x02;
 580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 581:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 583:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****    /* ST_WORKAROUND_END */
 585:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[1] = ( uint8_t )( ( joinNonce >> 0 ) & 0xFF );
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[4] = ( uint8_t )( ( netID >> 0 ) & 0xFF );
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[5] = ( uint8_t )( ( netID >> 8 ) & 0xFF );
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 593:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[7] = ( uint8_t )( ( devNonce >> 0 ) & 0xFF );
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[8] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 596:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, NWK_KEY, keyID ) != SECURE_ELEMENT_SUCCESS )
 598:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 599:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 600:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 601:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 602:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 603:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 604:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 605:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 606:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 607:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Derives a session key as of LoRaWAN 1.1.0
 608:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 609:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key Identifier for the key to be calculated
 610:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  joinNonce      - Sever nonce
 611:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  joinEUI        - Join Server EUI
 612:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  deviceNonce    - Device nonce
 613:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 614:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 615:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t DeriveSessionKey11x( KeyIdentifier_t keyID, uint32_t joinNonce, uint8_
 616:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 617:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( joinEUI == 0 )
 618:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 619:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 620:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 621:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 622:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 623:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t rootKeyId = NWK_KEY;
 624:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 625:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( keyID )
 626:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 627:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case F_NWK_S_INT_KEY:
 628:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x01;
 629:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 630:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case S_NWK_S_INT_KEY:
 631:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x03;
 632:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 633:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case NWK_S_ENC_KEY:
 634:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x04;
 635:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
ARM GAS  /tmp/ccgjJaEg.s 			page 16


 636:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case APP_S_KEY:
 637:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             rootKeyId = APP_KEY;
 638:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x02;
 639:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 640:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 641:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 642:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 643:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 644:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[1] = ( uint8_t )( ( joinNonce >> 0 ) & 0xFF );
 645:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 646:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 647:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 648:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpyr( compBase + 4, joinEUI, 8 );
 649:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 650:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[12] = ( uint8_t )( ( devNonce >> 0 ) & 0xFF );
 651:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[13] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 652:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 653:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, rootKeyId, keyID ) != SECURE_ELEMENT_SUCCESS )
 654:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 655:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 656:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 657:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 658:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 659:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 660:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 661:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 662:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Derives a life time session key (JSIntKey or JSEncKey)  as of LoRaWAN 1.1.0
 663:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 664:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key Identifier for the key to be calculated
 665:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devEUI         - Device EUI
 666:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 667:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 668:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t DeriveLifeTimeSessionKey( KeyIdentifier_t keyID, uint8_t* devEUI )
 669:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 670:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( devEUI == 0 )
 671:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 672:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 673:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 674:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 675:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 676:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 677:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( keyID )
 678:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 679:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case J_S_INT_KEY:
 680:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x06;
 681:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 682:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case J_S_ENC_KEY:
 683:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x05;
 684:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 685:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 686:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 687:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 688:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 689:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpyr( compBase + 1, devEUI, 8 );
 690:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 691:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, NWK_KEY, keyID ) != SECURE_ELEMENT_SUCCESS )
 692:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
ARM GAS  /tmp/ccgjJaEg.s 			page 17


 693:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 694:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 695:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 696:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 697:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 698:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 699:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 700:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 701:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Gets the last received frame counter
 702:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 703:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     fCntID       - Frame counter identifier
 704:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     lastDown     - Last downlink counter value
 705:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 706:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                     - Status of the operation
 707:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 708:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t GetLastFcntDown( FCntIdentifier_t fCntID, uint32_t* lastDown )
 709:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 220              		.loc 1 709 1 is_stmt 1 view -0
 221              		.cfi_startproc
 222              		@ args = 0, pretend = 0, frame = 0
 223              		@ frame_needed = 0, uses_anonymous_args = 0
 224              		@ link register save eliminated.
 710:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( lastDown == NULL )
 225              		.loc 1 710 5 view .LVU73
 226              		.loc 1 710 7 is_stmt 0 view .LVU74
 227 0000 0B46     		mov	r3, r1
 228 0002 0029     		cmp	r1, #0
 229 0004 24D0     		beq	.L21
 711:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 713:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 714:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( fCntID )
 230              		.loc 1 714 5 is_stmt 1 view .LVU75
 231 0006 0138     		subs	r0, r0, #1
 232              	.LVL18:
 233              		.loc 1 714 5 is_stmt 0 view .LVU76
 234 0008 0328     		cmp	r0, #3
 235 000a 23D8     		bhi	.L22
 236 000c DFE800F0 		tbb	[pc, r0]
 237              	.L17:
 238 0010 02       		.byte	(.L20-.L17)/2
 239 0011 0A       		.byte	(.L19-.L17)/2
 240 0012 12       		.byte	(.L18-.L17)/2
 241 0013 1A       		.byte	(.L16-.L17)/2
 242              		.p2align 1
 243              	.L20:
 715:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 716:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case N_FCNT_DOWN:
 717:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.NFCntDown;
 244              		.loc 1 717 13 is_stmt 1 view .LVU77
 245              		.loc 1 717 34 is_stmt 0 view .LVU78
 246 0014 104A     		ldr	r2, .L23
 247 0016 1268     		ldr	r2, [r2]
 248              		.loc 1 717 44 view .LVU79
 249 0018 1169     		ldr	r1, [r2, #16]
 250              	.LVL19:
 251              		.loc 1 717 23 view .LVU80
ARM GAS  /tmp/ccgjJaEg.s 			page 18


 252 001a 1960     		str	r1, [r3]
 718:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.NFCntDown;
 253              		.loc 1 718 13 is_stmt 1 view .LVU81
 254              		.loc 1 718 58 is_stmt 0 view .LVU82
 255 001c 1369     		ldr	r3, [r2, #16]
 256              	.LVL20:
 257              		.loc 1 718 37 view .LVU83
 258 001e 1362     		str	r3, [r2, #32]
 719:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 259              		.loc 1 719 13 is_stmt 1 view .LVU84
 720:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case A_FCNT_DOWN:
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.AFCntDown;
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 724:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.FCntDown;
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 728:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 729:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_0:
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[0];
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 732:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 733:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 734:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_1:
 735:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[1];
 736:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 737:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 738:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 2 )
 739:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_2:
 740:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[2];
 741:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 742:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 2 */
 743:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 3 )
 744:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_3:
 745:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[3];
 746:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 747:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 3 */
 748:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 749:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_ID;
 750:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 751:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 260              		.loc 1 751 12 is_stmt 0 view .LVU85
 261 0020 0020     		movs	r0, #0
 719:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 262              		.loc 1 719 13 view .LVU86
 263 0022 7047     		bx	lr
 264              	.LVL21:
 265              	.L19:
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 266              		.loc 1 721 13 is_stmt 1 view .LVU87
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 267              		.loc 1 721 34 is_stmt 0 view .LVU88
 268 0024 0C4A     		ldr	r2, .L23
 269 0026 1268     		ldr	r2, [r2]
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 270              		.loc 1 721 44 view .LVU89
ARM GAS  /tmp/ccgjJaEg.s 			page 19


 271 0028 5169     		ldr	r1, [r2, #20]
 272              	.LVL22:
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 273              		.loc 1 721 23 view .LVU90
 274 002a 1960     		str	r1, [r3]
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 275              		.loc 1 722 13 is_stmt 1 view .LVU91
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 276              		.loc 1 722 58 is_stmt 0 view .LVU92
 277 002c 5369     		ldr	r3, [r2, #20]
 278              	.LVL23:
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 279              		.loc 1 722 37 view .LVU93
 280 002e 1362     		str	r3, [r2, #32]
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 281              		.loc 1 723 13 is_stmt 1 view .LVU94
 282              		.loc 1 751 12 is_stmt 0 view .LVU95
 283 0030 0020     		movs	r0, #0
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 284              		.loc 1 723 13 view .LVU96
 285 0032 7047     		bx	lr
 286              	.LVL24:
 287              	.L18:
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 288              		.loc 1 725 13 is_stmt 1 view .LVU97
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 289              		.loc 1 725 34 is_stmt 0 view .LVU98
 290 0034 084A     		ldr	r2, .L23
 291 0036 1268     		ldr	r2, [r2]
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 292              		.loc 1 725 44 view .LVU99
 293 0038 9169     		ldr	r1, [r2, #24]
 294              	.LVL25:
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 295              		.loc 1 725 23 view .LVU100
 296 003a 1960     		str	r1, [r3]
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 297              		.loc 1 726 13 is_stmt 1 view .LVU101
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 298              		.loc 1 726 58 is_stmt 0 view .LVU102
 299 003c 9369     		ldr	r3, [r2, #24]
 300              	.LVL26:
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 301              		.loc 1 726 37 view .LVU103
 302 003e 1362     		str	r3, [r2, #32]
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 303              		.loc 1 727 13 is_stmt 1 view .LVU104
 304              		.loc 1 751 12 is_stmt 0 view .LVU105
 305 0040 0020     		movs	r0, #0
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 306              		.loc 1 727 13 view .LVU106
 307 0042 7047     		bx	lr
 308              	.LVL27:
 309              	.L16:
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 310              		.loc 1 730 13 is_stmt 1 view .LVU107
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
ARM GAS  /tmp/ccgjJaEg.s 			page 20


 311              		.loc 1 730 34 is_stmt 0 view .LVU108
 312 0044 044A     		ldr	r2, .L23
 313 0046 1268     		ldr	r2, [r2]
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 314              		.loc 1 730 55 view .LVU109
 315 0048 D269     		ldr	r2, [r2, #28]
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 316              		.loc 1 730 23 view .LVU110
 317 004a 0A60     		str	r2, [r1]
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 318              		.loc 1 731 13 is_stmt 1 view .LVU111
 319              		.loc 1 751 12 is_stmt 0 view .LVU112
 320 004c 0020     		movs	r0, #0
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 321              		.loc 1 731 13 view .LVU113
 322 004e 7047     		bx	lr
 323              	.LVL28:
 324              	.L21:
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 325              		.loc 1 712 16 view .LVU114
 326 0050 0A20     		movs	r0, #10
 327              	.LVL29:
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 328              		.loc 1 712 16 view .LVU115
 329 0052 7047     		bx	lr
 330              	.L22:
 714:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 331              		.loc 1 714 5 view .LVU116
 332 0054 0520     		movs	r0, #5
 752:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 333              		.loc 1 752 1 view .LVU117
 334 0056 7047     		bx	lr
 335              	.L24:
 336              		.align	2
 337              	.L23:
 338 0058 00000000 		.word	.LANCHOR1
 339              		.cfi_endproc
 340              	.LFE110:
 342              		.section	.text.CheckFCntDown,"ax",%progbits
 343              		.align	1
 344              		.syntax unified
 345              		.thumb
 346              		.thumb_func
 347              		.fpu softvfp
 349              	CheckFCntDown:
 350              	.LVL30:
 351              	.LFB111:
 753:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 754:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 755:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Checks the downlink counter value
 756:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 757:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     fCntID       - Frame counter identifier
 758:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     currentDown  - Current downlink counter value
 759:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 760:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                     - Status of the operation
 761:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 762:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static bool CheckFCntDown( FCntIdentifier_t fCntID, uint32_t currentDown )
ARM GAS  /tmp/ccgjJaEg.s 			page 21


 763:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 352              		.loc 1 763 1 is_stmt 1 view -0
 353              		.cfi_startproc
 354              		@ args = 0, pretend = 0, frame = 8
 355              		@ frame_needed = 0, uses_anonymous_args = 0
 356              		.loc 1 763 1 is_stmt 0 view .LVU119
 357 0000 10B5     		push	{r4, lr}
 358              	.LCFI3:
 359              		.cfi_def_cfa_offset 8
 360              		.cfi_offset 4, -8
 361              		.cfi_offset 14, -4
 362 0002 82B0     		sub	sp, sp, #8
 363              	.LCFI4:
 364              		.cfi_def_cfa_offset 16
 365 0004 0C46     		mov	r4, r1
 764:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t lastDown = 0;
 366              		.loc 1 764 5 is_stmt 1 view .LVU120
 367              		.loc 1 764 14 is_stmt 0 view .LVU121
 368 0006 0023     		movs	r3, #0
 369 0008 0193     		str	r3, [sp, #4]
 765:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( GetLastFcntDown( fCntID, &lastDown ) != LORAMAC_CRYPTO_SUCCESS )
 370              		.loc 1 765 5 is_stmt 1 view .LVU122
 371              		.loc 1 765 9 is_stmt 0 view .LVU123
 372 000a 01A9     		add	r1, sp, #4
 373              	.LVL31:
 374              		.loc 1 765 9 view .LVU124
 375 000c FFF7FEFF 		bl	GetLastFcntDown
 376              	.LVL32:
 377              		.loc 1 765 7 view .LVU125
 378 0010 48B9     		cbnz	r0, .L27
 766:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 767:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return false;
 768:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 769:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( currentDown > lastDown ) ||
 379              		.loc 1 769 5 is_stmt 1 view .LVU126
 380              		.loc 1 769 23 is_stmt 0 view .LVU127
 381 0012 019B     		ldr	r3, [sp, #4]
 382              		.loc 1 769 7 view .LVU128
 383 0014 A342     		cmp	r3, r4
 384 0016 09D3     		bcc	.L28
 385              		.loc 1 769 36 discriminator 1 view .LVU129
 386 0018 B3F1FF3F 		cmp	r3, #-1
 387 001c 01D0     		beq	.L31
 770:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // For LoRaWAN 1.0.X only. Allow downlink frames of 0
 771:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ( lastDown == FCNT_DOWN_INITAL_VALUE ) )
 772:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return true;
 774:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 775:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 776:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 777:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return false;
 388              		.loc 1 777 16 view .LVU130
 389 001e 0020     		movs	r0, #0
 390 0020 02E0     		b	.L26
 391              	.L31:
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 392              		.loc 1 773 16 view .LVU131
ARM GAS  /tmp/ccgjJaEg.s 			page 22


 393 0022 0120     		movs	r0, #1
 394 0024 00E0     		b	.L26
 395              	.L27:
 767:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 396              		.loc 1 767 16 view .LVU132
 397 0026 0020     		movs	r0, #0
 398              	.L26:
 778:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 779:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 399              		.loc 1 779 1 view .LVU133
 400 0028 02B0     		add	sp, sp, #8
 401              	.LCFI5:
 402              		.cfi_remember_state
 403              		.cfi_def_cfa_offset 8
 404              		@ sp needed
 405 002a 10BD     		pop	{r4, pc}
 406              	.LVL33:
 407              	.L28:
 408              	.LCFI6:
 409              		.cfi_restore_state
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 410              		.loc 1 773 16 view .LVU134
 411 002c 0120     		movs	r0, #1
 412 002e FBE7     		b	.L26
 413              		.cfi_endproc
 414              	.LFE111:
 416              		.section	.text.UpdateFCntDown,"ax",%progbits
 417              		.align	1
 418              		.syntax unified
 419              		.thumb
 420              		.thumb_func
 421              		.fpu softvfp
 423              	UpdateFCntDown:
 424              	.LVL34:
 425              	.LFB112:
 780:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 781:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
 782:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Updates the reference downlink counter
 783:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 784:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     fCntID        - Frame counter identifier
 785:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     currentDown   - Current downlink counter value
 786:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 787:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                     - Status of the operation
 788:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 789:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static void UpdateFCntDown( FCntIdentifier_t fCntID, uint32_t currentDown )
 790:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 426              		.loc 1 790 1 is_stmt 1 view -0
 427              		.cfi_startproc
 428              		@ args = 0, pretend = 0, frame = 0
 429              		@ frame_needed = 0, uses_anonymous_args = 0
 430              		@ link register save eliminated.
 791:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( fCntID )
 431              		.loc 1 791 5 view .LVU136
 432 0000 0138     		subs	r0, r0, #1
 433              	.LVL35:
 434              		.loc 1 791 5 is_stmt 0 view .LVU137
 435 0002 0328     		cmp	r0, #3
ARM GAS  /tmp/ccgjJaEg.s 			page 23


 436 0004 12D8     		bhi	.L32
 437 0006 DFE800F0 		tbb	[pc, r0]
 438              	.L35:
 439 000a 02       		.byte	(.L38-.L35)/2
 440 000b 06       		.byte	(.L37-.L35)/2
 441 000c 0A       		.byte	(.L36-.L35)/2
 442 000d 0E       		.byte	(.L34-.L35)/2
 443              		.p2align 1
 444              	.L38:
 792:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 793:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case N_FCNT_DOWN:
 794:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.NFCntDown = currentDown;
 445              		.loc 1 794 13 is_stmt 1 view .LVU138
 446              		.loc 1 794 22 is_stmt 0 view .LVU139
 447 000e 084B     		ldr	r3, .L39
 448 0010 1B68     		ldr	r3, [r3]
 449              		.loc 1 794 43 view .LVU140
 450 0012 1961     		str	r1, [r3, #16]
 795:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 451              		.loc 1 795 13 is_stmt 1 view .LVU141
 452 0014 7047     		bx	lr
 453              	.L37:
 796:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case A_FCNT_DOWN:
 797:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.AFCntDown = currentDown;
 454              		.loc 1 797 13 view .LVU142
 455              		.loc 1 797 22 is_stmt 0 view .LVU143
 456 0016 064B     		ldr	r3, .L39
 457 0018 1B68     		ldr	r3, [r3]
 458              		.loc 1 797 43 view .LVU144
 459 001a 5961     		str	r1, [r3, #20]
 798:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 460              		.loc 1 798 13 is_stmt 1 view .LVU145
 461 001c 7047     		bx	lr
 462              	.L36:
 799:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 800:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.FCntDown = currentDown;
 463              		.loc 1 800 13 view .LVU146
 464              		.loc 1 800 22 is_stmt 0 view .LVU147
 465 001e 044B     		ldr	r3, .L39
 466 0020 1B68     		ldr	r3, [r3]
 467              		.loc 1 800 42 view .LVU148
 468 0022 9961     		str	r1, [r3, #24]
 801:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 469              		.loc 1 801 13 is_stmt 1 view .LVU149
 470 0024 7047     		bx	lr
 471              	.L34:
 802:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 803:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_0:
 804:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[0] = currentDown;
 472              		.loc 1 804 13 view .LVU150
 473              		.loc 1 804 22 is_stmt 0 view .LVU151
 474 0026 024B     		ldr	r3, .L39
 475 0028 1B68     		ldr	r3, [r3]
 476              		.loc 1 804 47 view .LVU152
 477 002a D961     		str	r1, [r3, #28]
 805:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 478              		.loc 1 805 13 is_stmt 1 view .LVU153
ARM GAS  /tmp/ccgjJaEg.s 			page 24


 479              	.L32:
 806:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 807:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 808:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_1:
 809:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[1] = currentDown;
 810:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 811:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 812:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 2 )
 813:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_2:
 814:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[2] = currentDown;
 815:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 816:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 2 */
 817:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 3 )
 818:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_3:
 819:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[3] = currentDown;
 820:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 821:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 3 */
 822:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 823:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 824:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 825:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 480              		.loc 1 825 1 is_stmt 0 view .LVU154
 481 002c 7047     		bx	lr
 482              	.L40:
 483 002e 00BF     		.align	2
 484              	.L39:
 485 0030 00000000 		.word	.LANCHOR1
 486              		.cfi_endproc
 487              	.LFE112:
 489              		.section	.text.ResetFCnts,"ax",%progbits
 490              		.align	1
 491              		.syntax unified
 492              		.thumb
 493              		.thumb_func
 494              		.fpu softvfp
 496              	ResetFCnts:
 497              	.LFB113:
 826:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 827:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
 828:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Resets the frame counters
 829:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 830:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static void ResetFCnts( void )
 831:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 498              		.loc 1 831 1 is_stmt 1 view -0
 499              		.cfi_startproc
 500              		@ args = 0, pretend = 0, frame = 0
 501              		@ frame_needed = 0, uses_anonymous_args = 0
 502              		@ link register save eliminated.
 832:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntUp = 0;
 503              		.loc 1 832 5 view .LVU156
 504              		.loc 1 832 14 is_stmt 0 view .LVU157
 505 0000 0A4B     		ldr	r3, .L44
 506 0002 1A68     		ldr	r2, [r3]
 507              		.loc 1 832 32 view .LVU158
 508 0004 0023     		movs	r3, #0
 509 0006 D360     		str	r3, [r2, #12]
 833:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
ARM GAS  /tmp/ccgjJaEg.s 			page 25


 510              		.loc 1 833 5 is_stmt 1 view .LVU159
 511              		.loc 1 833 35 is_stmt 0 view .LVU160
 512 0008 4FF0FF31 		mov	r1, #-1
 513 000c 1161     		str	r1, [r2, #16]
 834:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
 514              		.loc 1 834 5 is_stmt 1 view .LVU161
 515              		.loc 1 834 35 is_stmt 0 view .LVU162
 516 000e 5161     		str	r1, [r2, #20]
 835:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
 517              		.loc 1 835 5 is_stmt 1 view .LVU163
 518              		.loc 1 835 34 is_stmt 0 view .LVU164
 519 0010 9161     		str	r1, [r2, #24]
 836:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 520              		.loc 1 836 5 is_stmt 1 view .LVU165
 521              		.loc 1 836 29 is_stmt 0 view .LVU166
 522 0012 1162     		str	r1, [r2, #32]
 837:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( int32_t i = 0; i < LORAMAC_MAX_MC_CTX; i++ )
 523              		.loc 1 838 5 is_stmt 1 view .LVU167
 524              	.LBB3:
 525              		.loc 1 838 10 view .LVU168
 526              	.LVL36:
 527              	.L42:
 528              		.loc 1 838 25 discriminator 1 view .LVU169
 529              		.loc 1 838 5 is_stmt 0 discriminator 1 view .LVU170
 530 0014 002B     		cmp	r3, #0
 531 0016 00DD     		ble	.L43
 532              	.LBE3:
 839:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         CryptoNvm->FCntList.McFCntDown[i] = FCNT_DOWN_INITAL_VALUE;
 841:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 842:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 533              		.loc 1 842 1 view .LVU171
 534 0018 7047     		bx	lr
 535              	.L43:
 536              	.LBB4:
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 537              		.loc 1 840 9 is_stmt 1 discriminator 3 view .LVU172
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 538              		.loc 1 840 43 is_stmt 0 discriminator 3 view .LVU173
 539 001a 991D     		adds	r1, r3, #6
 540 001c 02EB8101 		add	r1, r2, r1, lsl #2
 541 0020 4FF0FF30 		mov	r0, #-1
 542 0024 4860     		str	r0, [r1, #4]
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 543              		.loc 1 838 49 is_stmt 1 discriminator 3 view .LVU174
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 544              		.loc 1 838 50 is_stmt 0 discriminator 3 view .LVU175
 545 0026 0133     		adds	r3, r3, #1
 546              	.LVL37:
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 547              		.loc 1 838 50 discriminator 3 view .LVU176
 548 0028 F4E7     		b	.L42
 549              	.L45:
 550 002a 00BF     		.align	2
 551              	.L44:
 552 002c 00000000 		.word	.LANCHOR1
ARM GAS  /tmp/ccgjJaEg.s 			page 26


 553              	.LBE4:
 554              		.cfi_endproc
 555              	.LFE113:
 557              		.section	.text.ComputeCmacB0,"ax",%progbits
 558              		.align	1
 559              		.syntax unified
 560              		.thumb
 561              		.thumb_func
 562              		.fpu softvfp
 564              	ComputeCmacB0:
 565              	.LVL38:
 566              	.LFB106:
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 567              		.loc 1 366 1 is_stmt 1 view -0
 568              		.cfi_startproc
 569              		@ args = 16, pretend = 0, frame = 16
 570              		@ frame_needed = 0, uses_anonymous_args = 0
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 571              		.loc 1 366 1 is_stmt 0 view .LVU178
 572 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 573              	.LCFI7:
 574              		.cfi_def_cfa_offset 24
 575              		.cfi_offset 4, -24
 576              		.cfi_offset 5, -20
 577              		.cfi_offset 6, -16
 578              		.cfi_offset 7, -12
 579              		.cfi_offset 8, -8
 580              		.cfi_offset 14, -4
 581 0004 88B0     		sub	sp, sp, #32
 582              	.LCFI8:
 583              		.cfi_def_cfa_offset 56
 584 0006 119E     		ldr	r6, [sp, #68]
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 585              		.loc 1 367 5 is_stmt 1 view .LVU179
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 586              		.loc 1 367 7 is_stmt 0 view .LVU180
 587 0008 F0B1     		cbz	r0, .L48
 588 000a 0C46     		mov	r4, r1
 589 000c 1546     		mov	r5, r2
 590 000e 1A46     		mov	r2, r3
 591              	.LVL39:
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 592              		.loc 1 367 7 view .LVU181
 593 0010 8046     		mov	r8, r0
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 594              		.loc 1 367 22 discriminator 1 view .LVU182
 595 0012 DEB1     		cbz	r6, .L49
 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 596              		.loc 1 371 5 is_stmt 1 view .LVU183
 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 597              		.loc 1 371 7 is_stmt 0 view .LVU184
 598 0014 B1F5807F 		cmp	r1, #256
 599 0018 1AD8     		bhi	.L50
 376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 600              		.loc 1 376 5 is_stmt 1 view .LVU185
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 601              		.loc 1 379 5 view .LVU186
ARM GAS  /tmp/ccgjJaEg.s 			page 27


 602 001a 04AF     		add	r7, sp, #16
 603 001c 0297     		str	r7, [sp, #8]
 604 001e 109B     		ldr	r3, [sp, #64]
 605              	.LVL40:
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 606              		.loc 1 379 5 is_stmt 0 view .LVU187
 607 0020 0193     		str	r3, [sp, #4]
 608 0022 0F9B     		ldr	r3, [sp, #60]
 609 0024 0093     		str	r3, [sp]
 610 0026 9DF83830 		ldrb	r3, [sp, #56]	@ zero_extendqisi2
 611 002a 2946     		mov	r1, r5
 612              	.LVL41:
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 613              		.loc 1 379 5 view .LVU188
 614 002c 2046     		mov	r0, r4
 615              	.LVL42:
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 616              		.loc 1 379 5 view .LVU189
 617 002e FFF7FEFF 		bl	PrepareB0
 618              	.LVL43:
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 619              		.loc 1 381 5 is_stmt 1 view .LVU190
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 620              		.loc 1 381 9 is_stmt 0 view .LVU191
 621 0032 0096     		str	r6, [sp]
 622 0034 2B46     		mov	r3, r5
 623 0036 2246     		mov	r2, r4
 624 0038 4146     		mov	r1, r8
 625 003a 3846     		mov	r0, r7
 626 003c FFF7FEFF 		bl	SecureElementComputeAesCmac
 627              	.LVL44:
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 628              		.loc 1 381 7 view .LVU192
 629 0040 40B9     		cbnz	r0, .L53
 630              	.LVL45:
 631              	.L47:
 386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 632              		.loc 1 386 1 view .LVU193
 633 0042 08B0     		add	sp, sp, #32
 634              	.LCFI9:
 635              		.cfi_remember_state
 636              		.cfi_def_cfa_offset 24
 637              		@ sp needed
 638 0044 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 639              	.LVL46:
 640              	.L48:
 641              	.LCFI10:
 642              		.cfi_restore_state
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 643              		.loc 1 369 16 view .LVU194
 644 0048 0A20     		movs	r0, #10
 645              	.LVL47:
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 646              		.loc 1 369 16 view .LVU195
 647 004a FAE7     		b	.L47
 648              	.LVL48:
 649              	.L49:
ARM GAS  /tmp/ccgjJaEg.s 			page 28


 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 650              		.loc 1 369 16 view .LVU196
 651 004c 0A20     		movs	r0, #10
 652              	.LVL49:
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 653              		.loc 1 369 16 view .LVU197
 654 004e F8E7     		b	.L47
 655              	.LVL50:
 656              	.L50:
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 657              		.loc 1 373 16 view .LVU198
 658 0050 0E20     		movs	r0, #14
 659              	.LVL51:
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 660              		.loc 1 373 16 view .LVU199
 661 0052 F6E7     		b	.L47
 662              	.LVL52:
 663              	.L53:
 383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 664              		.loc 1 383 16 view .LVU200
 665 0054 0F20     		movs	r0, #15
 666 0056 F4E7     		b	.L47
 667              		.cfi_endproc
 668              	.LFE106:
 670              		.section	.text.DeriveSessionKey10x,"ax",%progbits
 671              		.align	1
 672              		.syntax unified
 673              		.thumb
 674              		.thumb_func
 675              		.fpu softvfp
 677              	DeriveSessionKey10x:
 678              	.LVL53:
 679              	.LFB109:
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 680              		.loc 1 563 1 is_stmt 1 view -0
 681              		.cfi_startproc
 682              		@ args = 0, pretend = 0, frame = 16
 683              		@ frame_needed = 0, uses_anonymous_args = 0
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 684              		.loc 1 563 1 is_stmt 0 view .LVU202
 685 0000 10B5     		push	{r4, lr}
 686              	.LCFI11:
 687              		.cfi_def_cfa_offset 8
 688              		.cfi_offset 4, -8
 689              		.cfi_offset 14, -4
 690 0002 84B0     		sub	sp, sp, #16
 691              	.LCFI12:
 692              		.cfi_def_cfa_offset 24
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 693              		.loc 1 564 5 is_stmt 1 view .LVU203
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 694              		.loc 1 564 13 is_stmt 0 view .LVU204
 695 0004 0024     		movs	r4, #0
 696 0006 0094     		str	r4, [sp]
 697 0008 0194     		str	r4, [sp, #4]
 698 000a 0294     		str	r4, [sp, #8]
 699 000c 0394     		str	r4, [sp, #12]
ARM GAS  /tmp/ccgjJaEg.s 			page 29


 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 700              		.loc 1 567 5 is_stmt 1 view .LVU205
 701 000e 0228     		cmp	r0, #2
 702 0010 03D0     		beq	.L55
 703 0012 0328     		cmp	r0, #3
 704 0014 25D0     		beq	.L56
 705 0016 0B20     		movs	r0, #11
 706              	.LVL54:
 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 707              		.loc 1 567 5 is_stmt 0 view .LVU206
 708 0018 21E0     		b	.L57
 709              	.LVL55:
 710              	.L55:
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 711              		.loc 1 576 13 is_stmt 1 view .LVU207
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 712              		.loc 1 576 25 is_stmt 0 view .LVU208
 713 001a 0124     		movs	r4, #1
 714 001c 8DF80040 		strb	r4, [sp]
 577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case APP_S_KEY:
 715              		.loc 1 577 13 is_stmt 1 view .LVU209
 716              	.L58:
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 717              		.loc 1 586 5 view .LVU210
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 718              		.loc 1 586 17 is_stmt 0 view .LVU211
 719 0020 8DF80110 		strb	r1, [sp, #1]
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 720              		.loc 1 587 5 is_stmt 1 view .LVU212
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 721              		.loc 1 587 19 is_stmt 0 view .LVU213
 722 0024 C1F30724 		ubfx	r4, r1, #8, #8
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 723              		.loc 1 587 17 view .LVU214
 724 0028 8DF80240 		strb	r4, [sp, #2]
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 725              		.loc 1 588 5 is_stmt 1 view .LVU215
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 726              		.loc 1 588 19 is_stmt 0 view .LVU216
 727 002c C1F30741 		ubfx	r1, r1, #16, #8
 728              	.LVL56:
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 729              		.loc 1 588 17 view .LVU217
 730 0030 8DF80310 		strb	r1, [sp, #3]
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[5] = ( uint8_t )( ( netID >> 8 ) & 0xFF );
 731              		.loc 1 590 5 is_stmt 1 view .LVU218
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[5] = ( uint8_t )( ( netID >> 8 ) & 0xFF );
 732              		.loc 1 590 17 is_stmt 0 view .LVU219
 733 0034 8DF80420 		strb	r2, [sp, #4]
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 734              		.loc 1 591 5 is_stmt 1 view .LVU220
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 735              		.loc 1 591 19 is_stmt 0 view .LVU221
 736 0038 C2F30721 		ubfx	r1, r2, #8, #8
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 737              		.loc 1 591 17 view .LVU222
 738 003c 8DF80510 		strb	r1, [sp, #5]
ARM GAS  /tmp/ccgjJaEg.s 			page 30


 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 739              		.loc 1 592 5 is_stmt 1 view .LVU223
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 740              		.loc 1 592 19 is_stmt 0 view .LVU224
 741 0040 C2F30742 		ubfx	r2, r2, #16, #8
 742              	.LVL57:
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 743              		.loc 1 592 17 view .LVU225
 744 0044 8DF80620 		strb	r2, [sp, #6]
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[8] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 745              		.loc 1 594 5 is_stmt 1 view .LVU226
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[8] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 746              		.loc 1 594 17 is_stmt 0 view .LVU227
 747 0048 8DF80730 		strb	r3, [sp, #7]
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 748              		.loc 1 595 5 is_stmt 1 view .LVU228
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 749              		.loc 1 595 19 is_stmt 0 view .LVU229
 750 004c 1B0A     		lsrs	r3, r3, #8
 751              	.LVL58:
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 752              		.loc 1 595 17 view .LVU230
 753 004e 8DF80830 		strb	r3, [sp, #8]
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 754              		.loc 1 597 5 is_stmt 1 view .LVU231
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 755              		.loc 1 597 9 is_stmt 0 view .LVU232
 756 0052 0246     		mov	r2, r0
 757 0054 0121     		movs	r1, #1
 758 0056 6846     		mov	r0, sp
 759              	.LVL59:
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 760              		.loc 1 597 9 view .LVU233
 761 0058 FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 762              	.LVL60:
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 763              		.loc 1 597 7 view .LVU234
 764 005c 28B9     		cbnz	r0, .L61
 765              	.L57:
 603:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 766              		.loc 1 603 1 view .LVU235
 767 005e 04B0     		add	sp, sp, #16
 768              	.LCFI13:
 769              		.cfi_remember_state
 770              		.cfi_def_cfa_offset 8
 771              		@ sp needed
 772 0060 10BD     		pop	{r4, pc}
 773              	.LVL61:
 774              	.L56:
 775              	.LCFI14:
 776              		.cfi_restore_state
 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 777              		.loc 1 579 13 is_stmt 1 view .LVU236
 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 778              		.loc 1 579 25 is_stmt 0 view .LVU237
 779 0062 0224     		movs	r4, #2
 780 0064 8DF80040 		strb	r4, [sp]
ARM GAS  /tmp/ccgjJaEg.s 			page 31


 580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 781              		.loc 1 580 13 is_stmt 1 view .LVU238
 782 0068 DAE7     		b	.L58
 783              	.LVL62:
 784              	.L61:
 599:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 785              		.loc 1 599 16 is_stmt 0 view .LVU239
 786 006a 0F20     		movs	r0, #15
 787 006c F7E7     		b	.L57
 788              		.cfi_endproc
 789              	.LFE109:
 791              		.section	.text.PayloadEncrypt,"ax",%progbits
 792              		.align	1
 793              		.syntax unified
 794              		.thumb
 795              		.thumb_func
 796              		.fpu softvfp
 798              	PayloadEncrypt:
 799              	.LVL63:
 800              	.LFB104:
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 801              		.loc 1 159 1 is_stmt 1 view -0
 802              		.cfi_startproc
 803              		@ args = 8, pretend = 0, frame = 32
 804              		@ frame_needed = 0, uses_anonymous_args = 0
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 805              		.loc 1 159 1 is_stmt 0 view .LVU241
 806 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 807              	.LCFI15:
 808              		.cfi_def_cfa_offset 24
 809              		.cfi_offset 4, -24
 810              		.cfi_offset 5, -20
 811              		.cfi_offset 6, -16
 812              		.cfi_offset 7, -12
 813              		.cfi_offset 8, -8
 814              		.cfi_offset 14, -4
 815 0004 88B0     		sub	sp, sp, #32
 816              	.LCFI16:
 817              		.cfi_def_cfa_offset 56
 818 0006 9046     		mov	r8, r2
 819 0008 0F9A     		ldr	r2, [sp, #60]
 820              	.LVL64:
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 821              		.loc 1 160 5 is_stmt 1 view .LVU242
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 822              		.loc 1 160 7 is_stmt 0 view .LVU243
 823 000a 0028     		cmp	r0, #0
 824 000c 52D0     		beq	.L68
 825 000e 0D46     		mov	r5, r1
 826 0010 0446     		mov	r4, r0
 165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t ctr = 1;
 827              		.loc 1 165 5 is_stmt 1 view .LVU244
 828              	.LVL65:
 166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t sBlock[16] = { 0 };
 829              		.loc 1 166 5 view .LVU245
 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 830              		.loc 1 167 5 view .LVU246
ARM GAS  /tmp/ccgjJaEg.s 			page 32


 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 831              		.loc 1 167 13 is_stmt 0 view .LVU247
 832 0012 0026     		movs	r6, #0
 833 0014 0496     		str	r6, [sp, #16]
 834 0016 0596     		str	r6, [sp, #20]
 835 0018 0696     		str	r6, [sp, #24]
 836 001a 0796     		str	r6, [sp, #28]
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 837              		.loc 1 168 5 is_stmt 1 view .LVU248
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 838              		.loc 1 168 13 is_stmt 0 view .LVU249
 839 001c 0096     		str	r6, [sp]
 840 001e 0196     		str	r6, [sp, #4]
 841 0020 0296     		str	r6, [sp, #8]
 842 0022 0396     		str	r6, [sp, #12]
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 843              		.loc 1 170 5 is_stmt 1 view .LVU250
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 844              		.loc 1 170 15 is_stmt 0 view .LVU251
 845 0024 0127     		movs	r7, #1
 846 0026 8DF80070 		strb	r7, [sp]
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 847              		.loc 1 172 5 is_stmt 1 view .LVU252
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 848              		.loc 1 172 15 is_stmt 0 view .LVU253
 849 002a 9DF83810 		ldrb	r1, [sp, #56]	@ zero_extendqisi2
 850              	.LVL66:
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 851              		.loc 1 172 15 view .LVU254
 852 002e 8DF80510 		strb	r1, [sp, #5]
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 853              		.loc 1 174 5 is_stmt 1 view .LVU255
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 854              		.loc 1 174 15 is_stmt 0 view .LVU256
 855 0032 8DF80630 		strb	r3, [sp, #6]
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 856              		.loc 1 175 5 is_stmt 1 view .LVU257
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 857              		.loc 1 175 27 is_stmt 0 view .LVU258
 858 0036 190A     		lsrs	r1, r3, #8
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 859              		.loc 1 175 15 view .LVU259
 860 0038 8DF80710 		strb	r1, [sp, #7]
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 861              		.loc 1 176 5 is_stmt 1 view .LVU260
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 862              		.loc 1 176 27 is_stmt 0 view .LVU261
 863 003c 190C     		lsrs	r1, r3, #16
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 864              		.loc 1 176 15 view .LVU262
 865 003e 8DF80810 		strb	r1, [sp, #8]
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 866              		.loc 1 177 5 is_stmt 1 view .LVU263
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 867              		.loc 1 177 27 is_stmt 0 view .LVU264
 868 0042 1B0E     		lsrs	r3, r3, #24
 869              	.LVL67:
ARM GAS  /tmp/ccgjJaEg.s 			page 33


 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 870              		.loc 1 177 15 view .LVU265
 871 0044 8DF80930 		strb	r3, [sp, #9]
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 872              		.loc 1 179 5 is_stmt 1 view .LVU266
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 873              		.loc 1 179 16 is_stmt 0 view .LVU267
 874 0048 8DF80A20 		strb	r2, [sp, #10]
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 875              		.loc 1 180 5 is_stmt 1 view .LVU268
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 876              		.loc 1 180 33 is_stmt 0 view .LVU269
 877 004c 130A     		lsrs	r3, r2, #8
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 878              		.loc 1 180 16 view .LVU270
 879 004e 8DF80B30 		strb	r3, [sp, #11]
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 880              		.loc 1 181 5 is_stmt 1 view .LVU271
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 881              		.loc 1 181 33 is_stmt 0 view .LVU272
 882 0052 130C     		lsrs	r3, r2, #16
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 883              		.loc 1 181 16 view .LVU273
 884 0054 8DF80C30 		strb	r3, [sp, #12]
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 885              		.loc 1 182 5 is_stmt 1 view .LVU274
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 886              		.loc 1 182 33 is_stmt 0 view .LVU275
 887 0058 120E     		lsrs	r2, r2, #24
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 888              		.loc 1 182 16 view .LVU276
 889 005a 8DF80D20 		strb	r2, [sp, #13]
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 890              		.loc 1 184 5 is_stmt 1 view .LVU277
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 891              		.loc 1 184 10 is_stmt 0 view .LVU278
 892 005e 14E0     		b	.L64
 893              	.LVL68:
 894              	.L66:
 895              	.LBB5:
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 896              		.loc 1 195 13 is_stmt 1 discriminator 3 view .LVU279
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 897              		.loc 1 195 58 is_stmt 0 discriminator 3 view .LVU280
 898 0060 F218     		adds	r2, r6, r3
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 899              		.loc 1 195 45 discriminator 3 view .LVU281
 900 0062 A05C     		ldrb	r0, [r4, r2]	@ zero_extendqisi2
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 901              		.loc 1 195 71 discriminator 3 view .LVU282
 902 0064 03F12001 		add	r1, r3, #32
 903 0068 6944     		add	r1, sp, r1
 904 006a 11F8101C 		ldrb	r1, [r1, #-16]	@ zero_extendqisi2
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 905              		.loc 1 195 37 discriminator 3 view .LVU283
 906 006e 4840     		eors	r0, r0, r1
 907 0070 A054     		strb	r0, [r4, r2]
ARM GAS  /tmp/ccgjJaEg.s 			page 34


 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 908              		.loc 1 193 64 is_stmt 1 discriminator 3 view .LVU284
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 909              		.loc 1 193 65 is_stmt 0 discriminator 3 view .LVU285
 910 0072 0133     		adds	r3, r3, #1
 911              	.LVL69:
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 912              		.loc 1 193 65 discriminator 3 view .LVU286
 913 0074 DBB2     		uxtb	r3, r3
 914              	.LVL70:
 915              	.L65:
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 916              		.loc 1 193 29 is_stmt 1 discriminator 1 view .LVU287
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 917              		.loc 1 193 54 is_stmt 0 discriminator 1 view .LVU288
 918 0076 2A46     		mov	r2, r5
 919 0078 102D     		cmp	r5, #16
 920 007a A8BF     		it	ge
 921 007c 1022     		movge	r2, #16
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 922              		.loc 1 193 9 discriminator 1 view .LVU289
 923 007e 9342     		cmp	r3, r2
 924 0080 EEDB     		blt	.L66
 925              	.LBE5:
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 926              		.loc 1 197 9 is_stmt 1 view .LVU290
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 927              		.loc 1 197 14 is_stmt 0 view .LVU291
 928 0082 103D     		subs	r5, r5, #16
 929              	.LVL71:
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 930              		.loc 1 197 14 view .LVU292
 931 0084 2DB2     		sxth	r5, r5
 932              	.LVL72:
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 933              		.loc 1 198 9 is_stmt 1 view .LVU293
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 934              		.loc 1 198 21 is_stmt 0 view .LVU294
 935 0086 1036     		adds	r6, r6, #16
 936              	.LVL73:
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 937              		.loc 1 198 21 view .LVU295
 938 0088 F6B2     		uxtb	r6, r6
 939              	.LVL74:
 940              	.L64:
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 941              		.loc 1 184 10 is_stmt 1 view .LVU296
 942 008a 002D     		cmp	r5, #0
 943 008c 0EDD     		ble	.L71
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ctr++;
 944              		.loc 1 186 9 view .LVU297
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ctr++;
 945              		.loc 1 186 20 is_stmt 0 view .LVU298
 946 008e 8DF80F70 		strb	r7, [sp, #15]
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 947              		.loc 1 187 9 is_stmt 1 view .LVU299
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
ARM GAS  /tmp/ccgjJaEg.s 			page 35


 948              		.loc 1 187 12 is_stmt 0 view .LVU300
 949 0092 0137     		adds	r7, r7, #1
 950              	.LVL75:
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 951              		.loc 1 187 12 view .LVU301
 952 0094 BFB2     		uxth	r7, r7
 953              	.LVL76:
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 954              		.loc 1 188 9 is_stmt 1 view .LVU302
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 955              		.loc 1 188 13 is_stmt 0 view .LVU303
 956 0096 04AB     		add	r3, sp, #16
 957 0098 4246     		mov	r2, r8
 958 009a 1021     		movs	r1, #16
 959 009c 6846     		mov	r0, sp
 960 009e FFF7FEFF 		bl	SecureElementAesEncrypt
 961              	.LVL77:
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 962              		.loc 1 188 11 view .LVU304
 963 00a2 0346     		mov	r3, r0
 964 00a4 0028     		cmp	r0, #0
 965 00a6 E6D0     		beq	.L65
 190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 966              		.loc 1 190 20 view .LVU305
 967 00a8 0F20     		movs	r0, #15
 968 00aa 00E0     		b	.L63
 969              	.L71:
 201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 970              		.loc 1 201 12 view .LVU306
 971 00ac 0020     		movs	r0, #0
 972              	.LVL78:
 973              	.L63:
 202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 974              		.loc 1 202 1 view .LVU307
 975 00ae 08B0     		add	sp, sp, #32
 976              	.LCFI17:
 977              		.cfi_remember_state
 978              		.cfi_def_cfa_offset 24
 979              		@ sp needed
 980 00b0 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 981              	.LVL79:
 982              	.L68:
 983              	.LCFI18:
 984              		.cfi_restore_state
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 985              		.loc 1 162 16 view .LVU308
 986 00b4 0A20     		movs	r0, #10
 987              	.LVL80:
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 988              		.loc 1 162 16 view .LVU309
 989 00b6 FAE7     		b	.L63
 990              		.cfi_endproc
 991              	.LFE104:
 993              		.section	.text.VerifyCmacB0,"ax",%progbits
 994              		.align	1
 995              		.syntax unified
 996              		.thumb
ARM GAS  /tmp/ccgjJaEg.s 			page 36


 997              		.thumb_func
 998              		.fpu softvfp
 1000              	VerifyCmacB0:
 1001              	.LVL81:
 1002              	.LFB107:
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( msg == 0 )
 1003              		.loc 1 402 1 is_stmt 1 view -0
 1004              		.cfi_startproc
 1005              		@ args = 16, pretend = 0, frame = 272
 1006              		@ frame_needed = 0, uses_anonymous_args = 0
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1007              		.loc 1 403 5 view .LVU311
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1008              		.loc 1 403 7 is_stmt 0 view .LVU312
 1009 0000 70B3     		cbz	r0, .L74
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( msg == 0 )
 1010              		.loc 1 402 1 view .LVU313
 1011 0002 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1012              	.LCFI19:
 1013              		.cfi_def_cfa_offset 24
 1014              		.cfi_offset 4, -24
 1015              		.cfi_offset 5, -20
 1016              		.cfi_offset 6, -16
 1017              		.cfi_offset 7, -12
 1018              		.cfi_offset 8, -8
 1019              		.cfi_offset 14, -4
 1020 0006 C8B0     		sub	sp, sp, #288
 1021              	.LCFI20:
 1022              		.cfi_def_cfa_offset 312
 1023 0008 0C46     		mov	r4, r1
 1024 000a 1546     		mov	r5, r2
 1025 000c 1E46     		mov	r6, r3
 1026 000e 8046     		mov	r8, r0
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1027              		.loc 1 407 5 is_stmt 1 view .LVU314
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1028              		.loc 1 407 7 is_stmt 0 view .LVU315
 1029 0010 B1F5807F 		cmp	r1, #256
 1030 0014 26D8     		bhi	.L75
 412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memset1( micBuff, 0, CRYPTO_BUFFER_SIZE );
 1031              		.loc 1 412 5 is_stmt 1 view .LVU316
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1032              		.loc 1 413 5 view .LVU317
 1033 0016 04AF     		add	r7, sp, #16
 1034 0018 4FF48872 		mov	r2, #272
 1035              	.LVL82:
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1036              		.loc 1 413 5 is_stmt 0 view .LVU318
 1037 001c 0021     		movs	r1, #0
 1038              	.LVL83:
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1039              		.loc 1 413 5 view .LVU319
 1040 001e 3846     		mov	r0, r7
 1041              	.LVL84:
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1042              		.loc 1 413 5 view .LVU320
 1043 0020 FFF7FEFF 		bl	memset1
ARM GAS  /tmp/ccgjJaEg.s 			page 37


 1044              	.LVL85:
 416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1045              		.loc 1 416 5 is_stmt 1 view .LVU321
 1046 0024 0297     		str	r7, [sp, #8]
 1047 0026 509B     		ldr	r3, [sp, #320]
 1048 0028 0193     		str	r3, [sp, #4]
 1049 002a 4F9B     		ldr	r3, [sp, #316]
 1050 002c 0093     		str	r3, [sp]
 1051 002e 9DF83831 		ldrb	r3, [sp, #312]	@ zero_extendqisi2
 1052 0032 3246     		mov	r2, r6
 1053 0034 2946     		mov	r1, r5
 1054 0036 2046     		mov	r0, r4
 1055 0038 FFF7FEFF 		bl	PrepareB0
 1056              	.LVL86:
 419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1057              		.loc 1 419 5 view .LVU322
 1058 003c 2246     		mov	r2, r4
 1059 003e 4146     		mov	r1, r8
 1060 0040 08A8     		add	r0, sp, #32
 1061 0042 FFF7FEFF 		bl	memcpy1
 1062              	.LVL87:
 421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = SecureElementVerifyAesCmac( micBuff, ( len + MIC_BLOCK_BX_SIZE ), expectedCmac, keyID 
 1063              		.loc 1 421 5 view .LVU323
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1064              		.loc 1 422 5 view .LVU324
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1065              		.loc 1 422 14 is_stmt 0 view .LVU325
 1066 0046 04F11001 		add	r1, r4, #16
 1067 004a 2B46     		mov	r3, r5
 1068 004c 519A     		ldr	r2, [sp, #324]
 1069 004e 89B2     		uxth	r1, r1
 1070 0050 3846     		mov	r0, r7
 1071 0052 FFF7FEFF 		bl	SecureElementVerifyAesCmac
 1072              	.LVL88:
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1073              		.loc 1 424 5 is_stmt 1 view .LVU326
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1074              		.loc 1 424 7 is_stmt 0 view .LVU327
 1075 0056 30B1     		cbz	r0, .L73
 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1076              		.loc 1 428 10 is_stmt 1 view .LVU328
 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1077              		.loc 1 428 12 is_stmt 0 view .LVU329
 1078 0058 0128     		cmp	r0, #1
 1079 005a 04D0     		beq	.L73
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1080              		.loc 1 433 12 view .LVU330
 1081 005c 0F20     		movs	r0, #15
 1082              	.LVL89:
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1083              		.loc 1 433 12 view .LVU331
 1084 005e 02E0     		b	.L73
 1085              	.LVL90:
 1086              	.L74:
 1087              	.LCFI21:
 1088              		.cfi_def_cfa_offset 0
 1089              		.cfi_restore 4
ARM GAS  /tmp/ccgjJaEg.s 			page 38


 1090              		.cfi_restore 5
 1091              		.cfi_restore 6
 1092              		.cfi_restore 7
 1093              		.cfi_restore 8
 1094              		.cfi_restore 14
 405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1095              		.loc 1 405 16 view .LVU332
 1096 0060 0A20     		movs	r0, #10
 1097              	.LVL91:
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1098              		.loc 1 434 1 view .LVU333
 1099 0062 7047     		bx	lr
 1100              	.LVL92:
 1101              	.L75:
 1102              	.LCFI22:
 1103              		.cfi_def_cfa_offset 312
 1104              		.cfi_offset 4, -24
 1105              		.cfi_offset 5, -20
 1106              		.cfi_offset 6, -16
 1107              		.cfi_offset 7, -12
 1108              		.cfi_offset 8, -8
 1109              		.cfi_offset 14, -4
 409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1110              		.loc 1 409 16 view .LVU334
 1111 0064 0E20     		movs	r0, #14
 1112              	.LVL93:
 1113              	.L73:
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1114              		.loc 1 434 1 view .LVU335
 1115 0066 48B0     		add	sp, sp, #288
 1116              	.LCFI23:
 1117              		.cfi_def_cfa_offset 24
 1118              		@ sp needed
 1119 0068 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1120              		.loc 1 434 1 view .LVU336
 1121              		.cfi_endproc
 1122              	.LFE107:
 1124              		.section	.text.LoRaMacCryptoInit,"ax",%progbits
 1125              		.align	1
 1126              		.global	LoRaMacCryptoInit
 1127              		.syntax unified
 1128              		.thumb
 1129              		.thumb_func
 1130              		.fpu softvfp
 1132              	LoRaMacCryptoInit:
 1133              	.LVL94:
 1134              	.LFB114:
 843:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 844:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 845:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *  API functions
 846:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 847:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoInit( LoRaMacCryptoNvmData_t* nvm )
 848:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1135              		.loc 1 848 1 is_stmt 1 view -0
 1136              		.cfi_startproc
 1137              		@ args = 0, pretend = 0, frame = 0
ARM GAS  /tmp/ccgjJaEg.s 			page 39


 1138              		@ frame_needed = 0, uses_anonymous_args = 0
 849:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( nvm == NULL )
 1139              		.loc 1 849 5 view .LVU338
 1140              		.loc 1 849 7 is_stmt 0 view .LVU339
 1141 0000 88B1     		cbz	r0, .L82
 848:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( nvm == NULL )
 1142              		.loc 1 848 1 view .LVU340
 1143 0002 10B5     		push	{r4, lr}
 1144              	.LCFI24:
 1145              		.cfi_def_cfa_offset 8
 1146              		.cfi_offset 4, -8
 1147              		.cfi_offset 14, -4
 850:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 851:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_PARAM;
 852:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 853:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 854:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Assign non volatile context
 855:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm = nvm;
 1148              		.loc 1 855 5 is_stmt 1 view .LVU341
 1149              		.loc 1 855 15 is_stmt 0 view .LVU342
 1150 0004 094C     		ldr	r4, .L87
 1151 0006 2060     		str	r0, [r4]
 856:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 857:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize with default
 858:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memset1( ( uint8_t* )CryptoNvm, 0, sizeof( LoRaMacCryptoNvmData_t ) );
 1152              		.loc 1 858 5 is_stmt 1 view .LVU343
 1153 0008 2822     		movs	r2, #40
 1154 000a 0021     		movs	r1, #0
 1155 000c FFF7FEFF 		bl	memset1
 1156              	.LVL95:
 859:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 860:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Set default LoRaWAN version
 861:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Major = 1;
 1157              		.loc 1 861 5 view .LVU344
 1158              		.loc 1 861 14 is_stmt 0 view .LVU345
 1159 0010 2368     		ldr	r3, [r4]
 1160              		.loc 1 861 42 view .LVU346
 1161 0012 0122     		movs	r2, #1
 1162 0014 DA70     		strb	r2, [r3, #3]
 862:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Minor = 1;
 1163              		.loc 1 862 5 is_stmt 1 view .LVU347
 1164              		.loc 1 862 42 is_stmt 0 view .LVU348
 1165 0016 9A70     		strb	r2, [r3, #2]
 863:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Patch = 1;
 1166              		.loc 1 863 5 is_stmt 1 view .LVU349
 1167              		.loc 1 863 42 is_stmt 0 view .LVU350
 1168 0018 5A70     		strb	r2, [r3, #1]
 864:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Revision = 0;
 1169              		.loc 1 864 5 is_stmt 1 view .LVU351
 1170              		.loc 1 864 45 is_stmt 0 view .LVU352
 1171 001a 0024     		movs	r4, #0
 1172 001c 1C70     		strb	r4, [r3]
 865:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 866:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reset frame counters
 867:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     ResetFCnts( );
 1173              		.loc 1 867 5 is_stmt 1 view .LVU353
 1174 001e FFF7FEFF 		bl	ResetFCnts
ARM GAS  /tmp/ccgjJaEg.s 			page 40


 1175              	.LVL96:
 868:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 869:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1176              		.loc 1 869 5 view .LVU354
 1177              		.loc 1 869 12 is_stmt 0 view .LVU355
 1178 0022 2046     		mov	r0, r4
 870:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1179              		.loc 1 870 1 view .LVU356
 1180 0024 10BD     		pop	{r4, pc}
 1181              	.LVL97:
 1182              	.L82:
 1183              	.LCFI25:
 1184              		.cfi_def_cfa_offset 0
 1185              		.cfi_restore 4
 1186              		.cfi_restore 14
 851:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1187              		.loc 1 851 16 view .LVU357
 1188 0026 0920     		movs	r0, #9
 1189              	.LVL98:
 1190              		.loc 1 870 1 view .LVU358
 1191 0028 7047     		bx	lr
 1192              	.L88:
 1193 002a 00BF     		.align	2
 1194              	.L87:
 1195 002c 00000000 		.word	.LANCHOR1
 1196              		.cfi_endproc
 1197              	.LFE114:
 1199              		.section	.text.LoRaMacCryptoSetLrWanVersion,"ax",%progbits
 1200              		.align	1
 1201              		.global	LoRaMacCryptoSetLrWanVersion
 1202              		.syntax unified
 1203              		.thumb
 1204              		.thumb_func
 1205              		.fpu softvfp
 1207              	LoRaMacCryptoSetLrWanVersion:
 1208              	.LVL99:
 1209              	.LFB115:
 871:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 872:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSetLrWanVersion( Version_t version )
 873:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1210              		.loc 1 873 1 is_stmt 1 view -0
 1211              		.cfi_startproc
 1212              		@ args = 0, pretend = 0, frame = 0
 1213              		@ frame_needed = 0, uses_anonymous_args = 0
 1214              		@ link register save eliminated.
 874:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion = version;
 1215              		.loc 1 874 5 view .LVU360
 1216              		.loc 1 874 14 is_stmt 0 view .LVU361
 1217 0000 024B     		ldr	r3, .L90
 1218 0002 1B68     		ldr	r3, [r3]
 1219              		.loc 1 874 29 view .LVU362
 1220 0004 1860     		str	r0, [r3]
 875:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1221              		.loc 1 875 5 is_stmt 1 view .LVU363
 876:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1222              		.loc 1 876 1 is_stmt 0 view .LVU364
 1223 0006 0020     		movs	r0, #0
ARM GAS  /tmp/ccgjJaEg.s 			page 41


 1224              	.LVL100:
 1225              		.loc 1 876 1 view .LVU365
 1226 0008 7047     		bx	lr
 1227              	.L91:
 1228 000a 00BF     		.align	2
 1229              	.L90:
 1230 000c 00000000 		.word	.LANCHOR1
 1231              		.cfi_endproc
 1232              	.LFE115:
 1234              		.section	.text.LoRaMacCryptoGetFCntUp,"ax",%progbits
 1235              		.align	1
 1236              		.global	LoRaMacCryptoGetFCntUp
 1237              		.syntax unified
 1238              		.thumb
 1239              		.thumb_func
 1240              		.fpu softvfp
 1242              	LoRaMacCryptoGetFCntUp:
 1243              	.LVL101:
 1244              	.LFB116:
 877:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 878:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoGetFCntUp( uint32_t* currentUp )
 879:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1245              		.loc 1 879 1 is_stmt 1 view -0
 1246              		.cfi_startproc
 1247              		@ args = 0, pretend = 0, frame = 0
 1248              		@ frame_needed = 0, uses_anonymous_args = 0
 1249              		@ link register save eliminated.
 880:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentUp == NULL )
 1250              		.loc 1 880 5 view .LVU367
 1251              		.loc 1 880 7 is_stmt 0 view .LVU368
 1252 0000 30B1     		cbz	r0, .L94
 881:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 882:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 883:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 884:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 885:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     *currentUp = CryptoNvm->FCntList.FCntUp + 1;
 1253              		.loc 1 885 5 is_stmt 1 view .LVU369
 1254              		.loc 1 885 27 is_stmt 0 view .LVU370
 1255 0002 044B     		ldr	r3, .L95
 1256 0004 1B68     		ldr	r3, [r3]
 1257              		.loc 1 885 37 view .LVU371
 1258 0006 DB68     		ldr	r3, [r3, #12]
 1259              		.loc 1 885 45 view .LVU372
 1260 0008 0133     		adds	r3, r3, #1
 1261              		.loc 1 885 16 view .LVU373
 1262 000a 0360     		str	r3, [r0]
 886:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 887:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1263              		.loc 1 887 5 is_stmt 1 view .LVU374
 1264              		.loc 1 887 12 is_stmt 0 view .LVU375
 1265 000c 0020     		movs	r0, #0
 1266              	.LVL102:
 1267              		.loc 1 887 12 view .LVU376
 1268 000e 7047     		bx	lr
 1269              	.LVL103:
 1270              	.L94:
 882:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  /tmp/ccgjJaEg.s 			page 42


 1271              		.loc 1 882 16 view .LVU377
 1272 0010 0A20     		movs	r0, #10
 1273              	.LVL104:
 888:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1274              		.loc 1 888 1 view .LVU378
 1275 0012 7047     		bx	lr
 1276              	.L96:
 1277              		.align	2
 1278              	.L95:
 1279 0014 00000000 		.word	.LANCHOR1
 1280              		.cfi_endproc
 1281              	.LFE116:
 1283              		.section	.text.LoRaMacCryptoGetFCntDown,"ax",%progbits
 1284              		.align	1
 1285              		.global	LoRaMacCryptoGetFCntDown
 1286              		.syntax unified
 1287              		.thumb
 1288              		.thumb_func
 1289              		.fpu softvfp
 1291              	LoRaMacCryptoGetFCntDown:
 1292              	.LVL105:
 1293              	.LFB117:
 889:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 890:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoGetFCntDown( FCntIdentifier_t fCntID, uint16_t maxFCntGap, uint3
 891:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1294              		.loc 1 891 1 is_stmt 1 view -0
 1295              		.cfi_startproc
 1296              		@ args = 0, pretend = 0, frame = 8
 1297              		@ frame_needed = 0, uses_anonymous_args = 0
 1298              		.loc 1 891 1 is_stmt 0 view .LVU380
 1299 0000 70B5     		push	{r4, r5, r6, lr}
 1300              	.LCFI26:
 1301              		.cfi_def_cfa_offset 16
 1302              		.cfi_offset 4, -16
 1303              		.cfi_offset 5, -12
 1304              		.cfi_offset 6, -8
 1305              		.cfi_offset 14, -4
 1306 0002 82B0     		sub	sp, sp, #8
 1307              	.LCFI27:
 1308              		.cfi_def_cfa_offset 24
 1309 0004 1446     		mov	r4, r2
 892:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t lastDown = 0;
 1310              		.loc 1 892 5 is_stmt 1 view .LVU381
 1311              		.loc 1 892 14 is_stmt 0 view .LVU382
 1312 0006 0022     		movs	r2, #0
 1313              	.LVL106:
 1314              		.loc 1 892 14 view .LVU383
 1315 0008 0192     		str	r2, [sp, #4]
 893:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     int32_t fCntDiff = 0;
 1316              		.loc 1 893 5 is_stmt 1 view .LVU384
 1317              	.LVL107:
 894:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t cryptoStatus = LORAMAC_CRYPTO_ERROR;
 1318              		.loc 1 894 5 view .LVU385
 895:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 896:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentDown == NULL )
 1319              		.loc 1 896 5 view .LVU386
 1320              		.loc 1 896 7 is_stmt 0 view .LVU387
ARM GAS  /tmp/ccgjJaEg.s 			page 43


 1321 000a 63B3     		cbz	r3, .L103
 1322 000c 0D46     		mov	r5, r1
 1323 000e 1E46     		mov	r6, r3
 897:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 899:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 900:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 901:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     cryptoStatus = GetLastFcntDown( fCntID, &lastDown );
 1324              		.loc 1 901 5 is_stmt 1 view .LVU388
 1325              		.loc 1 901 20 is_stmt 0 view .LVU389
 1326 0010 01A9     		add	r1, sp, #4
 1327              	.LVL108:
 1328              		.loc 1 901 20 view .LVU390
 1329 0012 FFF7FEFF 		bl	GetLastFcntDown
 1330              	.LVL109:
 902:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( cryptoStatus != LORAMAC_CRYPTO_SUCCESS )
 1331              		.loc 1 902 5 is_stmt 1 view .LVU391
 1332              		.loc 1 902 7 is_stmt 0 view .LVU392
 1333 0016 B8B9     		cbnz	r0, .L98
 903:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 904:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return cryptoStatus;
 905:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 906:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 907:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // For LoRaWAN 1.0.X only, allow downlink frames of 0
 908:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( lastDown == FCNT_DOWN_INITAL_VALUE )
 1334              		.loc 1 908 5 is_stmt 1 view .LVU393
 1335              		.loc 1 908 18 is_stmt 0 view .LVU394
 1336 0018 019B     		ldr	r3, [sp, #4]
 1337              		.loc 1 908 7 view .LVU395
 1338 001a B3F1FF3F 		cmp	r3, #-1
 1339 001e 15D0     		beq	.L106
 909:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         *currentDown = frameFcnt;
 911:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 912:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 913:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 914:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Add difference, consider roll-over
 915:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         fCntDiff = ( int32_t )( ( int64_t )frameFcnt - ( int64_t )( lastDown & 0x0000FFFF ) );
 1340              		.loc 1 915 9 is_stmt 1 view .LVU396
 1341              		.loc 1 915 56 is_stmt 0 view .LVU397
 1342 0020 9AB2     		uxth	r2, r3
 1343              		.loc 1 915 54 view .LVU398
 1344 0022 A21A     		subs	r2, r4, r2
 1345              	.LVL110:
 916:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 917:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( fCntDiff > 0 )
 1346              		.loc 1 917 9 is_stmt 1 view .LVU399
 1347              		.loc 1 917 11 is_stmt 0 view .LVU400
 1348 0024 002A     		cmp	r2, #0
 1349 0026 13DD     		ble	.L101
 918:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Positive difference
 919:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *currentDown = lastDown + fCntDiff;
 1350              		.loc 1 919 13 is_stmt 1 view .LVU401
 1351              		.loc 1 919 37 is_stmt 0 view .LVU402
 1352 0028 1344     		add	r3, r3, r2
 1353              		.loc 1 919 26 view .LVU403
 1354 002a 3360     		str	r3, [r6]
ARM GAS  /tmp/ccgjJaEg.s 			page 44


 1355              	.LVL111:
 1356              	.L100:
 920:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         else if( fCntDiff == 0 )
 922:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Duplicate FCnt value, keep the current value.
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *currentDown = lastDown;
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_DUPLICATED;
 925:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 926:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         else
 927:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Negative difference, assume a roll-over of one uint16_t
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *currentDown = ( lastDown & 0xFFFF0000 ) + 0x10000 + frameFcnt;
 929:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 930:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 931:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 932:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // For LoRaWAN 1.0.X only, check maxFCntGap
 933:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 0 )
 1357              		.loc 1 933 5 is_stmt 1 view .LVU404
 1358              		.loc 1 933 18 is_stmt 0 view .LVU405
 1359 002c 104B     		ldr	r3, .L108
 1360 002e 1B68     		ldr	r3, [r3]
 1361              		.loc 1 933 39 view .LVU406
 1362 0030 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1363              		.loc 1 933 7 view .LVU407
 1364 0032 4AB9     		cbnz	r2, .L98
 934:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 935:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( ( ( int64_t )*currentDown - ( int64_t )lastDown ) >= maxFCntGap )
 1365              		.loc 1 935 9 is_stmt 1 view .LVU408
 1366              		.loc 1 935 26 is_stmt 0 view .LVU409
 1367 0034 3368     		ldr	r3, [r6]
 1368              		.loc 1 935 41 view .LVU410
 1369 0036 0199     		ldr	r1, [sp, #4]
 1370              		.loc 1 935 39 view .LVU411
 1371 0038 5B1A     		subs	r3, r3, r1
 1372 003a 61EB0101 		sbc	r1, r1, r1
 1373              		.loc 1 935 11 view .LVU412
 1374 003e AB42     		cmp	r3, r5
 1375 0040 71F10003 		sbcs	r3, r1, #0
 1376 0044 11DA     		bge	.L104
 936:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_MAX_GAP_FCNT;
 938:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 939:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 940:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 941:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1377              		.loc 1 941 12 view .LVU413
 1378 0046 1046     		mov	r0, r2
 1379              	.LVL112:
 1380              	.L98:
 942:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1381              		.loc 1 942 1 view .LVU414
 1382 0048 02B0     		add	sp, sp, #8
 1383              	.LCFI28:
 1384              		.cfi_remember_state
 1385              		.cfi_def_cfa_offset 16
 1386              		@ sp needed
 1387 004a 70BD     		pop	{r4, r5, r6, pc}
 1388              	.LVL113:
ARM GAS  /tmp/ccgjJaEg.s 			page 45


 1389              	.L106:
 1390              	.LCFI29:
 1391              		.cfi_restore_state
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1392              		.loc 1 910 9 is_stmt 1 view .LVU415
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1393              		.loc 1 910 22 is_stmt 0 view .LVU416
 1394 004c 3460     		str	r4, [r6]
 1395 004e EDE7     		b	.L100
 1396              	.LVL114:
 1397              	.L101:
 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Duplicate FCnt value, keep the current value.
 1398              		.loc 1 921 14 is_stmt 1 view .LVU417
 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Duplicate FCnt value, keep the current value.
 1399              		.loc 1 921 16 is_stmt 0 view .LVU418
 1400 0050 32B1     		cbz	r2, .L107
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1401              		.loc 1 928 13 is_stmt 1 view .LVU419
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1402              		.loc 1 928 39 is_stmt 0 view .LVU420
 1403 0052 1B0C     		lsrs	r3, r3, #16
 1404 0054 1B04     		lsls	r3, r3, #16
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1405              		.loc 1 928 64 view .LVU421
 1406 0056 2344     		add	r3, r3, r4
 1407 0058 03F58033 		add	r3, r3, #65536
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1408              		.loc 1 928 26 view .LVU422
 1409 005c 3360     		str	r3, [r6]
 1410 005e E5E7     		b	.L100
 1411              	.L107:
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_DUPLICATED;
 1412              		.loc 1 923 13 is_stmt 1 view .LVU423
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_DUPLICATED;
 1413              		.loc 1 923 26 is_stmt 0 view .LVU424
 1414 0060 3360     		str	r3, [r6]
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1415              		.loc 1 924 13 is_stmt 1 view .LVU425
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1416              		.loc 1 924 20 is_stmt 0 view .LVU426
 1417 0062 0720     		movs	r0, #7
 1418              	.LVL115:
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1419              		.loc 1 924 20 view .LVU427
 1420 0064 F0E7     		b	.L98
 1421              	.LVL116:
 1422              	.L103:
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1423              		.loc 1 898 16 view .LVU428
 1424 0066 0A20     		movs	r0, #10
 1425              	.LVL117:
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1426              		.loc 1 898 16 view .LVU429
 1427 0068 EEE7     		b	.L98
 1428              	.LVL118:
 1429              	.L104:
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
ARM GAS  /tmp/ccgjJaEg.s 			page 46


 1430              		.loc 1 937 20 view .LVU430
 1431 006a 0820     		movs	r0, #8
 1432              	.LVL119:
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1433              		.loc 1 937 20 view .LVU431
 1434 006c ECE7     		b	.L98
 1435              	.L109:
 1436 006e 00BF     		.align	2
 1437              	.L108:
 1438 0070 00000000 		.word	.LANCHOR1
 1439              		.cfi_endproc
 1440              	.LFE117:
 1442              		.section	.text.LoRaMacCryptoSetMulticastReference,"ax",%progbits
 1443              		.align	1
 1444              		.global	LoRaMacCryptoSetMulticastReference
 1445              		.syntax unified
 1446              		.thumb
 1447              		.thumb_func
 1448              		.fpu softvfp
 1450              	LoRaMacCryptoSetMulticastReference:
 1451              	.LVL120:
 1452              	.LFB118:
 943:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 944:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 945:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoGetRJcount( FCntIdentifier_t fCntID, uint16_t* rJcount )
 946:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 947:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( rJcount == 0 )
 948:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 949:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 950:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 951:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( fCntID )
 952:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 953:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case RJ_COUNT_0:
 954:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *rJcount = RJcount0 + 1;
 955:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 956:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case RJ_COUNT_1:
 957:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *rJcount = CryptoNvm->FCntList.RJcount1 + 1;
 958:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 959:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 960:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_ID;
 961:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 962:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 963:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 964:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 965:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 966:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSetMulticastReference( MulticastCtx_t* multicastList )
 967:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1453              		.loc 1 967 1 is_stmt 1 view -0
 1454              		.cfi_startproc
 1455              		@ args = 0, pretend = 0, frame = 0
 1456              		@ frame_needed = 0, uses_anonymous_args = 0
 1457              		@ link register save eliminated.
 968:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( multicastList == NULL )
 1458              		.loc 1 968 5 view .LVU433
 1459              		.loc 1 968 7 is_stmt 0 view .LVU434
 1460 0000 0146     		mov	r1, r0
 1461 0002 08B9     		cbnz	r0, .L115
ARM GAS  /tmp/ccgjJaEg.s 			page 47


 969:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 970:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 1462              		.loc 1 970 16 view .LVU435
 1463 0004 0A20     		movs	r0, #10
 1464              	.LVL121:
 971:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 972:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( int32_t i = 0; i < LORAMAC_MAX_MC_CTX; i++ )
 974:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         multicastList[i].DownLinkCounter = &CryptoNvm->FCntList.McFCntDown[i];
 976:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 977:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 978:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 979:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1465              		.loc 1 979 1 view .LVU436
 1466 0006 7047     		bx	lr
 1467              	.LVL122:
 1468              	.L115:
 1469              	.LBB6:
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1470              		.loc 1 973 18 view .LVU437
 1471 0008 0023     		movs	r3, #0
 1472              	.LVL123:
 1473              	.L112:
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1474              		.loc 1 973 25 is_stmt 1 discriminator 1 view .LVU438
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1475              		.loc 1 973 5 is_stmt 0 discriminator 1 view .LVU439
 1476 000a 002B     		cmp	r3, #0
 1477 000c 01DD     		ble	.L113
 1478              	.LBE6:
 978:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1479              		.loc 1 978 12 view .LVU440
 1480 000e 0020     		movs	r0, #0
 1481              	.LBB7:
 1482 0010 7047     		bx	lr
 1483              	.L113:
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1484              		.loc 1 975 9 is_stmt 1 discriminator 3 view .LVU441
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1485              		.loc 1 975 54 is_stmt 0 discriminator 3 view .LVU442
 1486 0012 064A     		ldr	r2, .L116
 1487 0014 1268     		ldr	r2, [r2]
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1488              		.loc 1 975 22 discriminator 3 view .LVU443
 1489 0016 2C20     		movs	r0, #44
 1490 0018 00FB0310 		mla	r0, r0, r3, r1
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1491              		.loc 1 975 44 discriminator 3 view .LVU444
 1492 001c 03F1060C 		add	ip, r3, #6
 1493 0020 02EB8C02 		add	r2, r2, ip, lsl #2
 1494 0024 0432     		adds	r2, r2, #4
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1495              		.loc 1 975 42 discriminator 3 view .LVU445
 1496 0026 0262     		str	r2, [r0, #32]
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1497              		.loc 1 973 49 is_stmt 1 discriminator 3 view .LVU446
ARM GAS  /tmp/ccgjJaEg.s 			page 48


 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1498              		.loc 1 973 50 is_stmt 0 discriminator 3 view .LVU447
 1499 0028 0133     		adds	r3, r3, #1
 1500              	.LVL124:
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1501              		.loc 1 973 50 discriminator 3 view .LVU448
 1502 002a EEE7     		b	.L112
 1503              	.L117:
 1504              		.align	2
 1505              	.L116:
 1506 002c 00000000 		.word	.LANCHOR1
 1507              	.LBE7:
 1508              		.cfi_endproc
 1509              	.LFE118:
 1511              		.section	.text.LoRaMacCryptoPrepareJoinRequest,"ax",%progbits
 1512              		.align	1
 1513              		.global	LoRaMacCryptoPrepareJoinRequest
 1514              		.syntax unified
 1515              		.thumb
 1516              		.thumb_func
 1517              		.fpu softvfp
 1519              	LoRaMacCryptoPrepareJoinRequest:
 1520              	.LVL125:
 1521              	.LFB120:
 980:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 981:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSetKey( KeyIdentifier_t keyID, uint8_t* key )
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementSetKey( keyID, key ) != SECURE_ELEMENT_SUCCESS )
 984:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 985:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 986:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( keyID == APP_KEY )
 988:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 989:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Derive lifetime keys
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( LoRaMacCryptoDeriveMcRootKey( CryptoNvm->LrWanVersion.Fields.Minor, keyID ) != LORAMAC_
 991:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 992:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 993:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( LoRaMacCryptoDeriveMcKEKey( MC_ROOT_KEY ) != LORAMAC_CRYPTO_SUCCESS )
 995:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 996:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 997:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 998:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 999:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1000:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1001:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1002:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoPrepareJoinRequest( LoRaMacMessageJoinRequest_t* macMsg )
1003:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1522              		.loc 1 1003 1 is_stmt 1 view -0
 1523              		.cfi_startproc
 1524              		@ args = 0, pretend = 0, frame = 8
 1525              		@ frame_needed = 0, uses_anonymous_args = 0
1004:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
 1526              		.loc 1 1004 5 view .LVU450
 1527              		.loc 1 1004 7 is_stmt 0 view .LVU451
 1528 0000 00B3     		cbz	r0, .L120
1003:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
ARM GAS  /tmp/ccgjJaEg.s 			page 49


 1529              		.loc 1 1003 1 view .LVU452
 1530 0002 10B5     		push	{r4, lr}
 1531              	.LCFI30:
 1532              		.cfi_def_cfa_offset 8
 1533              		.cfi_offset 4, -8
 1534              		.cfi_offset 14, -4
 1535 0004 84B0     		sub	sp, sp, #16
 1536              	.LCFI31:
 1537              		.cfi_def_cfa_offset 24
 1538 0006 0446     		mov	r4, r0
1005:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1006:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1007:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1008:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t micComputationKeyID = NWK_KEY;
 1539              		.loc 1 1008 5 is_stmt 1 view .LVU453
 1540              	.LVL126:
1009:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1010:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Add device nonce
1011:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_RANDOM_DEV_NONCE == 1 )
1012:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t devNonce = 0;
 1541              		.loc 1 1012 5 view .LVU454
 1542              		.loc 1 1012 14 is_stmt 0 view .LVU455
 1543 0008 0023     		movs	r3, #0
 1544 000a 0393     		str	r3, [sp, #12]
1013:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     SecureElementRandomNumber( &devNonce );
 1545              		.loc 1 1013 5 is_stmt 1 view .LVU456
 1546 000c 03A8     		add	r0, sp, #12
 1547              	.LVL127:
 1548              		.loc 1 1013 5 is_stmt 0 view .LVU457
 1549 000e FFF7FEFF 		bl	SecureElementRandomNumber
 1550              	.LVL128:
1014:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->DevNonce = devNonce;
 1551              		.loc 1 1014 5 is_stmt 1 view .LVU458
 1552              		.loc 1 1014 14 is_stmt 0 view .LVU459
 1553 0012 104B     		ldr	r3, .L128
 1554 0014 1A68     		ldr	r2, [r3]
 1555              		.loc 1 1014 25 view .LVU460
 1556 0016 BDF80C30 		ldrh	r3, [sp, #12]
 1557 001a 9380     		strh	r3, [r2, #4]	@ movhi
1015:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else
1016:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->DevNonce++;
1017:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_RANDOM_DEV_NONCE */
1018:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     macMsg->DevNonce = CryptoNvm->DevNonce;
 1558              		.loc 1 1018 5 is_stmt 1 view .LVU461
 1559              		.loc 1 1018 22 is_stmt 0 view .LVU462
 1560 001c E382     		strh	r3, [r4, #22]	@ movhi
1019:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1020:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1021:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Derive lifetime session keys
1022:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( DeriveLifeTimeSessionKey( J_S_INT_KEY, macMsg->DevEUI ) != LORAMAC_CRYPTO_SUCCESS )
1023:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1024:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR;
1025:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1026:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( DeriveLifeTimeSessionKey( J_S_ENC_KEY, macMsg->DevEUI ) != LORAMAC_CRYPTO_SUCCESS )
1027:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1028:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR;
1029:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  /tmp/ccgjJaEg.s 			page 50


1030:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1031:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1032:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1033:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerJoinRequest( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1561              		.loc 1 1033 5 is_stmt 1 view .LVU463
 1562              		.loc 1 1033 9 is_stmt 0 view .LVU464
 1563 001e 2046     		mov	r0, r4
 1564 0020 FFF7FEFF 		bl	LoRaMacSerializerJoinRequest
 1565              	.LVL129:
 1566              		.loc 1 1033 7 view .LVU465
 1567 0024 80B9     		cbnz	r0, .L121
1034:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1035:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1036:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1037:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1038:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1039:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( NULL, macMsg->Buffer, ( LORAMAC_JOIN_REQ_MSG_SIZE - LORAMAC_MI
 1568              		.loc 1 1039 5 is_stmt 1 view .LVU466
 1569              		.loc 1 1039 9 is_stmt 0 view .LVU467
 1570 0026 2346     		mov	r3, r4
 1571 0028 53F8181B 		ldr	r1, [r3], #24
 1572 002c 0093     		str	r3, [sp]
 1573 002e 0123     		movs	r3, #1
 1574 0030 1322     		movs	r2, #19
 1575 0032 FFF7FEFF 		bl	SecureElementComputeAesCmac
 1576              	.LVL130:
 1577              		.loc 1 1039 7 view .LVU468
 1578 0036 50B9     		cbnz	r0, .L122
1040:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1041:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1042:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1043:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1044:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reserialize message to add the MIC
1045:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerJoinRequest( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1579              		.loc 1 1045 5 is_stmt 1 view .LVU469
 1580              		.loc 1 1045 9 is_stmt 0 view .LVU470
 1581 0038 2046     		mov	r0, r4
 1582 003a FFF7FEFF 		bl	LoRaMacSerializerJoinRequest
 1583              	.LVL131:
 1584              		.loc 1 1045 7 view .LVU471
 1585 003e 20B1     		cbz	r0, .L119
1046:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1047:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
 1586              		.loc 1 1047 16 view .LVU472
 1587 0040 1120     		movs	r0, #17
 1588 0042 02E0     		b	.L119
 1589              	.LVL132:
 1590              	.L120:
 1591              	.LCFI32:
 1592              		.cfi_def_cfa_offset 0
 1593              		.cfi_restore 4
 1594              		.cfi_restore 14
1006:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1595              		.loc 1 1006 16 view .LVU473
 1596 0044 0A20     		movs	r0, #10
 1597              	.LVL133:
1048:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  /tmp/ccgjJaEg.s 			page 51


1049:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1050:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1051:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1598              		.loc 1 1051 1 view .LVU474
 1599 0046 7047     		bx	lr
 1600              	.LVL134:
 1601              	.L121:
 1602              	.LCFI33:
 1603              		.cfi_def_cfa_offset 24
 1604              		.cfi_offset 4, -8
 1605              		.cfi_offset 14, -4
1035:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1606              		.loc 1 1035 16 view .LVU475
 1607 0048 1120     		movs	r0, #17
 1608              	.L119:
 1609              		.loc 1 1051 1 view .LVU476
 1610 004a 04B0     		add	sp, sp, #16
 1611              	.LCFI34:
 1612              		.cfi_remember_state
 1613              		.cfi_def_cfa_offset 8
 1614              		@ sp needed
 1615 004c 10BD     		pop	{r4, pc}
 1616              	.LVL135:
 1617              	.L122:
 1618              	.LCFI35:
 1619              		.cfi_restore_state
1041:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1620              		.loc 1 1041 16 view .LVU477
 1621 004e 0F20     		movs	r0, #15
 1622 0050 FBE7     		b	.L119
 1623              	.L129:
 1624 0052 00BF     		.align	2
 1625              	.L128:
 1626 0054 00000000 		.word	.LANCHOR1
 1627              		.cfi_endproc
 1628              	.LFE120:
 1630              		.section	.text.LoRaMacCryptoSecureMessage,"ax",%progbits
 1631              		.align	1
 1632              		.global	LoRaMacCryptoSecureMessage
 1633              		.syntax unified
 1634              		.thumb
 1635              		.thumb_func
 1636              		.fpu softvfp
 1638              	LoRaMacCryptoSecureMessage:
 1639              	.LVL136:
 1640              	.LFB122:
1052:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1053:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1054:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoPrepareReJoinType1( LoRaMacMessageReJoinType1_t* macMsg )
1055:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
1056:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
1057:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1058:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1059:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1060:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1061:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check for RJcount1 overflow
1062:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->FCntList.RJcount1 == 65535 )
ARM GAS  /tmp/ccgjJaEg.s 			page 52


1063:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1064:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_RJCOUNT1_OVERFLOW;
1065:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1066:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1067:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1068:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType1( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1069:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1070:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1071:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1072:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1073:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1074:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // cmac = aes128_cmac(JSIntKey, MHDR | RejoinType | JoinEUI| DevEUI | RJcount1)
1075:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( NULL, macMsg->Buffer, ( LORAMAC_RE_JOIN_1_MSG_SIZE - LORAMAC_M
1076:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1077:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1078:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1079:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1080:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reserialize message to add the MIC
1081:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType1( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1082:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1083:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1084:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1085:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1086:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Increment RJcount1
1087:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.RJcount1++;
1088:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1089:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1090:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1091:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1092:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoPrepareReJoinType0or2( LoRaMacMessageReJoinType0or2_t* macMsg )
1093:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
1094:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
1095:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1096:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1097:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1098:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1099:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check for RJcount0 overflow
1100:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( RJcount0 == 65535 )
1101:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1102:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_RJCOUNT0_OVERFLOW;
1103:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1104:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1105:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1106:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType0or2( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1107:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1108:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1109:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1110:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1111:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1112:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // cmac = aes128_cmac(SNwkSIntKey, MHDR | Rejoin Type | NetID | DevEUI | RJcount0)
1113:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( NULL, macMsg->Buffer, ( LORAMAC_RE_JOIN_0_2_MSG_SIZE - LORAMAC
1114:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1115:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1116:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1117:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1118:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Re-serialize message to add the MIC
1119:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType0or2( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
ARM GAS  /tmp/ccgjJaEg.s 			page 53


1120:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1121:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1122:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1123:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1124:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Increment RJcount0
1125:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     RJcount0++;
1126:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1127:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1128:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1129:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1130:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1131:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoHandleJoinAccept( JoinReqIdentifier_t joinReqType, uint8_t* join
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( macMsg == 0 ) || ( joinEUI == 0 ) )
1134:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1136:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1137:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t decJoinAccept[LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE] = { 0 };
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t nonce               = CryptoNvm->DevNonce;
1142:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1143:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Nonce selection depending on JoinReqType
1144:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // JOIN_REQ     : CryptoNvm->DevNonce
1145:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // REJOIN_REQ_0 : RJcount0
1146:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // REJOIN_REQ_1 : CryptoCtx.RJcount1
1147:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // REJOIN_REQ_2 : RJcount0
1148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( joinReqType == JOIN_REQ )
1149:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1150:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Nothing to be done
1151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1152:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1153:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1154:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1155:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // If Join-accept is a reply to a rejoin, the RJcount(0 or 1) replaces DevNonce in the key 
1156:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( ( joinReqType == REJOIN_REQ_0 ) || ( joinReqType == REJOIN_REQ_2 ) )
1157:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1158:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             nonce = RJcount0;
1159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         else
1161:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             nonce = CryptoNvm->FCntList.RJcount1;
1163:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1164:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementProcessJoinAccept( joinReqType, joinEUI, nonce, macMsg->Buffer,
1168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
1169:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         &versionMinor ) != SECURE_ELEMENT_SUCCESS )
1170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1173:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpy1( macMsg->Buffer, decJoinAccept, macMsg->BufSize );
1175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Parse the message
ARM GAS  /tmp/ccgjJaEg.s 			page 54


1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacParserJoinAccept( macMsg ) != LORAMAC_PARSER_SUCCESS )
1178:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_PARSER;
1180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t currentJoinNonce;
1183:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce = ( uint32_t )macMsg->JoinNonce[0];
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[1] << 8 );
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
1187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_JOIN_NONCE_COUNTER_CHECK == 1 )
1189:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check if the JoinNonce is greater as the previous one
1190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentJoinNonce > CryptoNvm->JoinNonce )
1191:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else
1192:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check if the JoinNonce is different from the previous one
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentJoinNonce != CryptoNvm->JoinNonce )
1194:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
1195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         CryptoNvm->JoinNonce = currentJoinNonce;
1197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1199:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_JOIN_NONCE;
1201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1203:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Derive lifetime keys
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = LoRaMacCryptoDeriveMcRootKey( versionMinor, APP_KEY );
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
1206:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1207:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1208:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1209:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = LoRaMacCryptoDeriveMcKEKey( MC_ROOT_KEY );
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
1212:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1213:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1214:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1215:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1216:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1217:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( versionMinor == 1 )
1218:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1219:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Operating in LoRaWAN 1.1.x mode
1220:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1221:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( F_NWK_S_INT_KEY, currentJoinNonce, joinEUI, nonce );
1222:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1223:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1224:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1225:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1226:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1227:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( S_NWK_S_INT_KEY, currentJoinNonce, joinEUI, nonce );
1228:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1229:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1230:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1231:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1232:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1233:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( NWK_S_ENC_KEY, currentJoinNonce, joinEUI, nonce );
ARM GAS  /tmp/ccgjJaEg.s 			page 55


1234:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1235:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1236:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1237:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1238:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1239:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( APP_S_KEY, currentJoinNonce, joinEUI, nonce );
1240:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1241:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1242:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1243:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1244:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1245:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1246:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1247:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1248:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Operating in LoRaWAN 1.0.x mode
1249:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint32_t netID;
1251:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID = ( uint32_t )macMsg->NetID[0];
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[1] << 8 );
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
1255:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( APP_S_KEY, currentJoinNonce, netID, nonce );
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1258:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1259:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1260:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1261:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1262:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1263:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1264:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( NWK_S_ENC_KEY, currentJoinNonce, netID, nonce );
1265:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1266:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1267:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1268:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1269:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1270:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( F_NWK_S_INT_KEY, currentJoinNonce, netID, nonce );
1271:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1272:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1273:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1274:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1275:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1276:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( S_NWK_S_INT_KEY, currentJoinNonce, netID, nonce );
1277:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( NWK_S_KEY, currentJoinNonce, netID, nonce );
1279:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1280:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1282:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1283:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1284:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1285:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1286:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1287:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Join-Accept is successfully processed
1288:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Save LoRaWAN specification version
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Minor = versionMinor;
1290:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 56


1291:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reset frame counters
1292:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1293:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     RJcount0 = 0;
1294:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntUp = 0;
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
1299:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1302:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1303:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSecureMessage( uint32_t fCntUp, uint8_t txDr, uint8_t txCh, LoRa
1304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1641              		.loc 1 1304 1 is_stmt 1 view -0
 1642              		.cfi_startproc
 1643              		@ args = 0, pretend = 0, frame = 0
 1644              		@ frame_needed = 0, uses_anonymous_args = 0
1305:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 1645              		.loc 1 1305 5 view .LVU479
1306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t payloadDecryptionKeyID = APP_S_KEY;
 1646              		.loc 1 1306 5 view .LVU480
1307:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1308:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == NULL )
 1647              		.loc 1 1308 5 view .LVU481
 1648              		.loc 1 1308 7 is_stmt 0 view .LVU482
 1649 0000 002B     		cmp	r3, #0
 1650 0002 36D0     		beq	.L134
1304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 1651              		.loc 1 1304 1 view .LVU483
 1652 0004 30B5     		push	{r4, r5, lr}
 1653              	.LCFI36:
 1654              		.cfi_def_cfa_offset 12
 1655              		.cfi_offset 4, -12
 1656              		.cfi_offset 5, -8
 1657              		.cfi_offset 14, -4
 1658 0006 85B0     		sub	sp, sp, #20
 1659              	.LCFI37:
 1660              		.cfi_def_cfa_offset 32
 1661 0008 0446     		mov	r4, r0
 1662 000a 1D46     		mov	r5, r3
1309:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1311:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1312:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1313:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( fCntUp < CryptoNvm->FCntList.FCntUp )
 1663              		.loc 1 1313 5 is_stmt 1 view .LVU484
 1664              		.loc 1 1313 27 is_stmt 0 view .LVU485
 1665 000c 1D4B     		ldr	r3, .L143
 1666              	.LVL137:
 1667              		.loc 1 1313 27 view .LVU486
 1668 000e 1B68     		ldr	r3, [r3]
 1669              		.loc 1 1313 37 view .LVU487
 1670 0010 DB68     		ldr	r3, [r3, #12]
 1671              		.loc 1 1313 7 view .LVU488
 1672 0012 8342     		cmp	r3, r0
 1673 0014 2FD8     		bhi	.L135
ARM GAS  /tmp/ccgjJaEg.s 			page 57


1314:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_FCNT_SMALLER;
1316:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1317:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1318:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Encrypt payload
1319:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg->FPort == 0 )
 1674              		.loc 1 1319 5 is_stmt 1 view .LVU489
 1675              		.loc 1 1319 15 is_stmt 0 view .LVU490
 1676 0016 95F82020 		ldrb	r2, [r5, #32]	@ zero_extendqisi2
 1677              	.LVL138:
 1678              		.loc 1 1319 7 view .LVU491
 1679 001a 42B3     		cbz	r2, .L136
1306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1680              		.loc 1 1306 21 view .LVU492
 1681 001c 0322     		movs	r2, #3
 1682              	.L132:
 1683              	.LVL139:
1320:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1321:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Use network session key
1322:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1323:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1324:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_ENC_KEY;
1325:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_KEY;
1327:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1328:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1329:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1330:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1331:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( fCntUp > CryptoNvm->FCntList.FCntUp )
 1684              		.loc 1 1331 5 is_stmt 1 view .LVU493
 1685              		.loc 1 1331 7 is_stmt 0 view .LVU494
 1686 001e A342     		cmp	r3, r4
 1687 0020 09D2     		bcs	.L133
1332:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1333:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = PayloadEncrypt( macMsg->FRMPayload, macMsg->FRMPayloadSize, payloadDecryptionKeyID
 1688              		.loc 1 1333 9 is_stmt 1 view .LVU495
 1689              		.loc 1 1333 18 is_stmt 0 view .LVU496
 1690 0022 0194     		str	r4, [sp, #4]
 1691 0024 0023     		movs	r3, #0
 1692 0026 0093     		str	r3, [sp]
 1693 0028 AB68     		ldr	r3, [r5, #8]
 1694 002a 95F82810 		ldrb	r1, [r5, #40]	@ zero_extendqisi2
 1695              	.LVL140:
 1696              		.loc 1 1333 18 view .LVU497
 1697 002e 686A     		ldr	r0, [r5, #36]
 1698              	.LVL141:
 1699              		.loc 1 1333 18 view .LVU498
 1700 0030 FFF7FEFF 		bl	PayloadEncrypt
 1701              	.LVL142:
1334:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 1702              		.loc 1 1334 9 is_stmt 1 view .LVU499
 1703              		.loc 1 1334 11 is_stmt 0 view .LVU500
 1704 0034 10BB     		cbnz	r0, .L131
 1705              	.LVL143:
 1706              	.L133:
1335:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1336:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
ARM GAS  /tmp/ccgjJaEg.s 			page 58


1337:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1338:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1339:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1340:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( CryptoNvm->LrWanVersion.Fields.Minor == 1 )
1341:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1342:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             // Encrypt FOpts
1343:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             retval = FOptsEncrypt( macMsg->FHDR.FCtrl.Bits.FOptsLen, macMsg->FHDR.DevAddr, UPLINK, 
1344:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             if( retval != LORAMAC_CRYPTO_SUCCESS )
1345:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
1346:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 return retval;
1347:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
1348:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1349:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1350:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1351:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1352:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1353:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerData( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1707              		.loc 1 1353 5 is_stmt 1 view .LVU501
 1708              		.loc 1 1353 9 is_stmt 0 view .LVU502
 1709 0036 2846     		mov	r0, r5
 1710 0038 FFF7FEFF 		bl	LoRaMacSerializerData
 1711              	.LVL144:
 1712              		.loc 1 1353 7 view .LVU503
 1713 003c E8B9     		cbnz	r0, .L137
1354:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1356:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1357:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1358:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1359:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1360:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 1 )
1361:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1362:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint32_t cmacS = 0;
1363:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint32_t cmacF = 0;
1364:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1365:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // cmacS  = aes128_cmac(SNwkSIntKey, B1 | msg)
1366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = ComputeCmacB1( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), S_NWK
1367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1368:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1370:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         //cmacF = aes128_cmac(FNwkSIntKey, B0 | msg)
1372:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = ComputeCmacB0( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), F_NWK
1373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1374:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1375:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1377:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // MIC = cmacS[0..1] | cmacF[0..1]
1378:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         macMsg->MIC = ( ( cmacF << 16 ) & 0xFFFF0000 ) | ( cmacS & 0x0000FFFF );
1379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1380:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1382:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {        
1383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Use network session key
1384:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1385:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_ENC_KEY;
ARM GAS  /tmp/ccgjJaEg.s 			page 59


1387:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1388:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_KEY;
 1714              		.loc 1 1388 9 is_stmt 1 view .LVU504
 1715              	.LVL145:
1389:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1390:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1391:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // MIC = cmacF[0..3]
1392:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // The IsAck parameter is every time false since the ConfFCnt field is not used in legacy m
1393:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = ComputeCmacB0( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), paylo
 1716              		.loc 1 1393 9 view .LVU505
 1717              		.loc 1 1393 57 is_stmt 0 view .LVU506
 1718 003e 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 1719              		.loc 1 1393 18 view .LVU507
 1720 0040 0439     		subs	r1, r1, #4
 1721 0042 2B46     		mov	r3, r5
 1722 0044 53F82C0B 		ldr	r0, [r3], #44
 1723 0048 0393     		str	r3, [sp, #12]
 1724 004a 0294     		str	r4, [sp, #8]
 1725 004c AB68     		ldr	r3, [r5, #8]
 1726 004e 0193     		str	r3, [sp, #4]
 1727 0050 0023     		movs	r3, #0
 1728 0052 0093     		str	r3, [sp]
 1729 0054 0222     		movs	r2, #2
 1730 0056 89B2     		uxth	r1, r1
 1731 0058 FFF7FEFF 		bl	ComputeCmacB0
 1732              	.LVL146:
1394:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 1733              		.loc 1 1394 9 is_stmt 1 view .LVU508
 1734              		.loc 1 1394 11 is_stmt 0 view .LVU509
 1735 005c 70B9     		cbnz	r0, .L131
1395:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1396:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1397:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1398:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1399:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1400:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Re-serialize message to add the MIC
1401:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerData( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1736              		.loc 1 1401 5 is_stmt 1 view .LVU510
 1737              		.loc 1 1401 9 is_stmt 0 view .LVU511
 1738 005e 2846     		mov	r0, r5
 1739              	.LVL147:
 1740              		.loc 1 1401 9 view .LVU512
 1741 0060 FFF7FEFF 		bl	LoRaMacSerializerData
 1742              	.LVL148:
 1743              		.loc 1 1401 7 view .LVU513
 1744 0064 60B9     		cbnz	r0, .L138
1402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1404:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1406:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntUp = fCntUp;
 1745              		.loc 1 1406 5 is_stmt 1 view .LVU514
 1746              		.loc 1 1406 14 is_stmt 0 view .LVU515
 1747 0066 074B     		ldr	r3, .L143
 1748 0068 1B68     		ldr	r3, [r3]
 1749              		.loc 1 1406 32 view .LVU516
 1750 006a DC60     		str	r4, [r3, #12]
ARM GAS  /tmp/ccgjJaEg.s 			page 60


1407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1408:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1751              		.loc 1 1408 5 is_stmt 1 view .LVU517
 1752              		.loc 1 1408 12 is_stmt 0 view .LVU518
 1753 006c 06E0     		b	.L131
 1754              	.LVL149:
 1755              	.L136:
1326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 1756              		.loc 1 1326 32 view .LVU519
 1757 006e 0222     		movs	r2, #2
 1758 0070 D5E7     		b	.L132
 1759              	.LVL150:
 1760              	.L134:
 1761              	.LCFI38:
 1762              		.cfi_def_cfa_offset 0
 1763              		.cfi_restore 4
 1764              		.cfi_restore 5
 1765              		.cfi_restore 14
1310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1766              		.loc 1 1310 16 view .LVU520
 1767 0072 0A20     		movs	r0, #10
 1768              	.LVL151:
1409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1769              		.loc 1 1409 1 view .LVU521
 1770 0074 7047     		bx	lr
 1771              	.LVL152:
 1772              	.L135:
 1773              	.LCFI39:
 1774              		.cfi_def_cfa_offset 32
 1775              		.cfi_offset 4, -12
 1776              		.cfi_offset 5, -8
 1777              		.cfi_offset 14, -4
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1778              		.loc 1 1315 16 view .LVU522
 1779 0076 0620     		movs	r0, #6
 1780              	.LVL153:
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1781              		.loc 1 1315 16 view .LVU523
 1782 0078 00E0     		b	.L131
 1783              	.LVL154:
 1784              	.L137:
1355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1785              		.loc 1 1355 16 view .LVU524
 1786 007a 1120     		movs	r0, #17
 1787              	.L131:
 1788              		.loc 1 1409 1 view .LVU525
 1789 007c 05B0     		add	sp, sp, #20
 1790              	.LCFI40:
 1791              		.cfi_remember_state
 1792              		.cfi_def_cfa_offset 12
 1793              		@ sp needed
 1794 007e 30BD     		pop	{r4, r5, pc}
 1795              	.LVL155:
 1796              	.L138:
 1797              	.LCFI41:
 1798              		.cfi_restore_state
1403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  /tmp/ccgjJaEg.s 			page 61


 1799              		.loc 1 1403 16 view .LVU526
 1800 0080 1120     		movs	r0, #17
 1801 0082 FBE7     		b	.L131
 1802              	.L144:
 1803              		.align	2
 1804              	.L143:
 1805 0084 00000000 		.word	.LANCHOR1
 1806              		.cfi_endproc
 1807              	.LFE122:
 1809              		.section	.text.LoRaMacCryptoUnsecureMessage,"ax",%progbits
 1810              		.align	1
 1811              		.global	LoRaMacCryptoUnsecureMessage
 1812              		.syntax unified
 1813              		.thumb
 1814              		.thumb_func
 1815              		.fpu softvfp
 1817              	LoRaMacCryptoUnsecureMessage:
 1818              	.LVL156:
 1819              	.LFB123:
1410:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1411:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoUnsecureMessage( AddressIdentifier_t addrID, uint32_t address, F
1412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1820              		.loc 1 1412 1 is_stmt 1 view -0
 1821              		.cfi_startproc
 1822              		@ args = 4, pretend = 0, frame = 8
 1823              		@ frame_needed = 0, uses_anonymous_args = 0
 1824              		.loc 1 1412 1 is_stmt 0 view .LVU528
 1825 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 1826              	.LCFI42:
 1827              		.cfi_def_cfa_offset 28
 1828              		.cfi_offset 4, -28
 1829              		.cfi_offset 5, -24
 1830              		.cfi_offset 6, -20
 1831              		.cfi_offset 7, -16
 1832              		.cfi_offset 8, -12
 1833              		.cfi_offset 9, -8
 1834              		.cfi_offset 14, -4
 1835 0004 87B0     		sub	sp, sp, #28
 1836              	.LCFI43:
 1837              		.cfi_def_cfa_offset 56
 1838 0006 0E9E     		ldr	r6, [sp, #56]
1413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
 1839              		.loc 1 1413 5 is_stmt 1 view .LVU529
 1840              		.loc 1 1413 7 is_stmt 0 view .LVU530
 1841 0008 002E     		cmp	r6, #0
 1842 000a 49D0     		beq	.L149
 1843 000c 0546     		mov	r5, r0
 1844 000e 8846     		mov	r8, r1
 1845 0010 1746     		mov	r7, r2
 1846 0012 1C46     		mov	r4, r3
1414:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1417:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1418:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CheckFCntDown( fCntID, fCntDown ) == false )
 1847              		.loc 1 1418 5 is_stmt 1 view .LVU531
 1848              		.loc 1 1418 9 is_stmt 0 view .LVU532
ARM GAS  /tmp/ccgjJaEg.s 			page 62


 1849 0014 1946     		mov	r1, r3
 1850              	.LVL157:
 1851              		.loc 1 1418 9 view .LVU533
 1852 0016 1046     		mov	r0, r2
 1853              	.LVL158:
 1854              		.loc 1 1418 9 view .LVU534
 1855 0018 FFF7FEFF 		bl	CheckFCntDown
 1856              	.LVL159:
 1857              		.loc 1 1418 7 view .LVU535
 1858 001c 0028     		cmp	r0, #0
 1859 001e 41D0     		beq	.L150
1419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_FCNT_SMALLER;
1421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1423:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 1860              		.loc 1 1423 5 is_stmt 1 view .LVU536
 1861              	.LVL160:
1424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t payloadDecryptionKeyID = APP_S_KEY;
 1862              		.loc 1 1424 5 view .LVU537
1425:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1426:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1427:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t micComputationKeyID = S_NWK_S_INT_KEY;
1428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1429:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t micComputationKeyID = NWK_S_KEY;
 1863              		.loc 1 1429 5 view .LVU538
1430:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1431:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORKAROUND_END */
1432:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyAddr_t* curItem;
 1864              		.loc 1 1432 5 view .LVU539
1433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Parse the message
1435:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacParserData( macMsg ) != LORAMAC_PARSER_SUCCESS )
 1865              		.loc 1 1435 5 view .LVU540
 1866              		.loc 1 1435 9 is_stmt 0 view .LVU541
 1867 0020 3046     		mov	r0, r6
 1868 0022 FFF7FEFF 		bl	LoRaMacParserData
 1869              	.LVL161:
 1870              		.loc 1 1435 7 view .LVU542
 1871 0026 0028     		cmp	r0, #0
 1872 0028 41D1     		bne	.L151
1436:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_PARSER;
1438:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1439:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1440:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Determine current security context
1441:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = GetKeyAddrItem( addrID, &curItem );
 1873              		.loc 1 1441 5 is_stmt 1 view .LVU543
 1874              		.loc 1 1441 14 is_stmt 0 view .LVU544
 1875 002a 05A9     		add	r1, sp, #20
 1876 002c 2846     		mov	r0, r5
 1877 002e FFF7FEFF 		bl	GetKeyAddrItem
 1878              	.LVL162:
1442:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 1879              		.loc 1 1442 5 is_stmt 1 view .LVU545
 1880              		.loc 1 1442 7 is_stmt 0 view .LVU546
 1881 0032 0546     		mov	r5, r0
ARM GAS  /tmp/ccgjJaEg.s 			page 63


 1882 0034 0028     		cmp	r0, #0
 1883 0036 36D1     		bne	.L146
1443:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1444:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1445:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1446:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1447:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     payloadDecryptionKeyID = curItem->AppSkey;
 1884              		.loc 1 1447 5 is_stmt 1 view .LVU547
 1885              		.loc 1 1447 37 is_stmt 0 view .LVU548
 1886 0038 059B     		ldr	r3, [sp, #20]
 1887              		.loc 1 1447 28 view .LVU549
 1888 003a 93F80190 		ldrb	r9, [r3, #1]	@ zero_extendqisi2
 1889              	.LVL163:
1448:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     micComputationKeyID = curItem->NwkSkey;
 1890              		.loc 1 1448 5 is_stmt 1 view .LVU550
 1891              		.loc 1 1448 25 is_stmt 0 view .LVU551
 1892 003e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1893              	.LVL164:
1449:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1450:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check if it is our address
1451:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( address != macMsg->FHDR.DevAddr )
 1894              		.loc 1 1451 5 is_stmt 1 view .LVU552
 1895              		.loc 1 1451 32 is_stmt 0 view .LVU553
 1896 0040 B368     		ldr	r3, [r6, #8]
 1897              		.loc 1 1451 7 view .LVU554
 1898 0042 4345     		cmp	r3, r8
 1899 0044 35D1     		bne	.L152
1452:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_ADDRESS;
1454:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1455:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1456:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1457:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     bool isAck = macMsg->FHDR.FCtrl.Bits.Ack;
 1900              		.loc 1 1457 5 is_stmt 1 view .LVU555
 1901              		.loc 1 1457 41 is_stmt 0 view .LVU556
 1902 0046 337B     		ldrb	r3, [r6, #12]	@ zero_extendqisi2
 1903 0048 C3F34013 		ubfx	r3, r3, #5, #1
 1904              	.LVL165:
1458:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 0 )
 1905              		.loc 1 1458 5 is_stmt 1 view .LVU557
 1906              		.loc 1 1458 18 is_stmt 0 view .LVU558
 1907 004c 1A49     		ldr	r1, .L156
 1908 004e 0968     		ldr	r1, [r1]
 1909              		.loc 1 1458 39 view .LVU559
 1910 0050 8978     		ldrb	r1, [r1, #2]	@ zero_extendqisi2
 1911              		.loc 1 1458 7 view .LVU560
 1912 0052 01B9     		cbnz	r1, .L147
1459:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1460:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // In legacy mode the IsAck parameter is forced to be false since the ConfFCnt field is not
1461:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         isAck = false;
 1913              		.loc 1 1461 15 view .LVU561
 1914 0054 0023     		movs	r3, #0
 1915              	.L147:
 1916              	.LVL166:
1462:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1463:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1464:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Verify mic
ARM GAS  /tmp/ccgjJaEg.s 			page 64


1465:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = VerifyCmacB0( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), micComputa
 1917              		.loc 1 1465 5 is_stmt 1 view .LVU562
 1918              		.loc 1 1465 52 is_stmt 0 view .LVU563
 1919 0056 3179     		ldrb	r1, [r6, #4]	@ zero_extendqisi2
 1920              		.loc 1 1465 14 view .LVU564
 1921 0058 0439     		subs	r1, r1, #4
 1922 005a F06A     		ldr	r0, [r6, #44]
 1923              	.LVL167:
 1924              		.loc 1 1465 14 view .LVU565
 1925 005c 0390     		str	r0, [sp, #12]
 1926 005e 0294     		str	r4, [sp, #8]
 1927 0060 CDF80480 		str	r8, [sp, #4]
 1928 0064 0120     		movs	r0, #1
 1929 0066 0090     		str	r0, [sp]
 1930 0068 89B2     		uxth	r1, r1
 1931 006a 3068     		ldr	r0, [r6]
 1932 006c FFF7FEFF 		bl	VerifyCmacB0
 1933              	.LVL168:
1466:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 1934              		.loc 1 1466 5 is_stmt 1 view .LVU566
 1935              		.loc 1 1466 7 is_stmt 0 view .LVU567
 1936 0070 0546     		mov	r5, r0
 1937 0072 C0B9     		cbnz	r0, .L146
1467:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1468:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1469:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1470:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1471:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Decrypt payload
1472:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg->FPort == 0 )
 1938              		.loc 1 1472 5 is_stmt 1 view .LVU568
 1939              		.loc 1 1472 15 is_stmt 0 view .LVU569
 1940 0074 96F82030 		ldrb	r3, [r6, #32]	@ zero_extendqisi2
 1941              		.loc 1 1472 7 view .LVU570
 1942 0078 0BB9     		cbnz	r3, .L148
1473:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1474:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Use network session encryption key
1475:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1476:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1477:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_ENC_KEY;
1478:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1479:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_KEY;
 1943              		.loc 1 1479 32 view .LVU571
 1944 007a 4FF00209 		mov	r9, #2
 1945              	.LVL169:
 1946              	.L148:
1480:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1481:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1482:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1483:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = PayloadEncrypt( macMsg->FRMPayload, macMsg->FRMPayloadSize, payloadDecryptionKeyID, ad
 1947              		.loc 1 1483 5 is_stmt 1 view .LVU572
 1948              		.loc 1 1483 14 is_stmt 0 view .LVU573
 1949 007e 0194     		str	r4, [sp, #4]
 1950 0080 0123     		movs	r3, #1
 1951 0082 0093     		str	r3, [sp]
 1952 0084 4346     		mov	r3, r8
 1953 0086 4A46     		mov	r2, r9
 1954 0088 96F82810 		ldrb	r1, [r6, #40]	@ zero_extendqisi2
ARM GAS  /tmp/ccgjJaEg.s 			page 65


 1955 008c 706A     		ldr	r0, [r6, #36]
 1956              	.LVL170:
 1957              		.loc 1 1483 14 view .LVU574
 1958 008e FFF7FEFF 		bl	PayloadEncrypt
 1959              	.LVL171:
1484:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 1960              		.loc 1 1484 5 is_stmt 1 view .LVU575
 1961              		.loc 1 1484 7 is_stmt 0 view .LVU576
 1962 0092 0546     		mov	r5, r0
 1963 0094 38B9     		cbnz	r0, .L146
1485:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1486:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1487:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1488:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1489:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1490:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 1 )
1491:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1492:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( addrID == UNICAST_DEV_ADDR )
1493:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1494:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             // Decrypt FOpts
1495:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             retval = FOptsEncrypt( macMsg->FHDR.FCtrl.Bits.FOptsLen, address, DOWNLINK, fCntID, fCn
1496:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             if( retval != LORAMAC_CRYPTO_SUCCESS )
1497:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
1498:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 return retval;
1499:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
1500:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         } 
1501:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1502:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif
1503:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1504:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     UpdateFCntDown( fCntID, fCntDown );
 1964              		.loc 1 1504 5 is_stmt 1 view .LVU577
 1965 0096 2146     		mov	r1, r4
 1966 0098 3846     		mov	r0, r7
 1967              	.LVL172:
 1968              		.loc 1 1504 5 is_stmt 0 view .LVU578
 1969 009a FFF7FEFF 		bl	UpdateFCntDown
 1970              	.LVL173:
1505:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1506:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1971              		.loc 1 1506 5 is_stmt 1 view .LVU579
 1972              		.loc 1 1506 12 is_stmt 0 view .LVU580
 1973 009e 02E0     		b	.L146
 1974              	.LVL174:
 1975              	.L149:
1415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1976              		.loc 1 1415 16 view .LVU581
 1977 00a0 0A25     		movs	r5, #10
 1978 00a2 00E0     		b	.L146
 1979              	.LVL175:
 1980              	.L150:
1420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1981              		.loc 1 1420 16 view .LVU582
 1982 00a4 0625     		movs	r5, #6
 1983              	.LVL176:
 1984              	.L146:
1507:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1985              		.loc 1 1507 1 view .LVU583
ARM GAS  /tmp/ccgjJaEg.s 			page 66


 1986 00a6 2846     		mov	r0, r5
 1987 00a8 07B0     		add	sp, sp, #28
 1988              	.LCFI44:
 1989              		.cfi_remember_state
 1990              		.cfi_def_cfa_offset 28
 1991              		@ sp needed
 1992 00aa BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 1993              	.LVL177:
 1994              	.L151:
 1995              	.LCFI45:
 1996              		.cfi_restore_state
1437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1997              		.loc 1 1437 16 view .LVU584
 1998 00ae 1025     		movs	r5, #16
 1999 00b0 F9E7     		b	.L146
 2000              	.LVL178:
 2001              	.L152:
1453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2002              		.loc 1 1453 16 view .LVU585
 2003 00b2 0225     		movs	r5, #2
 2004 00b4 F7E7     		b	.L146
 2005              	.L157:
 2006 00b6 00BF     		.align	2
 2007              	.L156:
 2008 00b8 00000000 		.word	.LANCHOR1
 2009              		.cfi_endproc
 2010              	.LFE123:
 2012              		.section	.text.LoRaMacCryptoDeriveMcRootKey,"ax",%progbits
 2013              		.align	1
 2014              		.global	LoRaMacCryptoDeriveMcRootKey
 2015              		.syntax unified
 2016              		.thumb
 2017              		.thumb_func
 2018              		.fpu softvfp
 2020              	LoRaMacCryptoDeriveMcRootKey:
 2021              	.LVL179:
 2022              	.LFB124:
1508:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1509:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoDeriveMcRootKey( uint8_t versionMinor, KeyIdentifier_t keyID )
1510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 2023              		.loc 1 1510 1 is_stmt 1 view -0
 2024              		.cfi_startproc
 2025              		@ args = 0, pretend = 0, frame = 16
 2026              		@ frame_needed = 0, uses_anonymous_args = 0
1511:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than AppKey
1512:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( keyID != APP_KEY )
 2027              		.loc 1 1512 5 view .LVU587
 2028              		.loc 1 1512 7 is_stmt 0 view .LVU588
 2029 0000 B1B9     		cbnz	r1, .L161
1510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than AppKey
 2030              		.loc 1 1510 1 view .LVU589
 2031 0002 00B5     		push	{lr}
 2032              	.LCFI46:
 2033              		.cfi_def_cfa_offset 4
 2034              		.cfi_offset 14, -4
 2035 0004 85B0     		sub	sp, sp, #20
 2036              	.LCFI47:
ARM GAS  /tmp/ccgjJaEg.s 			page 67


 2037              		.cfi_def_cfa_offset 24
 2038 0006 8C46     		mov	ip, r1
1513:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
1515:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1516:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 2039              		.loc 1 1516 5 is_stmt 1 view .LVU590
 2040              		.loc 1 1516 13 is_stmt 0 view .LVU591
 2041 0008 0023     		movs	r3, #0
 2042 000a 0093     		str	r3, [sp]
 2043 000c 0193     		str	r3, [sp, #4]
 2044 000e 0293     		str	r3, [sp, #8]
 2045 0010 0393     		str	r3, [sp, #12]
1517:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1518:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( versionMinor == 1 )
 2046              		.loc 1 1518 5 is_stmt 1 view .LVU592
 2047              		.loc 1 1518 7 is_stmt 0 view .LVU593
 2048 0012 0128     		cmp	r0, #1
 2049 0014 08D0     		beq	.L167
 2050              	.L160:
1519:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         compBase[0] = 0x20;
1521:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1522:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, keyID, MC_ROOT_KEY ) != SECURE_ELEMENT_SUCCESS )
 2051              		.loc 1 1522 5 is_stmt 1 view .LVU594
 2052              		.loc 1 1522 9 is_stmt 0 view .LVU595
 2053 0016 0422     		movs	r2, #4
 2054 0018 6146     		mov	r1, ip
 2055              	.LVL180:
 2056              		.loc 1 1522 9 view .LVU596
 2057 001a 6846     		mov	r0, sp
 2058              	.LVL181:
 2059              		.loc 1 1522 9 view .LVU597
 2060 001c FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2061              	.LVL182:
 2062              		.loc 1 1522 7 view .LVU598
 2063 0020 40B9     		cbnz	r0, .L168
 2064              	.L159:
1523:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1525:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1526:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1527:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1528:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2065              		.loc 1 1528 1 view .LVU599
 2066 0022 05B0     		add	sp, sp, #20
 2067              	.LCFI48:
 2068              		.cfi_remember_state
 2069              		.cfi_def_cfa_offset 4
 2070              		@ sp needed
 2071 0024 5DF804FB 		ldr	pc, [sp], #4
 2072              	.LVL183:
 2073              	.L167:
 2074              	.LCFI49:
 2075              		.cfi_restore_state
1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2076              		.loc 1 1520 9 is_stmt 1 view .LVU600
ARM GAS  /tmp/ccgjJaEg.s 			page 68


1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2077              		.loc 1 1520 21 is_stmt 0 view .LVU601
 2078 0028 2023     		movs	r3, #32
 2079 002a 8DF80030 		strb	r3, [sp]
 2080 002e F2E7     		b	.L160
 2081              	.L161:
 2082              	.LCFI50:
 2083              		.cfi_def_cfa_offset 0
 2084              		.cfi_restore 14
1514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2085              		.loc 1 1514 16 view .LVU602
 2086 0030 0B20     		movs	r0, #11
 2087              	.LVL184:
 2088              		.loc 1 1528 1 view .LVU603
 2089 0032 7047     		bx	lr
 2090              	.LVL185:
 2091              	.L168:
 2092              	.LCFI51:
 2093              		.cfi_def_cfa_offset 24
 2094              		.cfi_offset 14, -4
1524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2095              		.loc 1 1524 16 view .LVU604
 2096 0034 0F20     		movs	r0, #15
 2097 0036 F4E7     		b	.L159
 2098              		.cfi_endproc
 2099              	.LFE124:
 2101              		.section	.text.LoRaMacCryptoDeriveMcKEKey,"ax",%progbits
 2102              		.align	1
 2103              		.global	LoRaMacCryptoDeriveMcKEKey
 2104              		.syntax unified
 2105              		.thumb
 2106              		.thumb_func
 2107              		.fpu softvfp
 2109              	LoRaMacCryptoDeriveMcKEKey:
 2110              	.LVL186:
 2111              	.LFB125:
1529:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1530:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoDeriveMcKEKey( KeyIdentifier_t keyID )
1531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 2112              		.loc 1 1531 1 is_stmt 1 view -0
 2113              		.cfi_startproc
 2114              		@ args = 0, pretend = 0, frame = 16
 2115              		@ frame_needed = 0, uses_anonymous_args = 0
1532:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than McRootKey
1533:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( keyID != MC_ROOT_KEY )
 2116              		.loc 1 1533 5 view .LVU606
 2117              		.loc 1 1533 7 is_stmt 0 view .LVU607
 2118 0000 0428     		cmp	r0, #4
 2119 0002 01D0     		beq	.L177
1534:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1535:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 2120              		.loc 1 1535 16 view .LVU608
 2121 0004 0B20     		movs	r0, #11
 2122              	.LVL187:
1536:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
1538:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 69


1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, keyID, MC_KE_KEY ) != SECURE_ELEMENT_SUCCESS )
1540:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1543:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1544:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1545:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2123              		.loc 1 1545 1 view .LVU609
 2124 0006 7047     		bx	lr
 2125              	.LVL188:
 2126              	.L177:
1531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than McRootKey
 2127              		.loc 1 1531 1 view .LVU610
 2128 0008 00B5     		push	{lr}
 2129              	.LCFI52:
 2130              		.cfi_def_cfa_offset 4
 2131              		.cfi_offset 14, -4
 2132 000a 85B0     		sub	sp, sp, #20
 2133              	.LCFI53:
 2134              		.cfi_def_cfa_offset 24
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2135              		.loc 1 1537 5 is_stmt 1 view .LVU611
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2136              		.loc 1 1537 13 is_stmt 0 view .LVU612
 2137 000c 0023     		movs	r3, #0
 2138 000e 0093     		str	r3, [sp]
 2139 0010 0193     		str	r3, [sp, #4]
 2140 0012 0293     		str	r3, [sp, #8]
 2141 0014 0393     		str	r3, [sp, #12]
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2142              		.loc 1 1539 5 is_stmt 1 view .LVU613
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2143              		.loc 1 1539 9 is_stmt 0 view .LVU614
 2144 0016 7F22     		movs	r2, #127
 2145 0018 0146     		mov	r1, r0
 2146 001a 6846     		mov	r0, sp
 2147              	.LVL189:
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2148              		.loc 1 1539 9 view .LVU615
 2149 001c FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2150              	.LVL190:
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2151              		.loc 1 1539 7 view .LVU616
 2152 0020 10B9     		cbnz	r0, .L178
 2153              	.L170:
 2154              		.loc 1 1545 1 view .LVU617
 2155 0022 05B0     		add	sp, sp, #20
 2156              	.LCFI54:
 2157              		.cfi_remember_state
 2158              		.cfi_def_cfa_offset 4
 2159              		@ sp needed
 2160 0024 5DF804FB 		ldr	pc, [sp], #4
 2161              	.L178:
 2162              	.LCFI55:
 2163              		.cfi_restore_state
1541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2164              		.loc 1 1541 16 view .LVU618
ARM GAS  /tmp/ccgjJaEg.s 			page 70


 2165 0028 0F20     		movs	r0, #15
 2166 002a FAE7     		b	.L170
 2167              		.cfi_endproc
 2168              	.LFE125:
 2170              		.section	.text.LoRaMacCryptoSetKey,"ax",%progbits
 2171              		.align	1
 2172              		.global	LoRaMacCryptoSetKey
 2173              		.syntax unified
 2174              		.thumb
 2175              		.thumb_func
 2176              		.fpu softvfp
 2178              	LoRaMacCryptoSetKey:
 2179              	.LVL191:
 2180              	.LFB119:
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementSetKey( keyID, key ) != SECURE_ELEMENT_SUCCESS )
 2181              		.loc 1 982 1 is_stmt 1 view -0
 2182              		.cfi_startproc
 2183              		@ args = 0, pretend = 0, frame = 0
 2184              		@ frame_needed = 0, uses_anonymous_args = 0
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementSetKey( keyID, key ) != SECURE_ELEMENT_SUCCESS )
 2185              		.loc 1 982 1 is_stmt 0 view .LVU620
 2186 0000 10B5     		push	{r4, lr}
 2187              	.LCFI56:
 2188              		.cfi_def_cfa_offset 8
 2189              		.cfi_offset 4, -8
 2190              		.cfi_offset 14, -4
 2191 0002 0446     		mov	r4, r0
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2192              		.loc 1 983 5 is_stmt 1 view .LVU621
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2193              		.loc 1 983 9 is_stmt 0 view .LVU622
 2194 0004 FFF7FEFF 		bl	SecureElementSetKey
 2195              	.LVL192:
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2196              		.loc 1 983 7 view .LVU623
 2197 0008 78B9     		cbnz	r0, .L181
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2198              		.loc 1 987 5 is_stmt 1 view .LVU624
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2199              		.loc 1 987 7 is_stmt 0 view .LVU625
 2200 000a 04B1     		cbz	r4, .L185
 2201              	.L180:
1000:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2202              		.loc 1 1000 1 view .LVU626
 2203 000c 10BD     		pop	{r4, pc}
 2204              	.L185:
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2205              		.loc 1 990 9 is_stmt 1 view .LVU627
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2206              		.loc 1 990 52 is_stmt 0 view .LVU628
 2207 000e 094B     		ldr	r3, .L186
 2208 0010 1B68     		ldr	r3, [r3]
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2209              		.loc 1 990 13 view .LVU629
 2210 0012 2146     		mov	r1, r4
 2211 0014 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
 2212 0016 FFF7FEFF 		bl	LoRaMacCryptoDeriveMcRootKey
ARM GAS  /tmp/ccgjJaEg.s 			page 71


 2213              	.LVL193:
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2214              		.loc 1 990 11 view .LVU630
 2215 001a 40B9     		cbnz	r0, .L182
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2216              		.loc 1 994 9 is_stmt 1 view .LVU631
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2217              		.loc 1 994 13 is_stmt 0 view .LVU632
 2218 001c 0420     		movs	r0, #4
 2219 001e FFF7FEFF 		bl	LoRaMacCryptoDeriveMcKEKey
 2220              	.LVL194:
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2221              		.loc 1 994 11 view .LVU633
 2222 0022 0028     		cmp	r0, #0
 2223 0024 F2D0     		beq	.L180
 996:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 2224              		.loc 1 996 20 view .LVU634
 2225 0026 0F20     		movs	r0, #15
 2226 0028 F0E7     		b	.L180
 2227              	.L181:
 985:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2228              		.loc 1 985 16 view .LVU635
 2229 002a 0F20     		movs	r0, #15
 2230 002c EEE7     		b	.L180
 2231              	.L182:
 992:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 2232              		.loc 1 992 20 view .LVU636
 2233 002e 0F20     		movs	r0, #15
 2234 0030 ECE7     		b	.L180
 2235              	.L187:
 2236 0032 00BF     		.align	2
 2237              	.L186:
 2238 0034 00000000 		.word	.LANCHOR1
 2239              		.cfi_endproc
 2240              	.LFE119:
 2242              		.section	.text.LoRaMacCryptoHandleJoinAccept,"ax",%progbits
 2243              		.align	1
 2244              		.global	LoRaMacCryptoHandleJoinAccept
 2245              		.syntax unified
 2246              		.thumb
 2247              		.thumb_func
 2248              		.fpu softvfp
 2250              	LoRaMacCryptoHandleJoinAccept:
 2251              	.LVL195:
 2252              	.LFB121:
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( macMsg == 0 ) || ( joinEUI == 0 ) )
 2253              		.loc 1 1132 1 is_stmt 1 view -0
 2254              		.cfi_startproc
 2255              		@ args = 0, pretend = 0, frame = 40
 2256              		@ frame_needed = 0, uses_anonymous_args = 0
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2257              		.loc 1 1133 5 view .LVU638
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2258              		.loc 1 1133 7 is_stmt 0 view .LVU639
 2259 0000 002A     		cmp	r2, #0
 2260 0002 64D0     		beq	.L190
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( macMsg == 0 ) || ( joinEUI == 0 ) )
ARM GAS  /tmp/ccgjJaEg.s 			page 72


 2261              		.loc 1 1132 1 discriminator 1 view .LVU640
 2262 0004 F0B5     		push	{r4, r5, r6, r7, lr}
 2263              	.LCFI57:
 2264              		.cfi_def_cfa_offset 20
 2265              		.cfi_offset 4, -20
 2266              		.cfi_offset 5, -16
 2267              		.cfi_offset 6, -12
 2268              		.cfi_offset 7, -8
 2269              		.cfi_offset 14, -4
 2270 0006 8FB0     		sub	sp, sp, #60
 2271              	.LCFI58:
 2272              		.cfi_def_cfa_offset 80
 2273 0008 0746     		mov	r7, r0
 2274 000a 0D46     		mov	r5, r1
 2275 000c 1446     		mov	r4, r2
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2276              		.loc 1 1133 25 discriminator 1 view .LVU641
 2277 000e 0029     		cmp	r1, #0
 2278 0010 5FD0     		beq	.L191
1138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t decJoinAccept[LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE] = { 0 };
 2279              		.loc 1 1138 5 is_stmt 1 view .LVU642
 2280              	.LVL196:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2281              		.loc 1 1139 5 view .LVU643
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2282              		.loc 1 1139 13 is_stmt 0 view .LVU644
 2283 0012 0026     		movs	r6, #0
 2284 0014 0596     		str	r6, [sp, #20]
 2285 0016 1D22     		movs	r2, #29
 2286              	.LVL197:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2287              		.loc 1 1139 13 view .LVU645
 2288 0018 3146     		mov	r1, r6
 2289              	.LVL198:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2290              		.loc 1 1139 13 view .LVU646
 2291 001a 06A8     		add	r0, sp, #24
 2292              	.LVL199:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2293              		.loc 1 1139 13 view .LVU647
 2294 001c FFF7FEFF 		bl	memset
 2295              	.LVL200:
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t nonce               = CryptoNvm->DevNonce;
 2296              		.loc 1 1140 5 is_stmt 1 view .LVU648
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t nonce               = CryptoNvm->DevNonce;
 2297              		.loc 1 1140 13 is_stmt 0 view .LVU649
 2298 0020 8DF81360 		strb	r6, [sp, #19]
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2299              		.loc 1 1141 5 is_stmt 1 view .LVU650
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2300              		.loc 1 1141 45 is_stmt 0 view .LVU651
 2301 0024 2F4B     		ldr	r3, .L199
 2302 0026 1B68     		ldr	r3, [r3]
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2303              		.loc 1 1141 14 view .LVU652
 2304 0028 9E88     		ldrh	r6, [r3, #4]
 2305              	.LVL201:
ARM GAS  /tmp/ccgjJaEg.s 			page 73


1148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2306              		.loc 1 1148 5 is_stmt 1 view .LVU653
1151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 2307              		.loc 1 1151 5 view .LVU654
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
 2308              		.loc 1 1167 5 view .LVU655
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
 2309              		.loc 1 1167 9 is_stmt 0 view .LVU656
 2310 002a 0DF11303 		add	r3, sp, #19
 2311 002e 0293     		str	r3, [sp, #8]
 2312 0030 05AB     		add	r3, sp, #20
 2313 0032 0193     		str	r3, [sp, #4]
 2314 0034 2379     		ldrb	r3, [r4, #4]	@ zero_extendqisi2
 2315 0036 0093     		str	r3, [sp]
 2316 0038 2368     		ldr	r3, [r4]
 2317 003a 3246     		mov	r2, r6
 2318 003c 2946     		mov	r1, r5
 2319 003e 3846     		mov	r0, r7
 2320 0040 FFF7FEFF 		bl	SecureElementProcessJoinAccept
 2321              	.LVL202:
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
 2322              		.loc 1 1167 7 view .LVU657
 2323 0044 0028     		cmp	r0, #0
 2324 0046 46D1     		bne	.L192
1174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2325              		.loc 1 1174 5 is_stmt 1 view .LVU658
 2326 0048 2279     		ldrb	r2, [r4, #4]	@ zero_extendqisi2
 2327 004a 05A9     		add	r1, sp, #20
 2328 004c 2068     		ldr	r0, [r4]
 2329 004e FFF7FEFF 		bl	memcpy1
 2330              	.LVL203:
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2331              		.loc 1 1177 5 view .LVU659
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2332              		.loc 1 1177 9 is_stmt 0 view .LVU660
 2333 0052 2046     		mov	r0, r4
 2334 0054 FFF7FEFF 		bl	LoRaMacParserJoinAccept
 2335              	.LVL204:
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2336              		.loc 1 1177 7 view .LVU661
 2337 0058 0028     		cmp	r0, #0
 2338 005a 3FD1     		bne	.L193
1182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2339              		.loc 1 1182 5 is_stmt 1 view .LVU662
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[1] << 8 );
 2340              		.loc 1 1184 5 view .LVU663
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[1] << 8 );
 2341              		.loc 1 1184 53 is_stmt 0 view .LVU664
 2342 005c A579     		ldrb	r5, [r4, #6]	@ zero_extendqisi2
 2343              	.LVL205:
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
 2344              		.loc 1 1185 5 is_stmt 1 view .LVU665
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
 2345              		.loc 1 1185 56 is_stmt 0 view .LVU666
 2346 005e E379     		ldrb	r3, [r4, #7]	@ zero_extendqisi2
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
 2347              		.loc 1 1185 22 view .LVU667
ARM GAS  /tmp/ccgjJaEg.s 			page 74


 2348 0060 45EA0325 		orr	r5, r5, r3, lsl #8
 2349              	.LVL206:
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2350              		.loc 1 1186 5 is_stmt 1 view .LVU668
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2351              		.loc 1 1186 56 is_stmt 0 view .LVU669
 2352 0064 237A     		ldrb	r3, [r4, #8]	@ zero_extendqisi2
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2353              		.loc 1 1186 22 view .LVU670
 2354 0066 45EA0345 		orr	r5, r5, r3, lsl #16
 2355              	.LVL207:
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
 2356              		.loc 1 1193 5 is_stmt 1 view .LVU671
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
 2357              		.loc 1 1193 38 is_stmt 0 view .LVU672
 2358 006a 1E4B     		ldr	r3, .L199
 2359 006c 1B68     		ldr	r3, [r3]
 2360 006e 9A68     		ldr	r2, [r3, #8]
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
 2361              		.loc 1 1193 7 view .LVU673
 2362 0070 AA42     		cmp	r2, r5
 2363 0072 35D0     		beq	.L194
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2364              		.loc 1 1196 9 is_stmt 1 view .LVU674
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2365              		.loc 1 1196 30 is_stmt 0 view .LVU675
 2366 0074 9D60     		str	r5, [r3, #8]
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2367              		.loc 1 1204 5 is_stmt 1 view .LVU676
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2368              		.loc 1 1204 14 is_stmt 0 view .LVU677
 2369 0076 0021     		movs	r1, #0
 2370 0078 9DF81300 		ldrb	r0, [sp, #19]	@ zero_extendqisi2
 2371 007c FFF7FEFF 		bl	LoRaMacCryptoDeriveMcRootKey
 2372              	.LVL208:
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2373              		.loc 1 1205 5 is_stmt 1 view .LVU678
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2374              		.loc 1 1205 7 is_stmt 0 view .LVU679
 2375 0080 50BB     		cbnz	r0, .L189
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2376              		.loc 1 1210 5 is_stmt 1 view .LVU680
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2377              		.loc 1 1210 14 is_stmt 0 view .LVU681
 2378 0082 0420     		movs	r0, #4
 2379              	.LVL209:
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2380              		.loc 1 1210 14 view .LVU682
 2381 0084 FFF7FEFF 		bl	LoRaMacCryptoDeriveMcKEKey
 2382              	.LVL210:
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2383              		.loc 1 1211 5 is_stmt 1 view .LVU683
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2384              		.loc 1 1211 7 is_stmt 0 view .LVU684
 2385 0088 30BB     		cbnz	r0, .L189
 2386              	.LBB8:
1250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 75


 2387              		.loc 1 1250 9 is_stmt 1 view .LVU685
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[1] << 8 );
 2388              		.loc 1 1252 9 view .LVU686
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[1] << 8 );
 2389              		.loc 1 1252 42 is_stmt 0 view .LVU687
 2390 008a 637A     		ldrb	r3, [r4, #9]	@ zero_extendqisi2
 2391              	.LVL211:
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
 2392              		.loc 1 1253 9 is_stmt 1 view .LVU688
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
 2393              		.loc 1 1253 45 is_stmt 0 view .LVU689
 2394 008c A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
 2395              		.loc 1 1253 15 view .LVU690
 2396 008e 43EA0223 		orr	r3, r3, r2, lsl #8
 2397              	.LVL212:
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2398              		.loc 1 1254 9 is_stmt 1 view .LVU691
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2399              		.loc 1 1254 45 is_stmt 0 view .LVU692
 2400 0092 E47A     		ldrb	r4, [r4, #11]	@ zero_extendqisi2
 2401              	.LVL213:
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2402              		.loc 1 1254 15 view .LVU693
 2403 0094 43EA0444 		orr	r4, r3, r4, lsl #16
 2404              	.LVL214:
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 2405              		.loc 1 1256 9 is_stmt 1 view .LVU694
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 2406              		.loc 1 1256 18 is_stmt 0 view .LVU695
 2407 0098 3346     		mov	r3, r6
 2408 009a 2246     		mov	r2, r4
 2409 009c 2946     		mov	r1, r5
 2410 009e 0320     		movs	r0, #3
 2411              	.LVL215:
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 2412              		.loc 1 1256 18 view .LVU696
 2413 00a0 FFF7FEFF 		bl	DeriveSessionKey10x
 2414              	.LVL216:
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2415              		.loc 1 1257 9 is_stmt 1 view .LVU697
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2416              		.loc 1 1257 11 is_stmt 0 view .LVU698
 2417 00a4 C0B9     		cbnz	r0, .L189
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 2418              		.loc 1 1278 9 is_stmt 1 view .LVU699
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 2419              		.loc 1 1278 18 is_stmt 0 view .LVU700
 2420 00a6 3346     		mov	r3, r6
 2421 00a8 2246     		mov	r2, r4
 2422 00aa 2946     		mov	r1, r5
 2423 00ac 0220     		movs	r0, #2
 2424              	.LVL217:
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 2425              		.loc 1 1278 18 view .LVU701
 2426 00ae FFF7FEFF 		bl	DeriveSessionKey10x
 2427              	.LVL218:
ARM GAS  /tmp/ccgjJaEg.s 			page 76


1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2428              		.loc 1 1281 9 is_stmt 1 view .LVU702
1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2429              		.loc 1 1281 11 is_stmt 0 view .LVU703
 2430 00b2 88B9     		cbnz	r0, .L189
 2431              	.LBE8:
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2432              		.loc 1 1289 5 is_stmt 1 view .LVU704
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2433              		.loc 1 1289 14 is_stmt 0 view .LVU705
 2434 00b4 0B4B     		ldr	r3, .L199
 2435 00b6 1B68     		ldr	r3, [r3]
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2436              		.loc 1 1289 42 view .LVU706
 2437 00b8 9DF81320 		ldrb	r2, [sp, #19]	@ zero_extendqisi2
 2438 00bc 9A70     		strb	r2, [r3, #2]
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
 2439              		.loc 1 1295 5 is_stmt 1 view .LVU707
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
 2440              		.loc 1 1295 32 is_stmt 0 view .LVU708
 2441 00be 0022     		movs	r2, #0
 2442 00c0 DA60     		str	r2, [r3, #12]
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
 2443              		.loc 1 1296 5 is_stmt 1 view .LVU709
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
 2444              		.loc 1 1296 34 is_stmt 0 view .LVU710
 2445 00c2 4FF0FF32 		mov	r2, #-1
 2446 00c6 9A61     		str	r2, [r3, #24]
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
 2447              		.loc 1 1297 5 is_stmt 1 view .LVU711
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
 2448              		.loc 1 1297 35 is_stmt 0 view .LVU712
 2449 00c8 1A61     		str	r2, [r3, #16]
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2450              		.loc 1 1298 5 is_stmt 1 view .LVU713
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2451              		.loc 1 1298 35 is_stmt 0 view .LVU714
 2452 00ca 5A61     		str	r2, [r3, #20]
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2453              		.loc 1 1300 5 is_stmt 1 view .LVU715
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2454              		.loc 1 1300 12 is_stmt 0 view .LVU716
 2455 00cc 04E0     		b	.L189
 2456              	.LVL219:
 2457              	.L190:
 2458              	.LCFI59:
 2459              		.cfi_def_cfa_offset 0
 2460              		.cfi_restore 4
 2461              		.cfi_restore 5
 2462              		.cfi_restore 6
 2463              		.cfi_restore 7
 2464              		.cfi_restore 14
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2465              		.loc 1 1135 16 view .LVU717
 2466 00ce 0A20     		movs	r0, #10
 2467              	.LVL220:
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  /tmp/ccgjJaEg.s 			page 77


 2468              		.loc 1 1301 1 view .LVU718
 2469 00d0 7047     		bx	lr
 2470              	.LVL221:
 2471              	.L191:
 2472              	.LCFI60:
 2473              		.cfi_def_cfa_offset 80
 2474              		.cfi_offset 4, -20
 2475              		.cfi_offset 5, -16
 2476              		.cfi_offset 6, -12
 2477              		.cfi_offset 7, -8
 2478              		.cfi_offset 14, -4
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2479              		.loc 1 1135 16 view .LVU719
 2480 00d2 0A20     		movs	r0, #10
 2481              	.LVL222:
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2482              		.loc 1 1135 16 view .LVU720
 2483 00d4 00E0     		b	.L189
 2484              	.LVL223:
 2485              	.L192:
1171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2486              		.loc 1 1171 16 view .LVU721
 2487 00d6 0F20     		movs	r0, #15
 2488              	.LVL224:
 2489              	.L189:
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2490              		.loc 1 1301 1 view .LVU722
 2491 00d8 0FB0     		add	sp, sp, #60
 2492              	.LCFI61:
 2493              		.cfi_remember_state
 2494              		.cfi_def_cfa_offset 20
 2495              		@ sp needed
 2496 00da F0BD     		pop	{r4, r5, r6, r7, pc}
 2497              	.LVL225:
 2498              	.L193:
 2499              	.LCFI62:
 2500              		.cfi_restore_state
1179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2501              		.loc 1 1179 16 view .LVU723
 2502 00dc 1020     		movs	r0, #16
 2503 00de FBE7     		b	.L189
 2504              	.LVL226:
 2505              	.L194:
1200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2506              		.loc 1 1200 16 view .LVU724
 2507 00e0 0320     		movs	r0, #3
 2508 00e2 F9E7     		b	.L189
 2509              	.L200:
 2510              		.align	2
 2511              	.L199:
 2512 00e4 00000000 		.word	.LANCHOR1
 2513              		.cfi_endproc
 2514              	.LFE121:
 2516              		.section	.text.LoRaMacCryptoDeriveMcSessionKeyPair,"ax",%progbits
 2517              		.align	1
 2518              		.global	LoRaMacCryptoDeriveMcSessionKeyPair
 2519              		.syntax unified
ARM GAS  /tmp/ccgjJaEg.s 			page 78


 2520              		.thumb
 2521              		.thumb_func
 2522              		.fpu softvfp
 2524              	LoRaMacCryptoDeriveMcSessionKeyPair:
 2525              	.LVL227:
 2526              	.LFB126:
1546:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1547:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoDeriveMcSessionKeyPair( AddressIdentifier_t addrID, uint32_t mcA
1548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 2527              		.loc 1 1548 1 is_stmt 1 view -0
 2528              		.cfi_startproc
 2529              		@ args = 0, pretend = 0, frame = 40
 2530              		@ frame_needed = 0, uses_anonymous_args = 0
1549:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( mcAddr == 0 )
 2531              		.loc 1 1549 5 view .LVU726
 2532              		.loc 1 1549 7 is_stmt 0 view .LVU727
 2533 0000 0029     		cmp	r1, #0
 2534 0002 3DD0     		beq	.L203
1548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( mcAddr == 0 )
 2535              		.loc 1 1548 1 view .LVU728
 2536 0004 10B5     		push	{r4, lr}
 2537              	.LCFI63:
 2538              		.cfi_def_cfa_offset 8
 2539              		.cfi_offset 4, -8
 2540              		.cfi_offset 14, -4
 2541 0006 8AB0     		sub	sp, sp, #40
 2542              	.LCFI64:
 2543              		.cfi_def_cfa_offset 48
 2544 0008 0C46     		mov	r4, r1
1550:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1552:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1553:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1554:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 2545              		.loc 1 1554 5 is_stmt 1 view .LVU729
 2546              	.LVL228:
1555:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1556:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Determine current security context
1557:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyAddr_t* curItem;
 2547              		.loc 1 1557 5 view .LVU730
1558:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = GetKeyAddrItem( addrID, &curItem );
 2548              		.loc 1 1558 5 view .LVU731
 2549              		.loc 1 1558 14 is_stmt 0 view .LVU732
 2550 000a 09A9     		add	r1, sp, #36
 2551              	.LVL229:
 2552              		.loc 1 1558 14 view .LVU733
 2553 000c FFF7FEFF 		bl	GetKeyAddrItem
 2554              	.LVL230:
1559:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2555              		.loc 1 1559 5 is_stmt 1 view .LVU734
 2556              		.loc 1 1559 7 is_stmt 0 view .LVU735
 2557 0010 08B1     		cbz	r0, .L210
 2558              	.LVL231:
 2559              	.L202:
1560:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1561:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1562:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  /tmp/ccgjJaEg.s 			page 79


1563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // McAppSKey = aes128_encrypt(McKey, 0x01 | McAddr | pad16)
1565:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // McNwkSKey = aes128_encrypt(McKey, 0x02 | McAddr | pad16)
1566:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseAppS[16] = { 0 };
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseNwkS[16] = { 0 };
1569:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[0] = 0x01;
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[1] = mcAddr & 0xFF;
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[2] = ( mcAddr >> 8 ) & 0xFF;
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[3] = ( mcAddr >> 16 ) & 0xFF;
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[4] = ( mcAddr >> 24 ) & 0xFF;
1575:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[0] = 0x02;
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[2] = ( mcAddr >> 8 ) & 0xFF;
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[3] = ( mcAddr >> 16 ) & 0xFF;
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[4] = ( mcAddr >> 24 ) & 0xFF;
1581:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBaseAppS, curItem->RootKey, curItem->AppSkey ) != SECUR
1583:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1585:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBaseNwkS, curItem->RootKey, curItem->NwkSkey ) != SECUR
1588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1593:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2560              		.loc 1 1593 1 view .LVU736
 2561 0012 0AB0     		add	sp, sp, #40
 2562              	.LCFI65:
 2563              		.cfi_remember_state
 2564              		.cfi_def_cfa_offset 8
 2565              		@ sp needed
 2566 0014 10BD     		pop	{r4, pc}
 2567              	.LVL232:
 2568              	.L210:
 2569              	.LCFI66:
 2570              		.cfi_restore_state
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseNwkS[16] = { 0 };
 2571              		.loc 1 1567 5 is_stmt 1 view .LVU737
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseNwkS[16] = { 0 };
 2572              		.loc 1 1567 13 is_stmt 0 view .LVU738
 2573 0016 0590     		str	r0, [sp, #20]
 2574 0018 0690     		str	r0, [sp, #24]
 2575 001a 0790     		str	r0, [sp, #28]
 2576 001c 0890     		str	r0, [sp, #32]
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2577              		.loc 1 1568 5 is_stmt 1 view .LVU739
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2578              		.loc 1 1568 13 is_stmt 0 view .LVU740
 2579 001e 0190     		str	r0, [sp, #4]
 2580 0020 0290     		str	r0, [sp, #8]
 2581 0022 0390     		str	r0, [sp, #12]
ARM GAS  /tmp/ccgjJaEg.s 			page 80


 2582 0024 0490     		str	r0, [sp, #16]
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[1] = mcAddr & 0xFF;
 2583              		.loc 1 1570 5 is_stmt 1 view .LVU741
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[1] = mcAddr & 0xFF;
 2584              		.loc 1 1570 21 is_stmt 0 view .LVU742
 2585 0026 0123     		movs	r3, #1
 2586 0028 8DF81430 		strb	r3, [sp, #20]
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[2] = ( mcAddr >> 8 ) & 0xFF;
 2587              		.loc 1 1571 5 is_stmt 1 view .LVU743
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[2] = ( mcAddr >> 8 ) & 0xFF;
 2588              		.loc 1 1571 21 is_stmt 0 view .LVU744
 2589 002c E1B2     		uxtb	r1, r4
 2590 002e 8DF81510 		strb	r1, [sp, #21]
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[3] = ( mcAddr >> 16 ) & 0xFF;
 2591              		.loc 1 1572 5 is_stmt 1 view .LVU745
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[3] = ( mcAddr >> 16 ) & 0xFF;
 2592              		.loc 1 1572 21 is_stmt 0 view .LVU746
 2593 0032 C4F30722 		ubfx	r2, r4, #8, #8
 2594 0036 8DF81620 		strb	r2, [sp, #22]
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[4] = ( mcAddr >> 24 ) & 0xFF;
 2595              		.loc 1 1573 5 is_stmt 1 view .LVU747
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[4] = ( mcAddr >> 24 ) & 0xFF;
 2596              		.loc 1 1573 21 is_stmt 0 view .LVU748
 2597 003a C4F30743 		ubfx	r3, r4, #16, #8
 2598 003e 8DF81730 		strb	r3, [sp, #23]
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2599              		.loc 1 1574 5 is_stmt 1 view .LVU749
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2600              		.loc 1 1574 21 is_stmt 0 view .LVU750
 2601 0042 240E     		lsrs	r4, r4, #24
 2602              	.LVL233:
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2603              		.loc 1 1574 21 view .LVU751
 2604 0044 8DF81840 		strb	r4, [sp, #24]
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
 2605              		.loc 1 1576 5 is_stmt 1 view .LVU752
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
 2606              		.loc 1 1576 21 is_stmt 0 view .LVU753
 2607 0048 0220     		movs	r0, #2
 2608              	.LVL234:
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
 2609              		.loc 1 1576 21 view .LVU754
 2610 004a 8DF80400 		strb	r0, [sp, #4]
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[2] = ( mcAddr >> 8 ) & 0xFF;
 2611              		.loc 1 1577 5 is_stmt 1 view .LVU755
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[2] = ( mcAddr >> 8 ) & 0xFF;
 2612              		.loc 1 1577 21 is_stmt 0 view .LVU756
 2613 004e 8DF80510 		strb	r1, [sp, #5]
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[3] = ( mcAddr >> 16 ) & 0xFF;
 2614              		.loc 1 1578 5 is_stmt 1 view .LVU757
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[3] = ( mcAddr >> 16 ) & 0xFF;
 2615              		.loc 1 1578 21 is_stmt 0 view .LVU758
 2616 0052 8DF80620 		strb	r2, [sp, #6]
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[4] = ( mcAddr >> 24 ) & 0xFF;
 2617              		.loc 1 1579 5 is_stmt 1 view .LVU759
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[4] = ( mcAddr >> 24 ) & 0xFF;
 2618              		.loc 1 1579 21 is_stmt 0 view .LVU760
ARM GAS  /tmp/ccgjJaEg.s 			page 81


 2619 0056 8DF80730 		strb	r3, [sp, #7]
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2620              		.loc 1 1580 5 is_stmt 1 view .LVU761
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2621              		.loc 1 1580 21 is_stmt 0 view .LVU762
 2622 005a 8DF80840 		strb	r4, [sp, #8]
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2623              		.loc 1 1582 5 is_stmt 1 view .LVU763
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2624              		.loc 1 1582 62 is_stmt 0 view .LVU764
 2625 005e 099B     		ldr	r3, [sp, #36]
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2626              		.loc 1 1582 9 view .LVU765
 2627 0060 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 2628 0062 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 2629 0064 05A8     		add	r0, sp, #20
 2630 0066 FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2631              	.LVL235:
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2632              		.loc 1 1582 7 view .LVU766
 2633 006a 58B9     		cbnz	r0, .L204
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2634              		.loc 1 1587 5 is_stmt 1 view .LVU767
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2635              		.loc 1 1587 62 is_stmt 0 view .LVU768
 2636 006c 099B     		ldr	r3, [sp, #36]
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2637              		.loc 1 1587 9 view .LVU769
 2638 006e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 2639 0070 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 2640 0072 01A8     		add	r0, sp, #4
 2641 0074 FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2642              	.LVL236:
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2643              		.loc 1 1587 7 view .LVU770
 2644 0078 0028     		cmp	r0, #0
 2645 007a CAD0     		beq	.L202
1589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2646              		.loc 1 1589 16 view .LVU771
 2647 007c 0F20     		movs	r0, #15
 2648 007e C8E7     		b	.L202
 2649              	.LVL237:
 2650              	.L203:
 2651              	.LCFI67:
 2652              		.cfi_def_cfa_offset 0
 2653              		.cfi_restore 4
 2654              		.cfi_restore 14
1551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2655              		.loc 1 1551 16 view .LVU772
 2656 0080 0A20     		movs	r0, #10
 2657              	.LVL238:
 2658              		.loc 1 1593 1 view .LVU773
 2659 0082 7047     		bx	lr
 2660              	.LVL239:
 2661              	.L204:
 2662              	.LCFI68:
 2663              		.cfi_def_cfa_offset 48
ARM GAS  /tmp/ccgjJaEg.s 			page 82


 2664              		.cfi_offset 4, -8
 2665              		.cfi_offset 14, -4
1584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2666              		.loc 1 1584 16 view .LVU774
 2667 0084 0F20     		movs	r0, #15
 2668 0086 C4E7     		b	.L202
 2669              		.cfi_endproc
 2670              	.LFE126:
 2672              		.section	.bss.CryptoNvm,"aw",%nobits
 2673              		.align	2
 2674              		.set	.LANCHOR1,. + 0
 2677              	CryptoNvm:
 2678 0000 00000000 		.space	4
 2679              		.section	.data.KeyAddrList,"aw"
 2680              		.align	2
 2681              		.set	.LANCHOR0,. + 0
 2684              	KeyAddrList:
 2685 0000 00       		.byte	0
 2686 0001 81       		.byte	-127
 2687 0002 82       		.byte	-126
 2688 0003 80       		.byte	-128
 2689 0004 01       		.byte	1
 2690 0005 03       		.byte	3
 2691 0006 02       		.byte	2
 2692 0007 84       		.byte	-124
 2693              		.text
 2694              	.Letext0:
 2695              		.file 2 "/home/eatkinso/Downloads/gcc-arm-none-eabi-10.3-2021.07/gcc-arm-none-eabi-10.3-2021.07/ar
 2696              		.file 3 "/home/eatkinso/Downloads/gcc-arm-none-eabi-10.3-2021.07/gcc-arm-none-eabi-10.3-2021.07/ar
 2697              		.file 4 "Middlewares/Third_Party/LoRaWAN/Utilities/utilities.h"
 2698              		.file 5 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacTypes.h"
 2699              		.file 6 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacHeaderTypes.h"
 2700              		.file 7 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacMessageTypes.h"
 2701              		.file 8 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCryptoNvm.h"
 2702              		.file 9 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.h"
 2703              		.file 10 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element.h"
 2704              		.file 11 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacParser.h"
 2705              		.file 12 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacSerializer.h"
 2706              		.file 13 "<built-in>"
ARM GAS  /tmp/ccgjJaEg.s 			page 83


DEFINED SYMBOLS
                            *ABS*:0000000000000000 LoRaMacCrypto.c
     /tmp/ccgjJaEg.s:16     .text.PrepareB0:0000000000000000 $t
     /tmp/ccgjJaEg.s:23     .text.PrepareB0:0000000000000000 PrepareB0
     /tmp/ccgjJaEg.s:137    .text.GetKeyAddrItem:0000000000000000 $t
     /tmp/ccgjJaEg.s:143    .text.GetKeyAddrItem:0000000000000000 GetKeyAddrItem
     /tmp/ccgjJaEg.s:206    .text.GetKeyAddrItem:0000000000000028 $d
     /tmp/ccgjJaEg.s:211    .text.GetLastFcntDown:0000000000000000 $t
     /tmp/ccgjJaEg.s:217    .text.GetLastFcntDown:0000000000000000 GetLastFcntDown
     /tmp/ccgjJaEg.s:238    .text.GetLastFcntDown:0000000000000010 $d
     /tmp/ccgjJaEg.s:242    .text.GetLastFcntDown:0000000000000014 $t
     /tmp/ccgjJaEg.s:338    .text.GetLastFcntDown:0000000000000058 $d
     /tmp/ccgjJaEg.s:343    .text.CheckFCntDown:0000000000000000 $t
     /tmp/ccgjJaEg.s:349    .text.CheckFCntDown:0000000000000000 CheckFCntDown
     /tmp/ccgjJaEg.s:417    .text.UpdateFCntDown:0000000000000000 $t
     /tmp/ccgjJaEg.s:423    .text.UpdateFCntDown:0000000000000000 UpdateFCntDown
     /tmp/ccgjJaEg.s:439    .text.UpdateFCntDown:000000000000000a $d
     /tmp/ccgjJaEg.s:443    .text.UpdateFCntDown:000000000000000e $t
     /tmp/ccgjJaEg.s:485    .text.UpdateFCntDown:0000000000000030 $d
     /tmp/ccgjJaEg.s:490    .text.ResetFCnts:0000000000000000 $t
     /tmp/ccgjJaEg.s:496    .text.ResetFCnts:0000000000000000 ResetFCnts
     /tmp/ccgjJaEg.s:552    .text.ResetFCnts:000000000000002c $d
     /tmp/ccgjJaEg.s:558    .text.ComputeCmacB0:0000000000000000 $t
     /tmp/ccgjJaEg.s:564    .text.ComputeCmacB0:0000000000000000 ComputeCmacB0
     /tmp/ccgjJaEg.s:671    .text.DeriveSessionKey10x:0000000000000000 $t
     /tmp/ccgjJaEg.s:677    .text.DeriveSessionKey10x:0000000000000000 DeriveSessionKey10x
     /tmp/ccgjJaEg.s:792    .text.PayloadEncrypt:0000000000000000 $t
     /tmp/ccgjJaEg.s:798    .text.PayloadEncrypt:0000000000000000 PayloadEncrypt
     /tmp/ccgjJaEg.s:994    .text.VerifyCmacB0:0000000000000000 $t
     /tmp/ccgjJaEg.s:1000   .text.VerifyCmacB0:0000000000000000 VerifyCmacB0
     /tmp/ccgjJaEg.s:1125   .text.LoRaMacCryptoInit:0000000000000000 $t
     /tmp/ccgjJaEg.s:1132   .text.LoRaMacCryptoInit:0000000000000000 LoRaMacCryptoInit
     /tmp/ccgjJaEg.s:1195   .text.LoRaMacCryptoInit:000000000000002c $d
     /tmp/ccgjJaEg.s:1200   .text.LoRaMacCryptoSetLrWanVersion:0000000000000000 $t
     /tmp/ccgjJaEg.s:1207   .text.LoRaMacCryptoSetLrWanVersion:0000000000000000 LoRaMacCryptoSetLrWanVersion
     /tmp/ccgjJaEg.s:1230   .text.LoRaMacCryptoSetLrWanVersion:000000000000000c $d
     /tmp/ccgjJaEg.s:1235   .text.LoRaMacCryptoGetFCntUp:0000000000000000 $t
     /tmp/ccgjJaEg.s:1242   .text.LoRaMacCryptoGetFCntUp:0000000000000000 LoRaMacCryptoGetFCntUp
     /tmp/ccgjJaEg.s:1279   .text.LoRaMacCryptoGetFCntUp:0000000000000014 $d
     /tmp/ccgjJaEg.s:1284   .text.LoRaMacCryptoGetFCntDown:0000000000000000 $t
     /tmp/ccgjJaEg.s:1291   .text.LoRaMacCryptoGetFCntDown:0000000000000000 LoRaMacCryptoGetFCntDown
     /tmp/ccgjJaEg.s:1438   .text.LoRaMacCryptoGetFCntDown:0000000000000070 $d
     /tmp/ccgjJaEg.s:1443   .text.LoRaMacCryptoSetMulticastReference:0000000000000000 $t
     /tmp/ccgjJaEg.s:1450   .text.LoRaMacCryptoSetMulticastReference:0000000000000000 LoRaMacCryptoSetMulticastReference
     /tmp/ccgjJaEg.s:1506   .text.LoRaMacCryptoSetMulticastReference:000000000000002c $d
     /tmp/ccgjJaEg.s:1512   .text.LoRaMacCryptoPrepareJoinRequest:0000000000000000 $t
     /tmp/ccgjJaEg.s:1519   .text.LoRaMacCryptoPrepareJoinRequest:0000000000000000 LoRaMacCryptoPrepareJoinRequest
     /tmp/ccgjJaEg.s:1626   .text.LoRaMacCryptoPrepareJoinRequest:0000000000000054 $d
     /tmp/ccgjJaEg.s:1631   .text.LoRaMacCryptoSecureMessage:0000000000000000 $t
     /tmp/ccgjJaEg.s:1638   .text.LoRaMacCryptoSecureMessage:0000000000000000 LoRaMacCryptoSecureMessage
     /tmp/ccgjJaEg.s:1805   .text.LoRaMacCryptoSecureMessage:0000000000000084 $d
     /tmp/ccgjJaEg.s:1810   .text.LoRaMacCryptoUnsecureMessage:0000000000000000 $t
     /tmp/ccgjJaEg.s:1817   .text.LoRaMacCryptoUnsecureMessage:0000000000000000 LoRaMacCryptoUnsecureMessage
     /tmp/ccgjJaEg.s:2008   .text.LoRaMacCryptoUnsecureMessage:00000000000000b8 $d
     /tmp/ccgjJaEg.s:2013   .text.LoRaMacCryptoDeriveMcRootKey:0000000000000000 $t
     /tmp/ccgjJaEg.s:2020   .text.LoRaMacCryptoDeriveMcRootKey:0000000000000000 LoRaMacCryptoDeriveMcRootKey
     /tmp/ccgjJaEg.s:2102   .text.LoRaMacCryptoDeriveMcKEKey:0000000000000000 $t
ARM GAS  /tmp/ccgjJaEg.s 			page 84


     /tmp/ccgjJaEg.s:2109   .text.LoRaMacCryptoDeriveMcKEKey:0000000000000000 LoRaMacCryptoDeriveMcKEKey
     /tmp/ccgjJaEg.s:2171   .text.LoRaMacCryptoSetKey:0000000000000000 $t
     /tmp/ccgjJaEg.s:2178   .text.LoRaMacCryptoSetKey:0000000000000000 LoRaMacCryptoSetKey
     /tmp/ccgjJaEg.s:2238   .text.LoRaMacCryptoSetKey:0000000000000034 $d
     /tmp/ccgjJaEg.s:2243   .text.LoRaMacCryptoHandleJoinAccept:0000000000000000 $t
     /tmp/ccgjJaEg.s:2250   .text.LoRaMacCryptoHandleJoinAccept:0000000000000000 LoRaMacCryptoHandleJoinAccept
     /tmp/ccgjJaEg.s:2512   .text.LoRaMacCryptoHandleJoinAccept:00000000000000e4 $d
     /tmp/ccgjJaEg.s:2517   .text.LoRaMacCryptoDeriveMcSessionKeyPair:0000000000000000 $t
     /tmp/ccgjJaEg.s:2524   .text.LoRaMacCryptoDeriveMcSessionKeyPair:0000000000000000 LoRaMacCryptoDeriveMcSessionKeyPair
     /tmp/ccgjJaEg.s:2673   .bss.CryptoNvm:0000000000000000 $d
     /tmp/ccgjJaEg.s:2677   .bss.CryptoNvm:0000000000000000 CryptoNvm
     /tmp/ccgjJaEg.s:2680   .data.KeyAddrList:0000000000000000 $d
     /tmp/ccgjJaEg.s:2684   .data.KeyAddrList:0000000000000000 KeyAddrList

UNDEFINED SYMBOLS
SecureElementComputeAesCmac
SecureElementDeriveAndStoreKey
SecureElementAesEncrypt
memset1
memcpy1
SecureElementVerifyAesCmac
SecureElementRandomNumber
LoRaMacSerializerJoinRequest
LoRaMacSerializerData
LoRaMacParserData
SecureElementSetKey
memset
SecureElementProcessJoinAccept
LoRaMacParserJoinAccept
