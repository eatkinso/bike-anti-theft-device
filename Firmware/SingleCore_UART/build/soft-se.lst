ARM GAS  /tmp/ccIGV0Yw.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"soft-se.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.GetKeyByID,"ax",%progbits
  16              		.align	1
  17              		.arch armv7e-m
  18              		.syntax unified
  19              		.thumb
  20              		.thumb_func
  21              		.fpu softvfp
  23              	GetKeyByID:
  24              	.LVL0:
  25              	.LFB104:
  26              		.file 1 "Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c"
   1:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
   2:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \file      soft-se.c
   3:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
   4:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \brief     Secure Element software implementation
   5:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
   6:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \copyright Revised BSD License, see section \ref LICENSE.
   7:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
   8:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \code
   9:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *                ______                              _
  10:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               / _____)             _              | |
  11:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              ( (____  _____ ____ _| |_ _____  ____| |__
  12:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               \____ \| ___ |    (_   _) ___ |/ ___)  _ \
  13:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               _____) ) ____| | | || |_| ____( (___| | | |
  14:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              (______/|_____)_|_|_| \__)_____)\____)_| |_|
  15:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              (C)2020 Semtech
  16:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
  17:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               ___ _____ _   ___ _  _____ ___  ___  ___ ___
  18:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              / __|_   _/_\ / __| |/ / __/ _ \| _ \/ __| __|
  19:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              \__ \ | |/ _ \ (__| ' <| _| (_) |   / (__| _|
  20:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              |___/ |_/_/ \_\___|_|\_\_| \___/|_|_\\___|___|
  21:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              embedded.connectivity.solutions===============
  22:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
  23:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \endcode
  24:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
  25:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  26:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  27:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /**
  28:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   ******************************************************************************
  29:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   *
  30:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   *          Portions COPYRIGHT 2020 STMicroelectronics
  31:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   *
  32:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   * @file    soft-se.c
ARM GAS  /tmp/ccIGV0Yw.s 			page 2


  33:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   * @author  MCD Application Team
  34:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   * @brief   Secure Element software implementation
  35:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   ******************************************************************************
  36:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   */
  37:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  38:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Includes ------------------------------------------------------------------*/
  39:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include <stdlib.h>
  40:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include <stdint.h>
  41:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  42:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "lorawan_conf.h"  /* LORAWAN_KMS */
  43:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "radio.h"         /* needed for Random */
  44:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "utilities.h"
  45:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "mw_log_conf.h"   /* needed for MW_LOG */
  46:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
  47:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "lorawan_aes.h"
  48:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "cmac.h"
  49:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
  50:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "kms_if.h"
  51:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
  52:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  53:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "LoRaMacHeaderTypes.h"
  54:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  55:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "secure-element.h"
  56:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "secure-element-nvm.h"
  57:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "se-identity.h"
  58:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  59:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private constants ---------------------------------------------------------*/
  60:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  61:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * MIC computation offset
  62:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \remark required for 1.1.x support
  63:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  64:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define CRYPTO_MIC_COMPUTATION_OFFSET ( JOIN_REQ_TYPE_SIZE\
  65:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                         + LORAMAC_JOIN_EUI_FIELD_SIZE + DEV_NONCE_SIZE + LORAMAC_MH
  66:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  67:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
  68:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
  69:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define DERIVED_OBJECT_HANDLE_RESET_VAL      0x0UL
  70:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define PAYLOAD_MAX_SIZE     270UL  /* 270 PHYPayload: 1+(22+1+242)+4 */
  71:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
  72:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  73:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private macro -------------------------------------------------------------*/
  74:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  75:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Hex 8 split buffer
  76:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  77:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define HEX8(X)   X[0], X[1], X[2], X[3], X[4], X[5], X[6], X[7]
  78:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  79:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  80:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Hex 16 split buffer
  81:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  82:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define HEX16(X)  HEX8(X), X[8], X[9], X[10], X[11], X[12], X[13], X[14], X[15]
  83:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  84:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private Types ---------------------------------------------------------*/
  85:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private variables ---------------------------------------------------------*/
  86:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  87:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Secure element context
  88:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  89:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementNvmData_t* SeNvm;
ARM GAS  /tmp/ccIGV0Yw.s 			page 3


  90:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  91:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
  92:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
  93:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* WARNING: Should be modified at the end of product development */
  94:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static const CK_ULONG GlobalTemplateLabel = 0x444E524CU;
  95:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  96:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
  97:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Intermediate buffer used for two reasons:
  98:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * - align to 32 bits and
  99:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * - for Cmac combine InitVector + input buff
 100:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 101:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static uint8_t input_align_combined_buf[PAYLOAD_MAX_SIZE + SE_KEY_SIZE] ALIGN(4);
 102:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 103:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static uint8_t output_align[PAYLOAD_MAX_SIZE] ALIGN(4);
 104:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 105:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static uint8_t tag[SE_KEY_SIZE] ALIGN(4) = {0};
 106:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 107:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 108:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private functions prototypes ---------------------------------------------------*/
 109:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 110:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyByID( KeyIdentifier_t keyID, Key_t **keyItem );
 111:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 112:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyIndexByID( KeyIdentifier_t keyID, CK_OBJECT_HANDLE *keyIndex );
 113:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 114:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetSpecificLabelByID( KeyIdentifier_t keyID, uint32_t *specificLabel )
 115:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 116:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t DeleteAllDynamicKeys( void );
 117:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 118:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 119:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 120:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static void PrintKey( KeyIdentifier_t key );
 121:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 122:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 123:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t ComputeCmac(uint8_t *micBxBuffer, uint8_t *buffer, uint16_t size, KeyI
 124:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                          uint32_t *cmac);
 125:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 126:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 127:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private functions ---------------------------------------------------------*/
 128:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 129:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static void PrintKey( KeyIdentifier_t key )
 130:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 131:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 132:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t *keyItem;
 133:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementGetKeyByID(key, &keyItem);
 134:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval == SECURE_ELEMENT_SUCCESS)
 135:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 136:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (key == APP_KEY)
 137:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### AppKey:      ");
 139:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 140:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == NWK_KEY)
 141:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### NwkKey:      ");
 143:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == APP_S_KEY)
 145:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### AppSKey:     ");
ARM GAS  /tmp/ccIGV0Yw.s 			page 4


 147:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 148:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == NWK_S_KEY)
 149:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### NwkSKey:     ");
 151:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 152:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_ROOT_KEY)
 153:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCRootKey:   ");
 155:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 156:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_KE_KEY)
 157:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCKEKey:     ");
 159:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 160:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_KEY_0)
 161:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCKey_0:     ");
 163:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 164:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_APP_S_KEY_0)
 165:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCAppSKey_0: ");
 167:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 168:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_NWK_S_KEY_0)
 169:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCNwkSKey_0: ");
 171:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         MW_LOG(TS_OFF, VLEVEL_M, "%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:
 173:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                HEX16(keyItem->KeyValue));
 174:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 175:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 176:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 177:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 178:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 179:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 180:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Gets key item from key list.
 181:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 182:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  keyID          - Key identifier
 183:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[OUT] keyItem        - Key item reference
 184:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \retval                    - Status of the operation
 185:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 186:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyByID( KeyIdentifier_t keyID, Key_t** keyItem )
 187:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
  27              		.loc 1 187 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for( uint8_t i = 0; i < NUM_OF_KEYS; i++ )
  32              		.loc 1 188 5 view .LVU1
  33              	.LBB2:
  34              		.loc 1 188 10 view .LVU2
  35              		.loc 1 188 18 is_stmt 0 view .LVU3
  36 0000 0023     		movs	r3, #0
  37              	.LVL1:
  38              		.loc 1 188 25 is_stmt 1 view .LVU4
  39              		.loc 1 188 5 is_stmt 0 view .LVU5
  40 0002 092B     		cmp	r3, #9
  41 0004 17D8     		bhi	.L11
ARM GAS  /tmp/ccIGV0Yw.s 			page 5


  42              	.LBE2:
 187:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for( uint8_t i = 0; i < NUM_OF_KEYS; i++ )
  43              		.loc 1 187 1 view .LVU6
  44 0006 10B4     		push	{r4}
  45              	.LCFI0:
  46              		.cfi_def_cfa_offset 4
  47              		.cfi_offset 4, -4
  48              	.L5:
  49              	.LBB3:
 189:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 190:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SeNvm->KeyList[i].KeyID == keyID )
  50              		.loc 1 190 9 is_stmt 1 view .LVU7
  51              		.loc 1 190 18 is_stmt 0 view .LVU8
  52 0008 0C4A     		ldr	r2, .L13
  53 000a 1468     		ldr	r4, [r2]
  54              		.loc 1 190 30 view .LVU9
  55 000c 03EB0312 		add	r2, r3, r3, lsl #4
  56 0010 2244     		add	r2, r2, r4
  57 0012 127C     		ldrb	r2, [r2, #16]	@ zero_extendqisi2
  58              		.loc 1 190 11 view .LVU10
  59 0014 8242     		cmp	r2, r0
  60 0016 06D0     		beq	.L12
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  61              		.loc 1 188 42 is_stmt 1 discriminator 2 view .LVU11
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  62              		.loc 1 188 43 is_stmt 0 discriminator 2 view .LVU12
  63 0018 0133     		adds	r3, r3, #1
  64              	.LVL2:
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  65              		.loc 1 188 43 discriminator 2 view .LVU13
  66 001a DBB2     		uxtb	r3, r3
  67              	.LVL3:
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  68              		.loc 1 188 25 is_stmt 1 discriminator 2 view .LVU14
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  69              		.loc 1 188 5 is_stmt 0 discriminator 2 view .LVU15
  70 001c 092B     		cmp	r3, #9
  71 001e F3D9     		bls	.L5
  72              	.LBE3:
 191:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *keyItem = &( SeNvm->KeyList[i] );
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 194:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 195:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 196:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
  73              		.loc 1 196 12 view .LVU16
  74 0020 0320     		movs	r0, #3
  75              	.LVL4:
  76              	.L4:
 197:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
  77              		.loc 1 197 1 view .LVU17
  78 0022 10BC     		pop	{r4}
  79              	.LCFI1:
  80              		.cfi_remember_state
  81              		.cfi_restore 4
  82              		.cfi_def_cfa_offset 0
  83 0024 7047     		bx	lr
ARM GAS  /tmp/ccIGV0Yw.s 			page 6


  84              	.LVL5:
  85              	.L12:
  86              	.LCFI2:
  87              		.cfi_restore_state
  88              	.LBB4:
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
  89              		.loc 1 192 13 is_stmt 1 view .LVU18
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
  90              		.loc 1 192 24 is_stmt 0 view .LVU19
  91 0026 03EB031C 		add	ip, r3, r3, lsl #4
  92 002a 0CF1100C 		add	ip, ip, #16
  93 002e 6444     		add	r4, r4, ip
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
  94              		.loc 1 192 22 view .LVU20
  95 0030 0C60     		str	r4, [r1]
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
  96              		.loc 1 193 13 is_stmt 1 view .LVU21
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
  97              		.loc 1 193 20 is_stmt 0 view .LVU22
  98 0032 0020     		movs	r0, #0
  99              	.LVL6:
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 100              		.loc 1 193 20 view .LVU23
 101 0034 F5E7     		b	.L4
 102              	.LVL7:
 103              	.L11:
 104              	.LCFI3:
 105              		.cfi_def_cfa_offset 0
 106              		.cfi_restore 4
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 107              		.loc 1 193 20 view .LVU24
 108              	.LBE4:
 196:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 109              		.loc 1 196 12 view .LVU25
 110 0036 0320     		movs	r0, #3
 111              	.LVL8:
 112              		.loc 1 197 1 view .LVU26
 113 0038 7047     		bx	lr
 114              	.L14:
 115 003a 00BF     		.align	2
 116              	.L13:
 117 003c 00000000 		.word	.LANCHOR0
 118              		.cfi_endproc
 119              	.LFE104:
 121              		.section	.text.ComputeCmac,"ax",%progbits
 122              		.align	1
 123              		.syntax unified
 124              		.thumb
 125              		.thumb_func
 126              		.fpu softvfp
 128              	ComputeCmac:
 129              	.LVL9:
 130              	.LFB105:
 198:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 199:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 200:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 201:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
ARM GAS  /tmp/ccIGV0Yw.s 			page 7


 202:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Gets key Index from key list in KMS table
 203:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 204:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]    keyID                    - Key identifier
 205:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[OUT] keyIndex             - Key item reference
 206:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \retval                                        - Status of the operation
 207:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 208:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyIndexByID( KeyIdentifier_t keyID, CK_OBJECT_HANDLE *keyIndex )
 209:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 210:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (uint8_t i = 0; i < NUM_OF_KEYS; i++)
 211:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 212:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[i].KeyID == keyID)
 213:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 214:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *keyIndex = SeNvm->KeyList[i].Object_Index;
 215:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 216:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 217:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 218:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 219:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 220:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 221:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetSpecificLabelByID( KeyIdentifier_t keyID, uint32_t *specificLabel )
 222:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 223:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_SUCCESS;
 224:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     switch (keyID)
 225:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 226:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case APP_KEY:
 227:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x5F505041U;
 228:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 229:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case NWK_KEY:
 230:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x5F4B574EU;
 231:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 232:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 233:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case J_S_INT_KEY:
 234:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x314B574EU;
 235:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 236:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case J_S_ENC_KEY:
 237:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x324B574EU;
 238:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 239:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case F_NWK_S_INT_KEY:
 240:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x334B574EU;
 241:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 242:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case S_NWK_S_INT_KEY:
 243:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x344B574EU;
 244:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 245:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case NWK_S_ENC_KEY:
 246:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x354B574EU;
 247:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 248:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 249:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case NWK_S_KEY:
 250:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x534B574EU;
 251:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 252:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 253:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case APP_S_KEY:
 254:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x53505041U;
 255:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 256:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_ROOT_KEY:
 257:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x5452434DU;
 258:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
ARM GAS  /tmp/ccIGV0Yw.s 			page 8


 259:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KE_KEY:
 260:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x454B434DU;
 261:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 262:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_0:
 263:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x304B434DU;
 264:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 265:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_0:
 266:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3053414DU;
 267:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 268:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_0:
 269:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x30534E4DU;
 270:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 271:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 272:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_1:
 273:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x314B434DU;
 274:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 275:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_1:
 276:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3153414DU;
 277:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 278:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_1:
 279:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x31534E4DU;
 280:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 281:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_2:
 282:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x324B434DU;
 283:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 284:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_2:
 285:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3253414DU;
 286:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 287:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_2:
 288:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x32534E4DU;
 289:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 290:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_3:
 291:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x334B434DU;
 292:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 293:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_3:
 294:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3353414DU;
 295:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 296:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_3:
 297:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x33534E4DU;
 298:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 299:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 300:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         default:
 301:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             retval = SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 302:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 303:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 304:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 305:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 306:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 307:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t DeleteAllDynamicKeys( void )
 308:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 309:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 310:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 311:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;  /* Read ONLY session */
 312:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE hObject[NUM_OF_KEYS];
 313:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t ulCount = 0;
 314:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 315:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
ARM GAS  /tmp/ccIGV0Yw.s 			page 9


 316:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,  session_flags, NULL, 0, &session);
 317:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 318:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Get all keys handle */
 319:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 320:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 321:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsInit(session, NULL, 0);
 322:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 323:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 324:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Find all existing keys handle */
 325:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 326:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 327:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjects(session, hObject, NUM_OF_KEYS, (CK_ULONG *) &ulCount);
 328:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 329:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 330:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 331:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 332:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsFinal(session);
 333:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 334:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 335:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (ulCount <= NUM_OF_KEYS)
 336:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 337:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         for (uint8_t i = 0; i < ulCount; i++)
 338:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 339:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             /* Exclude all Embedded keys */
 340:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if (hObject[i] > LAST_KMS_KEY_OBJECT_HANDLE)
 341:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {
 342:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 if (rv == CKR_OK)
 343:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 {
 344:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                     rv = C_DestroyObject(session, hObject[i]);
 345:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 }
 346:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 347:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 348:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 349:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 350:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 351:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (session > 0)
 352:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 353:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         (void)C_CloseSession(session);
 354:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 355:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 356:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 357:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 358:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 359:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 360:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 361:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 362:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 363:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 364:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 365:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Computes a CMAC of a message using provided initial Bx block
 366:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 367:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *  cmac = aes128_cmac(keyID, blocks[i].Buffer)
 368:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 369:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  micBxBuffer    - Buffer containing the initial Bx block
 370:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  buffer         - Data buffer
 371:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  size           - Data buffer size
 372:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  keyID          - Key identifier to determine the AES key to be used
ARM GAS  /tmp/ccIGV0Yw.s 			page 10


 373:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[OUT] cmac           - Computed cmac
 374:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \retval                    - Status of the operation
 375:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 376:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t ComputeCmac( uint8_t* micBxBuffer, uint8_t* buffer, uint16_t size, Key
 377:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                           uint32_t* cmac )
 378:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 131              		.loc 1 378 1 is_stmt 1 view -0
 132              		.cfi_startproc
 133              		@ args = 4, pretend = 0, frame = 304
 134              		@ frame_needed = 0, uses_anonymous_args = 0
 135              		.loc 1 378 1 is_stmt 0 view .LVU28
 136 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 137              	.LCFI4:
 138              		.cfi_def_cfa_offset 24
 139              		.cfi_offset 4, -24
 140              		.cfi_offset 5, -20
 141              		.cfi_offset 6, -16
 142              		.cfi_offset 7, -12
 143              		.cfi_offset 8, -8
 144              		.cfi_offset 14, -4
 145 0004 CCB0     		sub	sp, sp, #304
 146              	.LCFI5:
 147              		.cfi_def_cfa_offset 328
 148 0006 529E     		ldr	r6, [sp, #328]
 379:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( buffer == NULL ) || ( cmac == NULL ) )
 149              		.loc 1 379 5 is_stmt 1 view .LVU29
 150              		.loc 1 379 7 is_stmt 0 view .LVU30
 151 0008 A9B3     		cbz	r1, .L18
 152 000a 0546     		mov	r5, r0
 153 000c 1746     		mov	r7, r2
 154 000e 1C46     		mov	r4, r3
 155 0010 8846     		mov	r8, r1
 156              		.loc 1 379 28 discriminator 1 view .LVU31
 157 0012 96B3     		cbz	r6, .L19
 380:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 381:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 382:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 383:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 384:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 385:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t Cmac[16];
 158              		.loc 1 385 5 is_stmt 1 view .LVU32
 386:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     AES_CMAC_CTX aesCmacCtx[1];
 159              		.loc 1 386 5 view .LVU33
 387:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 388:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     AES_CMAC_Init( aesCmacCtx );
 160              		.loc 1 388 5 view .LVU34
 161 0014 02A8     		add	r0, sp, #8
 162              	.LVL10:
 163              		.loc 1 388 5 is_stmt 0 view .LVU35
 164 0016 FFF7FEFF 		bl	AES_CMAC_Init
 165              	.LVL11:
 389:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 390:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t*                keyItem;
 166              		.loc 1 390 5 is_stmt 1 view .LVU36
 391:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyByID( keyID, &keyItem );
 167              		.loc 1 391 5 view .LVU37
 168              		.loc 1 391 36 is_stmt 0 view .LVU38
ARM GAS  /tmp/ccIGV0Yw.s 			page 11


 169 001a 01A9     		add	r1, sp, #4
 170 001c 2046     		mov	r0, r4
 171 001e FFF7FEFF 		bl	GetKeyByID
 172              	.LVL12:
 392:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 393:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval == SECURE_ELEMENT_SUCCESS )
 173              		.loc 1 393 5 is_stmt 1 view .LVU39
 174              		.loc 1 393 7 is_stmt 0 view .LVU40
 175 0022 0446     		mov	r4, r0
 176 0024 18B1     		cbz	r0, .L21
 177              	.LVL13:
 178              	.L16:
 394:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         AES_CMAC_SetKey( aesCmacCtx, keyItem->KeyValue );
 396:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 397:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( micBxBuffer != NULL )
 398:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 399:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             AES_CMAC_Update( aesCmacCtx, micBxBuffer, 16 );
 400:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 401:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 402:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         AES_CMAC_Update( aesCmacCtx, buffer, size );
 403:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 404:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         AES_CMAC_Final( Cmac, aesCmacCtx );
 405:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 406:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Bring into the required format
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *cmac = ( uint32_t )( ( uint32_t ) Cmac[3] << 24 | ( uint32_t ) Cmac[2] << 16 | ( uint32_t 
 408:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 409:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 410:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 411:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 412:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 413:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 414:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t tag_lenth = 0;
 415:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE key_handle ;
 416:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 417:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* AES CMAC Authentication variables */
 418:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM aes_cmac_mechanism = { CKM_AES_CMAC, (CK_VOID_PTR)NULL, 0 };
 419:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 420:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyIndexByID(keyID, &key_handle);
 421:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval != SECURE_ELEMENT_SUCCESS)
 422:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 423:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
 424:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 425:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 426:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 427:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
 428:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 429:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Configure session to Authentication message in AES CMAC with settings included into the mech
 430:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 431:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 432:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_SignInit(session, &aes_cmac_mechanism, key_handle);
 433:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 434:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 435:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Encrypt clear message */
 436:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 437:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 438:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /* work around : need to double-check if possible to use micBxBuffer as IV for Sign */
ARM GAS  /tmp/ccIGV0Yw.s 			page 12


 439:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (micBxBuffer != NULL)
 440:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 441:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             memcpy1((uint8_t *) &input_align_combined_buf[0], (uint8_t *) micBxBuffer, SE_KEY_SIZE)
 442:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             memcpy1((uint8_t *) &input_align_combined_buf[SE_KEY_SIZE], (uint8_t *) buffer, size);
 443:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 444:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else
 445:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 446:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             memcpy1((uint8_t *) &input_align_combined_buf[0], (uint8_t *) buffer, size);
 447:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 448:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 449:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 450:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 451:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 452:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (micBxBuffer != NULL)
 453:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 454:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             rv = C_Sign(session, (CK_BYTE_PTR)&input_align_combined_buf[0], size + SE_KEY_SIZE, &ta
 455:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                         (CK_ULONG_PTR)&tag_lenth);
 456:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 457:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else
 458:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 459:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             rv = C_Sign(session, (CK_BYTE_PTR)&input_align_combined_buf[0], size, &tag[0],
 460:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                         (CK_ULONG_PTR)&tag_lenth);
 461:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 462:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 463:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 464:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close session with KMS */
 465:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 466:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 467:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* combine to a 32bit authentication word (MIC) */
 468:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *cmac = (uint32_t)((uint32_t) tag[3] << 24 | (uint32_t) tag[2] << 16 | (uint32_t) tag[1] << 8 |
 469:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                        (uint32_t) tag[0]);
 470:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 471:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 472:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 473:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
 474:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 475:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 476:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 477:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 179              		.loc 1 477 1 view .LVU41
 180 0026 2046     		mov	r0, r4
 181 0028 4CB0     		add	sp, sp, #304
 182              	.LCFI6:
 183              		.cfi_remember_state
 184              		.cfi_def_cfa_offset 24
 185              		@ sp needed
 186 002a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 187              	.LVL14:
 188              	.L21:
 189              	.LCFI7:
 190              		.cfi_restore_state
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 191              		.loc 1 395 9 is_stmt 1 view .LVU42
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 192              		.loc 1 395 45 is_stmt 0 view .LVU43
 193 002e 0199     		ldr	r1, [sp, #4]
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
ARM GAS  /tmp/ccIGV0Yw.s 			page 13


 194              		.loc 1 395 9 view .LVU44
 195 0030 0131     		adds	r1, r1, #1
 196 0032 02A8     		add	r0, sp, #8
 197              	.LVL15:
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 198              		.loc 1 395 9 view .LVU45
 199 0034 FFF7FEFF 		bl	AES_CMAC_SetKey
 200              	.LVL16:
 397:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 201              		.loc 1 397 9 is_stmt 1 view .LVU46
 397:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 202              		.loc 1 397 11 is_stmt 0 view .LVU47
 203 0038 25B1     		cbz	r5, .L17
 399:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 204              		.loc 1 399 13 is_stmt 1 view .LVU48
 205 003a 1022     		movs	r2, #16
 206 003c 2946     		mov	r1, r5
 207 003e 02A8     		add	r0, sp, #8
 208 0040 FFF7FEFF 		bl	AES_CMAC_Update
 209              	.LVL17:
 210              	.L17:
 402:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 211              		.loc 1 402 9 view .LVU49
 212 0044 3A46     		mov	r2, r7
 213 0046 4146     		mov	r1, r8
 214 0048 02A8     		add	r0, sp, #8
 215 004a FFF7FEFF 		bl	AES_CMAC_Update
 216              	.LVL18:
 404:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 217              		.loc 1 404 9 view .LVU50
 218 004e 02A9     		add	r1, sp, #8
 219 0050 48A8     		add	r0, sp, #288
 220 0052 FFF7FEFF 		bl	AES_CMAC_Final
 221              	.LVL19:
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 222              		.loc 1 407 9 view .LVU51
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 223              		.loc 1 407 48 is_stmt 0 view .LVU52
 224 0056 9DF82321 		ldrb	r2, [sp, #291]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 225              		.loc 1 407 77 view .LVU53
 226 005a 9DF82231 		ldrb	r3, [sp, #290]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 227              		.loc 1 407 81 view .LVU54
 228 005e 1B04     		lsls	r3, r3, #16
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 229              		.loc 1 407 58 view .LVU55
 230 0060 43EA0263 		orr	r3, r3, r2, lsl #24
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 231              		.loc 1 407 106 view .LVU56
 232 0064 9DF82121 		ldrb	r2, [sp, #289]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 233              		.loc 1 407 87 view .LVU57
 234 0068 43EA0223 		orr	r3, r3, r2, lsl #8
 408:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 235              		.loc 1 408 48 view .LVU58
 236 006c 9DF82021 		ldrb	r2, [sp, #288]	@ zero_extendqisi2
ARM GAS  /tmp/ccIGV0Yw.s 			page 14


 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 237              		.loc 1 407 17 view .LVU59
 238 0070 1343     		orrs	r3, r3, r2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 239              		.loc 1 407 15 view .LVU60
 240 0072 3360     		str	r3, [r6]
 241 0074 D7E7     		b	.L16
 242              	.LVL20:
 243              	.L18:
 381:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 244              		.loc 1 381 16 view .LVU61
 245 0076 0224     		movs	r4, #2
 246 0078 D5E7     		b	.L16
 247              	.L19:
 381:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 248              		.loc 1 381 16 view .LVU62
 249 007a 0224     		movs	r4, #2
 250 007c D3E7     		b	.L16
 251              		.cfi_endproc
 252              	.LFE105:
 254              		.section	.rodata.SecureElementInit.str1.4,"aMS",%progbits,1
 255              		.align	2
 256              	.LC1:
 257 0000 01010101 		.ascii	"\001\001\001\001\001\001\001\001\000"
 257      01010101 
 257      00
 258 0009 000000   		.align	2
 259              	.LC2:
 260 000c 2B7E1516 		.ascii	"+~\025\026(\256\322\246\253\367\025\210\011\317O<\000"
 260      28AED2A6 
 260      ABF71588 
 260      09CF4F3C 
 260      00
 261              		.section	.text.SecureElementInit,"ax",%progbits
 262              		.align	1
 263              		.global	SecureElementInit
 264              		.syntax unified
 265              		.thumb
 266              		.thumb_func
 267              		.fpu softvfp
 269              	SecureElementInit:
 270              	.LVL21:
 271              	.LFB106:
 478:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 479:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 480:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Exported functions ---------------------------------------------------------*/
 481:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 482:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 483:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * API functions
 484:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 485:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* ST_WORKAROUND: Add unique ID callback as input parameter */
 486:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementInit( SecureElementNvmData_t *nvm, SecureElementGetUniqueId seGe
 487:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 272              		.loc 1 487 1 is_stmt 1 view -0
 273              		.cfi_startproc
 274              		@ args = 0, pretend = 0, frame = 192
 275              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  /tmp/ccIGV0Yw.s 			page 15


 276              		.loc 1 487 1 is_stmt 0 view .LVU64
 277 0000 70B5     		push	{r4, r5, r6, lr}
 278              	.LCFI8:
 279              		.cfi_def_cfa_offset 16
 280              		.cfi_offset 4, -16
 281              		.cfi_offset 5, -12
 282              		.cfi_offset 6, -8
 283              		.cfi_offset 14, -4
 284 0002 B0B0     		sub	sp, sp, #192
 285              	.LCFI9:
 286              		.cfi_def_cfa_offset 208
 287 0004 0546     		mov	r5, r0
 288 0006 0E46     		mov	r6, r1
 488:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 489:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementNvmData_t seNvmInit =
 289              		.loc 1 489 5 is_stmt 1 view .LVU65
 290              		.loc 1 489 28 is_stmt 0 view .LVU66
 291 0008 6C46     		mov	r4, sp
 292 000a C022     		movs	r2, #192
 293 000c 0021     		movs	r1, #0
 294              	.LVL22:
 295              		.loc 1 489 28 view .LVU67
 296 000e 2046     		mov	r0, r4
 297              	.LVL23:
 298              		.loc 1 489 28 view .LVU68
 299 0010 FFF7FEFF 		bl	memset
 300              	.LVL24:
 301 0014 304B     		ldr	r3, .L27
 302 0016 93E80300 		ldm	r3, {r0, r1}
 303 001a 84E80300 		stm	r4, {r0, r1}
 304 001e 2F4A     		ldr	r2, .L27+4
 305 0020 02AB     		add	r3, sp, #8
 306 0022 92E80300 		ldm	r2, {r0, r1}
 307 0026 83E80300 		stm	r3, {r0, r1}
 308 002a 2D4C     		ldr	r4, .L27+8
 309 002c A446     		mov	ip, r4
 310 002e BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 311 0032 CDF81100 		str	r0, [sp, #17]	@ unaligned
 312 0036 CDF81510 		str	r1, [sp, #21]	@ unaligned
 313 003a CDF81920 		str	r2, [sp, #25]	@ unaligned
 314 003e CDF81D30 		str	r3, [sp, #29]	@ unaligned
 315 0042 0123     		movs	r3, #1
 316 0044 8DF82130 		strb	r3, [sp, #33]
 317 0048 A446     		mov	ip, r4
 318 004a BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 319 004e CDF82200 		str	r0, [sp, #34]	@ unaligned
 320 0052 CDF82610 		str	r1, [sp, #38]	@ unaligned
 321 0056 CDF82A20 		str	r2, [sp, #42]	@ unaligned
 322 005a CDF82E30 		str	r3, [sp, #46]	@ unaligned
 323 005e 0223     		movs	r3, #2
 324 0060 8DF83230 		strb	r3, [sp, #50]
 325 0064 A446     		mov	ip, r4
 326 0066 BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 327 006a CDF83300 		str	r0, [sp, #51]	@ unaligned
 328 006e CDF83710 		str	r1, [sp, #55]	@ unaligned
 329 0072 CDF83B20 		str	r2, [sp, #59]	@ unaligned
 330 0076 CDF83F30 		str	r3, [sp, #63]	@ unaligned
ARM GAS  /tmp/ccIGV0Yw.s 			page 16


 331 007a 0323     		movs	r3, #3
 332 007c 8DF84330 		strb	r3, [sp, #67]
 333 0080 0DF1440C 		add	ip, sp, #68
 334 0084 94E80F00 		ldm	r4, {r0, r1, r2, r3}
 335 0088 8CE80F00 		stm	ip, {r0, r1, r2, r3}
 336 008c 0423     		movs	r3, #4
 337 008e 8DF85430 		strb	r3, [sp, #84]
 338 0092 7F23     		movs	r3, #127
 339 0094 8DF86530 		strb	r3, [sp, #101]
 340 0098 8023     		movs	r3, #128
 341 009a 8DF87630 		strb	r3, [sp, #118]
 342 009e 8123     		movs	r3, #129
 343 00a0 8DF88730 		strb	r3, [sp, #135]
 344 00a4 8223     		movs	r3, #130
 345 00a6 8DF89830 		strb	r3, [sp, #152]
 346 00aa 8323     		movs	r3, #131
 347 00ac 8DF8A930 		strb	r3, [sp, #169]
 490:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 491:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /*!
 492:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * end-device IEEE EUI (big endian)
 493:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *
 494:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * \remark In this application the value is automatically generated by
 495:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *         calling BoardGetUniqueId function
 496:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         */
 497:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         .DevEui = LORAWAN_DEVICE_EUI,
 498:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /*!
 499:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * App/Join server IEEE EUI (big endian)
 500:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         */
 501:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         .JoinEui = LORAWAN_JOIN_EUI,
 502:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /*!
 503:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * LoRaWAN key list
 504:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         */
 505:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         .KeyList = SOFT_SE_KEY_LIST
 506:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     };
 507:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 508:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 509:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( nvm == NULL )
 348              		.loc 1 509 5 is_stmt 1 view .LVU69
 349              		.loc 1 509 7 is_stmt 0 view .LVU70
 350 00b0 6DB1     		cbz	r5, .L24
 510:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 511:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 512:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 513:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 514:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Initialize nvm pointer
 515:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm = nvm;
 351              		.loc 1 515 5 is_stmt 1 view .LVU71
 352              		.loc 1 515 11 is_stmt 0 view .LVU72
 353 00b2 0C4B     		ldr	r3, .L27+12
 354 00b4 1D60     		str	r5, [r3]
 516:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 517:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Initialize data
 518:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( ( uint8_t* )SeNvm, ( uint8_t* )&seNvmInit, sizeof( seNvmInit ) );
 355              		.loc 1 518 5 is_stmt 1 view .LVU73
 356 00b6 C022     		movs	r2, #192
 357 00b8 6946     		mov	r1, sp
 358 00ba 2846     		mov	r0, r5
ARM GAS  /tmp/ccIGV0Yw.s 			page 17


 359 00bc FFF7FEFF 		bl	memcpy1
 360              	.LVL25:
 519:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 520:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t itr = 0;
 521:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t devEUI[SE_EUI_SIZE] = LORAWAN_DEVICE_EUI;
 522:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t joinEUI[SE_EUI_SIZE] = LORAWAN_JOIN_EUI;
 523:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 524:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (nvm == NULL)
 525:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 526:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 527:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 528:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 529:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Initialize nvm pointer */
 530:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm = nvm;
 531:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 532:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Initialize with defaults */
 533:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1((uint8_t *)SeNvm->DevEui, devEUI, SE_EUI_SIZE);
 534:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1((uint8_t *)SeNvm->JoinEui, joinEUI, SE_EUI_SIZE);
 535:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 536:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = APP_KEY;
 537:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = NWK_KEY;
 538:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 539:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = J_S_INT_KEY;
 540:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = J_S_ENC_KEY;
 541:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = F_NWK_S_INT_KEY;
 542:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = S_NWK_S_INT_KEY;
 543:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = NWK_S_ENC_KEY;
 544:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 545:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = NWK_S_KEY;
 546:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 547:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = APP_S_KEY;
 548:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_ROOT_KEY;
 549:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KE_KEY;
 550:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_0;
 551:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_0;
 552:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_0;
 553:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 554:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_1;
 555:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_1;
 556:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_1;
 557:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_2;
 558:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_2;
 559:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_2;
 560:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_3;
 561:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_3;
 562:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_3;
 563:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /*LORAMAC_MAX_MC_CTX > 1 */
 564:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr].KeyID = SLOT_RAND_ZERO_KEY;
 565:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 566:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Delete all obsolete keys in NVM  */
 567:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     DeleteAllDynamicKeys();
 568:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 569:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(APP_KEY, KMS_APP_KEY_OBJECT_HANDLE);
 570:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(NWK_KEY, KMS_NWK_KEY_OBJECT_HANDLE);
 571:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(APP_S_KEY, KMS_APP_S_KEY_OBJECT_HANDLE);
 572:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(NWK_S_KEY, KMS_NWK_S_KEY_OBJECT_HANDLE);
 573:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
ARM GAS  /tmp/ccIGV0Yw.s 			page 18


 574:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(SLOT_RAND_ZERO_KEY, KMS_ZERO_KEY_OBJECT_HANDLE);
 575:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 576:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 577:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 578:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 579:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     MW_LOG(TS_OFF, VLEVEL_M, "###### OTAA ######\r\n");
 580:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_KEY);
 581:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(NWK_KEY);
 582:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     MW_LOG(TS_OFF, VLEVEL_M, "###### ABP  ######\r\n");
 583:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_S_KEY);
 584:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(NWK_S_KEY);
 585:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 586:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 587:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if !defined( SECURE_ELEMENT_PRE_PROVISIONED )
 588:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if( STATIC_DEVICE_EUI == 0 )
 589:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (seGetUniqueId != NULL)
 361              		.loc 1 589 5 view .LVU74
 362              		.loc 1 589 8 is_stmt 0 view .LVU75
 363 00c0 3EB1     		cbz	r6, .L25
 590:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 591:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Get a DevEUI from MCU unique ID
 592:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         seGetUniqueId(SeNvm->DevEui);
 364              		.loc 1 592 9 is_stmt 1 view .LVU76
 365 00c2 084B     		ldr	r3, .L27+12
 366 00c4 1868     		ldr	r0, [r3]
 367 00c6 B047     		blx	r6
 368              	.LVL26:
 593:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 594:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* STATIC_DEVICE_EUI */
 595:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* !SECURE_ELEMENT_PRE_PROVISIONED */
 596:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 369              		.loc 1 596 12 is_stmt 0 view .LVU77
 370 00c8 0020     		movs	r0, #0
 371              	.L23:
 597:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 372              		.loc 1 597 1 view .LVU78
 373 00ca 30B0     		add	sp, sp, #192
 374              	.LCFI10:
 375              		.cfi_remember_state
 376              		.cfi_def_cfa_offset 16
 377              		@ sp needed
 378 00cc 70BD     		pop	{r4, r5, r6, pc}
 379              	.LVL27:
 380              	.L24:
 381              	.LCFI11:
 382              		.cfi_restore_state
 511:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 383              		.loc 1 511 16 view .LVU79
 384 00ce 0220     		movs	r0, #2
 385 00d0 FBE7     		b	.L23
 386              	.L25:
 596:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 387              		.loc 1 596 12 view .LVU80
 388 00d2 0020     		movs	r0, #0
 389 00d4 F9E7     		b	.L23
 390              	.L28:
 391 00d6 00BF     		.align	2
ARM GAS  /tmp/ccIGV0Yw.s 			page 19


 392              	.L27:
 393 00d8 00000000 		.word	.LANCHOR1
 394 00dc 00000000 		.word	.LC1
 395 00e0 0C000000 		.word	.LC2
 396 00e4 00000000 		.word	.LANCHOR0
 397              		.cfi_endproc
 398              	.LFE106:
 400              		.section	.text.SecureElementGetKeyByID,"ax",%progbits
 401              		.align	1
 402              		.global	SecureElementGetKeyByID
 403              		.syntax unified
 404              		.thumb
 405              		.thumb_func
 406              		.fpu softvfp
 408              	SecureElementGetKeyByID:
 409              	.LVL28:
 410              	.LFB107:
 598:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 599:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* ST_WORKAROUND_BEGIN: Add KMS specific functions */
 600:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementGetKeyByID( KeyIdentifier_t keyID, Key_t **keyItem )
 601:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 411              		.loc 1 601 1 is_stmt 1 view -0
 412              		.cfi_startproc
 413              		@ args = 0, pretend = 0, frame = 0
 414              		@ frame_needed = 0, uses_anonymous_args = 0
 415              		@ link register save eliminated.
 602:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 603:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (uint8_t i = 0; i < NUM_OF_KEYS; i++)
 605:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 606:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[i].KeyID == keyID)
 607:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 608:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *keyItem = &(SeNvm->KeyList[i]);
 609:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 610:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 611:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 612:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 613:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 416              		.loc 1 613 5 view .LVU82
 614:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 615:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 616:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 617:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;  /* Read ONLY session */
 618:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE key_handle = (CK_OBJECT_HANDLE)(~0UL);
 619:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG derive_key_template_class = CKO_SECRET_KEY;
 620:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t extractable_key[16] = {0};
 621:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE key_attribute_template = {CKA_VALUE, (CK_VOID_PTR) &derive_key_template_class, 16U
 622:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t index_keylist = 0;
 623:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (index_keylist = 0; index_keylist < NUM_OF_KEYS; index_keylist++)
 624:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 625:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[index_keylist].KeyID == keyID)
 626:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 627:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             key_handle = SeNvm->KeyList[index_keylist].Object_Index;
 628:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 629:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 630:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 631:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (key_handle == (CK_OBJECT_HANDLE)(~0UL))
ARM GAS  /tmp/ccIGV0Yw.s 			page 20


 632:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 633:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 634:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 635:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 636:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 637:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0, session_flags, NULL, 0, &session);
 638:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 639:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Get key to display */
 640:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 641:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 642:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_attribute_template.pValue = extractable_key;
 643:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_GetAttributeValue(session, key_handle, &key_attribute_template, 1UL);
 644:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 645:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 646:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 647:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(SeNvm->KeyList[index_keylist].KeyValue, extractable_key, sizeof(extractable_key));
 648:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *keyItem = &(SeNvm->KeyList[index_keylist]);
 649:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 650:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 651:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 652:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 653:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 654:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 655:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 656:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 657:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 658:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 659:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 660:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS == 1 */
 661:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 417              		.loc 1 661 1 is_stmt 0 view .LVU83
 418 0000 0320     		movs	r0, #3
 419              	.LVL29:
 420              		.loc 1 661 1 view .LVU84
 421 0002 7047     		bx	lr
 422              		.cfi_endproc
 423              	.LFE107:
 425              		.section	.text.SecureElementDeleteDynamicKeys,"ax",%progbits
 426              		.align	1
 427              		.global	SecureElementDeleteDynamicKeys
 428              		.syntax unified
 429              		.thumb
 430              		.thumb_func
 431              		.fpu softvfp
 433              	SecureElementDeleteDynamicKeys:
 434              	.LVL30:
 435              	.LFB108:
 662:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 663:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementDeleteDynamicKeys( KeyIdentifier_t keyID, uint32_t *key_label )
 664:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 436              		.loc 1 664 1 is_stmt 1 view -0
 437              		.cfi_startproc
 438              		@ args = 0, pretend = 0, frame = 0
 439              		@ frame_needed = 0, uses_anonymous_args = 0
 440              		@ link register save eliminated.
 665:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 666:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR;
ARM GAS  /tmp/ccIGV0Yw.s 			page 21


 441              		.loc 1 666 5 view .LVU86
 667:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 668:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 669:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 670:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 671:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE hObject[NUM_OF_KEYS];
 672:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG local_template_label[] = {GlobalTemplateLabel, 0UL};
 673:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE dynamic_key_template = {CKA_LABEL, (CK_VOID_PTR)local_template_label, sizeof(local
 674:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t ulCount = 0;
 675:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 676:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetSpecificLabelByID(keyID, &local_template_label[1]))
 677:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 678:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 679:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 680:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *key_label = local_template_label[1];
 681:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 682:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 683:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
 684:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 685:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Search from Template pattern */
 686:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 687:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 688:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsInit(session, &dynamic_key_template, sizeof(dynamic_key_template) / sizeo
 689:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 690:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 691:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Find all existing keys handle Template pattern */
 692:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 693:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 694:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjects(session, hObject, NUM_OF_KEYS, (CK_ULONG *) &ulCount);
 695:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 696:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 697:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 698:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 699:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsFinal(session);
 700:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 701:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 702:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (ulCount <= NUM_OF_KEYS)
 703:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 704:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         for (uint8_t i = 0; i < ulCount; i++)
 705:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 706:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if (rv == CKR_OK)
 707:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {
 708:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 rv = C_DestroyObject(session, hObject[i]);
 709:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 710:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 711:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 712:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 713:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 714:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (session > 0)
 715:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 716:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         (void)C_CloseSession(session);
 717:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 718:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 719:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 720:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 721:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 722:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
ARM GAS  /tmp/ccIGV0Yw.s 			page 22


 723:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 724:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS == 1 */
 725:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 442              		.loc 1 725 1 is_stmt 0 view .LVU87
 443 0000 0620     		movs	r0, #6
 444              	.LVL31:
 445              		.loc 1 725 1 view .LVU88
 446 0002 7047     		bx	lr
 447              		.cfi_endproc
 448              	.LFE108:
 450              		.section	.text.SecureElementSetObjHandler,"ax",%progbits
 451              		.align	1
 452              		.global	SecureElementSetObjHandler
 453              		.syntax unified
 454              		.thumb
 455              		.thumb_func
 456              		.fpu softvfp
 458              	SecureElementSetObjHandler:
 459              	.LVL32:
 460              	.LFB109:
 726:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 727:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetObjHandler( KeyIdentifier_t keyID, uint32_t keyIndex )
 728:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 461              		.loc 1 728 1 is_stmt 1 view -0
 462              		.cfi_startproc
 463              		@ args = 0, pretend = 0, frame = 0
 464              		@ frame_needed = 0, uses_anonymous_args = 0
 465              		@ link register save eliminated.
 729:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 730:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR;
 466              		.loc 1 730 5 view .LVU90
 731:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 732:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (uint8_t i = 0; i < NUM_OF_KEYS; i++)
 733:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 734:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[i].KeyID == keyID)
 735:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 736:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             SeNvm->KeyList[i].Object_Index = (CK_OBJECT_HANDLE) keyIndex;
 737:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 738:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 739:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 740:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 741:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 742:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 467              		.loc 1 742 1 is_stmt 0 view .LVU91
 468 0000 0620     		movs	r0, #6
 469              	.LVL33:
 470              		.loc 1 742 1 view .LVU92
 471 0002 7047     		bx	lr
 472              		.cfi_endproc
 473              	.LFE109:
 475              		.section	.text.SecureElementComputeAesCmac,"ax",%progbits
 476              		.align	1
 477              		.global	SecureElementComputeAesCmac
 478              		.syntax unified
 479              		.thumb
 480              		.thumb_func
 481              		.fpu softvfp
ARM GAS  /tmp/ccIGV0Yw.s 			page 23


 483              	SecureElementComputeAesCmac:
 484              	.LVL34:
 485              	.LFB111:
 743:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* ST_WORKAROUND_END */
 744:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 745:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetKey( KeyIdentifier_t keyID, uint8_t* key )
 746:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 747:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( key == NULL )
 748:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 749:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 750:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 751:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 752:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for( uint8_t i = 0; i < NUM_OF_KEYS; i++ )
 754:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SeNvm->KeyList[i].KeyID == keyID )
 756:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 757:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
 758:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX == 1 )
 759:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if ( keyID == MC_KEY_0 )
 760:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 761:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if( ( keyID == MC_KEY_0 ) || ( keyID == MC_KEY_1 ) || ( keyID == MC_KEY_2 ) || ( keyID 
 762:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_MAX_MC_CTX */
 763:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             /* ST_WORKAROUND_END */
 764:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {  // Decrypt the key if its a Mckey
 765:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 SecureElementStatus_t retval           = SECURE_ELEMENT_ERROR;
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 uint8_t               decryptedKey[16] = { 0 };
 767:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 retval = SecureElementAesEncrypt( key, 16, MC_KE_KEY, decryptedKey );
 769:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 memcpy1( SeNvm->KeyList[i].KeyValue, decryptedKey, SE_KEY_SIZE );
 771:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 772:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 773:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             else
 774:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 memcpy1( SeNvm->KeyList[i].KeyValue, key, SE_KEY_SIZE );
 776:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 777:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 778:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 779:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 780:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 781:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 782:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 783:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 784:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 785:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 786:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;  /* Read ONLY session */
 787:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE key_handle;
 788:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_class = CKO_SECRET_KEY;
 789:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_type = CKK_AES;
 790:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 791:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_true = CK_TRUE;
 792:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else
 793:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_false = CK_TRUE;
 794:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 795:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t key_ui32[] =
 796:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
ARM GAS  /tmp/ccIGV0Yw.s 			page 24


 797:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[3]  | (key[2] << 8)  | (key[1] << 16)  | (key[0] << 24),
 798:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[7]  | (key[6] << 8)  | (key[5] << 16)  | (key[4] << 24),
 799:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[11] | (key[10] << 8) | (key[9] << 16)  | (key[8] << 24),
 800:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[15] | (key[14] << 8) | (key[13] << 16) | (key[12] << 24),
 801:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     };
 802:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 803:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t specific_label[] = {GlobalTemplateLabel, 0UL};
 804:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE key_attribute_template[] =
 805:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 806:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_CLASS, (CK_VOID_PTR) &template_class,    sizeof(CK_BBOOL)      },
 807:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_KEY_TYPE, (CK_VOID_PTR) &template_type,     sizeof(CK_BBOOL)      },
 808:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_VALUE, (CK_VOID_PTR)key_ui32,           sizeof(key_ui32)      },
 809:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 810:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_EXTRACTABLE, (CK_VOID_PTR) &template_true,     sizeof(CK_BBOOL)      },
 811:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else
 812:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_EXTRACTABLE, (CK_VOID_PTR) &template_false,    sizeof(CK_BBOOL)      },
 813:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 814:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_LABEL, (CK_VOID_PTR)specific_label,     sizeof(specific_label)},
 815:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     };
 816:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 817:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
 818:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX == 1 )
 819:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if ( keyID == MC_KEY_0 )
 820:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 821:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( keyID == MC_KEY_0 ) || ( keyID == MC_KEY_1 ) || ( keyID == MC_KEY_2 ) || ( keyID == MC_KE
 822:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_MAX_MC_CTX */
 823:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* ST_WORKAROUND_END */
 824:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {  // Decrypt the key if its a Mckey
 825:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t decryptedKey[16] = { 0 };
 826:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SECURE_ELEMENT_SUCCESS != SecureElementAesEncrypt( key, 16, MC_KE_KEY, decryptedKey ))
 827:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 828:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_ERROR;
 829:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 830:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 831:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[0] = decryptedKey[3]  | (decryptedKey[2] << 8)  | (decryptedKey[1] << 16)  | (decr
 832:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[1] = decryptedKey[7]  | (decryptedKey[6] << 8)  | (decryptedKey[5] << 16)  | (decr
 833:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[2] = decryptedKey[11] | (decryptedKey[10] << 8) | (decryptedKey[9] << 16)  | (decr
 834:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[3] = decryptedKey[15] | (decryptedKey[14] << 8) | (decryptedKey[13] << 16) | (decr
 835:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 836:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 837:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetKeyIndexByID(keyID, &key_handle))
 838:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 839:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 840:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 841:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 842:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != SecureElementDeleteDynamicKeys(keyID, &specific_label[1]))
 843:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 844:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 845:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 846:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 847:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 848:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0, session_flags, NULL, 0, &session);
 849:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 850:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Get key to display */
 851:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 852:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 853:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_CreateObject(session, key_attribute_template, sizeof(key_attribute_template) / sizeo
ARM GAS  /tmp/ccIGV0Yw.s 			page 25


 854:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                             &key_handle);
 855:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 856:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 857:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 858:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 859:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SecureElementSetObjHandler(keyID, key_handle);
 860:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 861:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 862:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(keyID);
 863:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 864:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 865:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 866:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 867:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 868:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 869:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
 870:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 871:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 872:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 873:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 874:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 875:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementComputeAesCmac( uint8_t* micBxBuffer, uint8_t* buffer, uint16_t 
 876:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                    KeyIdentifier_t keyID, uint32_t* cmac )
 877:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 486              		.loc 1 877 1 is_stmt 1 view -0
 487              		.cfi_startproc
 488              		@ args = 4, pretend = 0, frame = 0
 489              		@ frame_needed = 0, uses_anonymous_args = 0
 878:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( keyID >= LORAMAC_CRYPTO_MULTICAST_KEYS )
 490              		.loc 1 878 5 view .LVU94
 491              		.loc 1 878 7 is_stmt 0 view .LVU95
 492 0000 7E2B     		cmp	r3, #126
 493 0002 0AD8     		bhi	.L34
 877:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( keyID >= LORAMAC_CRYPTO_MULTICAST_KEYS )
 494              		.loc 1 877 1 view .LVU96
 495 0004 00B5     		push	{lr}
 496              	.LCFI12:
 497              		.cfi_def_cfa_offset 4
 498              		.cfi_offset 14, -4
 499 0006 83B0     		sub	sp, sp, #12
 500              	.LCFI13:
 501              		.cfi_def_cfa_offset 16
 879:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 880:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Never accept multicast key identifier for cmac computation
 881:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 882:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 883:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 884:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return ComputeCmac( micBxBuffer, buffer, size, keyID, cmac );
 502              		.loc 1 884 5 is_stmt 1 view .LVU97
 503              		.loc 1 884 12 is_stmt 0 view .LVU98
 504 0008 DDF810C0 		ldr	ip, [sp, #16]
 505 000c CDF800C0 		str	ip, [sp]
 506 0010 FFF7FEFF 		bl	ComputeCmac
 507              	.LVL35:
 885:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 508              		.loc 1 885 1 view .LVU99
 509 0014 03B0     		add	sp, sp, #12
ARM GAS  /tmp/ccIGV0Yw.s 			page 26


 510              	.LCFI14:
 511              		.cfi_def_cfa_offset 4
 512              		@ sp needed
 513 0016 5DF804FB 		ldr	pc, [sp], #4
 514              	.LVL36:
 515              	.L34:
 516              	.LCFI15:
 517              		.cfi_def_cfa_offset 0
 518              		.cfi_restore 14
 881:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 519              		.loc 1 881 16 view .LVU100
 520 001a 0320     		movs	r0, #3
 521              	.LVL37:
 522              		.loc 1 885 1 view .LVU101
 523 001c 7047     		bx	lr
 524              		.cfi_endproc
 525              	.LFE111:
 527              		.section	.text.SecureElementVerifyAesCmac,"ax",%progbits
 528              		.align	1
 529              		.global	SecureElementVerifyAesCmac
 530              		.syntax unified
 531              		.thumb
 532              		.thumb_func
 533              		.fpu softvfp
 535              	SecureElementVerifyAesCmac:
 536              	.LVL38:
 537              	.LFB112:
 886:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 887:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementVerifyAesCmac( uint8_t* buffer, uint16_t size, uint32_t expected
 888:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                   KeyIdentifier_t keyID )
 889:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 538              		.loc 1 889 1 is_stmt 1 view -0
 539              		.cfi_startproc
 540              		@ args = 0, pretend = 0, frame = 8
 541              		@ frame_needed = 0, uses_anonymous_args = 0
 890:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( buffer == NULL )
 542              		.loc 1 890 5 view .LVU103
 543              		.loc 1 890 7 is_stmt 0 view .LVU104
 544 0000 90B1     		cbz	r0, .L41
 889:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( buffer == NULL )
 545              		.loc 1 889 1 view .LVU105
 546 0002 10B5     		push	{r4, lr}
 547              	.LCFI16:
 548              		.cfi_def_cfa_offset 8
 549              		.cfi_offset 4, -8
 550              		.cfi_offset 14, -4
 551 0004 84B0     		sub	sp, sp, #16
 552              	.LCFI17:
 553              		.cfi_def_cfa_offset 24
 554 0006 8C46     		mov	ip, r1
 555 0008 1446     		mov	r4, r2
 556 000a 0146     		mov	r1, r0
 557              	.LVL39:
 891:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 892:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 893:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 894:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
ARM GAS  /tmp/ccIGV0Yw.s 			page 27


 895:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval   = SECURE_ELEMENT_ERROR;
 558              		.loc 1 895 5 is_stmt 1 view .LVU106
 896:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 897:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t              compCmac = 0;
 559              		.loc 1 897 5 view .LVU107
 560              		.loc 1 897 27 is_stmt 0 view .LVU108
 561 000c 0020     		movs	r0, #0
 562              	.LVL40:
 563              		.loc 1 897 27 view .LVU109
 564 000e 0390     		str	r0, [sp, #12]
 898:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval                         = ComputeCmac( NULL, buffer, size, keyID, &compCmac );
 565              		.loc 1 898 5 is_stmt 1 view .LVU110
 566              		.loc 1 898 38 is_stmt 0 view .LVU111
 567 0010 03AA     		add	r2, sp, #12
 568              	.LVL41:
 569              		.loc 1 898 38 view .LVU112
 570 0012 0092     		str	r2, [sp]
 571 0014 6246     		mov	r2, ip
 572 0016 FFF7FEFF 		bl	ComputeCmac
 573              	.LVL42:
 899:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 574              		.loc 1 899 5 is_stmt 1 view .LVU113
 575              		.loc 1 899 7 is_stmt 0 view .LVU114
 576 001a 18B9     		cbnz	r0, .L40
 900:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 901:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
 902:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 903:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 904:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( expectedCmac != compCmac )
 577              		.loc 1 904 5 is_stmt 1 view .LVU115
 578              		.loc 1 904 22 is_stmt 0 view .LVU116
 579 001c 039B     		ldr	r3, [sp, #12]
 580              		.loc 1 904 7 view .LVU117
 581 001e A342     		cmp	r3, r4
 582 0020 00D0     		beq	.L40
 905:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 906:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_FAIL_CMAC;
 583              		.loc 1 906 16 view .LVU118
 584 0022 0120     		movs	r0, #1
 585              	.LVL43:
 586              	.L40:
 907:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 908:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 909:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 910:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 911:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 912:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE object_handle;
 913:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 914:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (buffer == NULL)
 915:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 916:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 917:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 918:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 919:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* AES CMAC Authentication variables */
 920:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM aes_cmac_mechanism = { CKM_AES_CMAC, (CK_VOID_PTR)NULL, 0 };
 921:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 922:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = GetKeyIndexByID(keyID, &object_handle);
ARM GAS  /tmp/ccIGV0Yw.s 			page 28


 923:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval != SECURE_ELEMENT_SUCCESS)
 924:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 925:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
 926:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 927:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 928:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 929:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
 930:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 931:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Configure session to Verify the message in AES CMAC with settings included into the mechanis
 932:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 933:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 934:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_VerifyInit(session, &aes_cmac_mechanism, object_handle);
 935:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 936:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 937:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Verify the message */
 938:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 939:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 940:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(input_align_combined_buf, buffer, size);
 941:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_Verify(session, (CK_BYTE_PTR)input_align_combined_buf, size, (CK_BYTE_PTR)&expectedC
 942:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 943:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 944:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 945:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 946:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 947:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 948:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
 949:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 950:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 951:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 952:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 953:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 954:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 587              		.loc 1 954 1 view .LVU119
 588 0024 04B0     		add	sp, sp, #16
 589              	.LCFI18:
 590              		.cfi_def_cfa_offset 8
 591              		@ sp needed
 592 0026 10BD     		pop	{r4, pc}
 593              	.LVL44:
 594              	.L41:
 595              	.LCFI19:
 596              		.cfi_def_cfa_offset 0
 597              		.cfi_restore 4
 598              		.cfi_restore 14
 892:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 599              		.loc 1 892 16 view .LVU120
 600 0028 0220     		movs	r0, #2
 601              	.LVL45:
 602              		.loc 1 954 1 view .LVU121
 603 002a 7047     		bx	lr
 604              		.cfi_endproc
 605              	.LFE112:
 607              		.section	.text.SecureElementAesEncrypt,"ax",%progbits
 608              		.align	1
 609              		.global	SecureElementAesEncrypt
 610              		.syntax unified
 611              		.thumb
ARM GAS  /tmp/ccIGV0Yw.s 			page 29


 612              		.thumb_func
 613              		.fpu softvfp
 615              	SecureElementAesEncrypt:
 616              	.LVL46:
 617              	.LFB113:
 955:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 956:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementAesEncrypt( uint8_t* buffer, uint16_t size, KeyIdentifier_t keyI
 957:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                uint8_t* encBuffer )
 958:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 618              		.loc 1 958 1 is_stmt 1 view -0
 619              		.cfi_startproc
 620              		@ args = 0, pretend = 0, frame = 248
 621              		@ frame_needed = 0, uses_anonymous_args = 0
 622              		.loc 1 958 1 is_stmt 0 view .LVU123
 623 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 624              	.LCFI20:
 625              		.cfi_def_cfa_offset 24
 626              		.cfi_offset 4, -24
 627              		.cfi_offset 5, -20
 628              		.cfi_offset 6, -16
 629              		.cfi_offset 7, -12
 630              		.cfi_offset 8, -8
 631              		.cfi_offset 14, -4
 632 0004 BEB0     		sub	sp, sp, #248
 633              	.LCFI21:
 634              		.cfi_def_cfa_offset 272
 959:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( buffer == NULL || encBuffer == NULL )
 635              		.loc 1 959 5 is_stmt 1 view .LVU124
 636              		.loc 1 959 7 is_stmt 0 view .LVU125
 637 0006 50B3     		cbz	r0, .L51
 638 0008 0C46     		mov	r4, r1
 639 000a 1546     		mov	r5, r2
 640 000c 1E46     		mov	r6, r3
 641 000e 0746     		mov	r7, r0
 642              		.loc 1 959 24 discriminator 1 view .LVU126
 643 0010 43B3     		cbz	r3, .L52
 960:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 961:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 962:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 963:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 964:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Check if the size is divisible by 16,
 965:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( size % 16 ) != 0 )
 644              		.loc 1 965 5 is_stmt 1 view .LVU127
 645              		.loc 1 965 7 is_stmt 0 view .LVU128
 646 0012 11F00F0F 		tst	r1, #15
 647 0016 28D1     		bne	.L53
 966:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 967:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_BUF_SIZE;
 968:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 969:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 970:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 971:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     lorawan_aes_context aesContext;
 648              		.loc 1 971 5 is_stmt 1 view .LVU129
 972:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memset1( aesContext.ksch, '\0', 240 );
 649              		.loc 1 972 5 view .LVU130
 650 0018 F022     		movs	r2, #240
 651              	.LVL47:
ARM GAS  /tmp/ccIGV0Yw.s 			page 30


 652              		.loc 1 972 5 is_stmt 0 view .LVU131
 653 001a 0021     		movs	r1, #0
 654              	.LVL48:
 655              		.loc 1 972 5 view .LVU132
 656 001c 01A8     		add	r0, sp, #4
 657              	.LVL49:
 658              		.loc 1 972 5 view .LVU133
 659 001e FFF7FEFF 		bl	memset1
 660              	.LVL50:
 973:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 974:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t*                pItem;
 661              		.loc 1 974 5 is_stmt 1 view .LVU134
 975:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyByID( keyID, &pItem );
 662              		.loc 1 975 5 view .LVU135
 663              		.loc 1 975 36 is_stmt 0 view .LVU136
 664 0022 6946     		mov	r1, sp
 665 0024 2846     		mov	r0, r5
 666 0026 FFF7FEFF 		bl	GetKeyByID
 667              	.LVL51:
 976:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 977:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval == SECURE_ELEMENT_SUCCESS )
 668              		.loc 1 977 5 is_stmt 1 view .LVU137
 669              		.loc 1 977 7 is_stmt 0 view .LVU138
 670 002a 8046     		mov	r8, r0
 671 002c 18B1     		cbz	r0, .L55
 672              	.LVL52:
 673              	.L48:
 978:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 979:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         lorawan_aes_set_key(pItem->KeyValue, 16, &aesContext);
 980:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 981:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t block = 0;
 982:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         while( size != 0 )
 984:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 985:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             lorawan_aes_encrypt(&buffer[block], &encBuffer[block], &aesContext);
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             block = block + 16;
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 988:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 989:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 990:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 991:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 992:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 993:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 994:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t encrypted_length = 0;
 995:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE object_handle;
 996:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t dummy_tag[SE_KEY_SIZE] = {0};
 997:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t dummy_tag_lenth = 0;
 998:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 999:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM aes_ecb_mechanism = { CKM_AES_ECB, (CK_VOID_PTR *) NULL, 0 };
1000:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1001:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyIndexByID(keyID, &object_handle);
1002:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval != SECURE_ELEMENT_SUCCESS)
1003:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1004:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
1005:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1006:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1007:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
ARM GAS  /tmp/ccIGV0Yw.s 			page 31


1008:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
1009:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1010:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Configure session to encrypt message in AES ECB with settings included into the mechanism */
1011:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1012:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1013:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_EncryptInit(session, &aes_ecb_mechanism, object_handle);
1014:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1015:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1016:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Encrypt clear message */
1017:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1018:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1019:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(input_align_combined_buf, buffer, size);
1020:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         encrypted_length = sizeof(output_align);
1021:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_EncryptUpdate(session, (CK_BYTE_PTR)input_align_combined_buf, size,
1022:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                              output_align, (CK_ULONG_PTR)&encrypted_length);
1023:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(encBuffer, output_align, size);
1024:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1025:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1026:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* In this case C_EncryptFinal is just called to Free the Alloc mem */
1027:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1028:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1029:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         dummy_tag_lenth = sizeof(tag);
1030:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_EncryptFinal(session, &dummy_tag[0], (CK_ULONG_PTR)&dummy_tag_lenth);
1031:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1032:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1033:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close session with KMS */
1034:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
1035:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1036:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
1037:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1038:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
1039:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1040:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
1041:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1042:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
1043:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 674              		.loc 1 1043 1 view .LVU139
 675 002e 4046     		mov	r0, r8
 676 0030 3EB0     		add	sp, sp, #248
 677              	.LCFI22:
 678              		.cfi_remember_state
 679              		.cfi_def_cfa_offset 24
 680              		@ sp needed
 681 0032 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 682              	.LVL53:
 683              	.L55:
 684              	.LCFI23:
 685              		.cfi_restore_state
 686              	.LBB5:
 979:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 687              		.loc 1 979 9 is_stmt 1 view .LVU140
 688 0036 01AA     		add	r2, sp, #4
 689 0038 1021     		movs	r1, #16
 690 003a 0098     		ldr	r0, [sp]
 691              	.LVL54:
 979:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 692              		.loc 1 979 9 is_stmt 0 view .LVU141
ARM GAS  /tmp/ccIGV0Yw.s 			page 32


 693 003c 0130     		adds	r0, r0, #1
 694 003e FFF7FEFF 		bl	lorawan_aes_set_key
 695              	.LVL55:
 981:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 696              		.loc 1 981 9 is_stmt 1 view .LVU142
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 697              		.loc 1 983 9 view .LVU143
 981:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 698              		.loc 1 981 17 is_stmt 0 view .LVU144
 699 0042 4546     		mov	r5, r8
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 700              		.loc 1 983 14 view .LVU145
 701 0044 08E0     		b	.L49
 702              	.LVL56:
 703              	.L50:
 985:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             block = block + 16;
 704              		.loc 1 985 13 is_stmt 1 view .LVU146
 705 0046 01AA     		add	r2, sp, #4
 706 0048 7119     		adds	r1, r6, r5
 707 004a 7819     		adds	r0, r7, r5
 708 004c FFF7FEFF 		bl	lorawan_aes_encrypt
 709              	.LVL57:
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 710              		.loc 1 986 13 view .LVU147
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 711              		.loc 1 986 19 is_stmt 0 view .LVU148
 712 0050 1035     		adds	r5, r5, #16
 713              	.LVL58:
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 714              		.loc 1 986 19 view .LVU149
 715 0052 EDB2     		uxtb	r5, r5
 716              	.LVL59:
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 717              		.loc 1 987 13 is_stmt 1 view .LVU150
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 718              		.loc 1 987 19 is_stmt 0 view .LVU151
 719 0054 103C     		subs	r4, r4, #16
 720              	.LVL60:
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 721              		.loc 1 987 19 view .LVU152
 722 0056 A4B2     		uxth	r4, r4
 723              	.LVL61:
 724              	.L49:
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 725              		.loc 1 983 14 is_stmt 1 view .LVU153
 726 0058 002C     		cmp	r4, #0
 727 005a F4D1     		bne	.L50
 728 005c E7E7     		b	.L48
 729              	.LVL62:
 730              	.L51:
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 731              		.loc 1 983 14 is_stmt 0 view .LVU154
 732              	.LBE5:
 961:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 733              		.loc 1 961 16 view .LVU155
 734 005e 4FF00208 		mov	r8, #2
 735 0062 E4E7     		b	.L48
ARM GAS  /tmp/ccIGV0Yw.s 			page 33


 736              	.L52:
 961:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 737              		.loc 1 961 16 view .LVU156
 738 0064 4FF00208 		mov	r8, #2
 739 0068 E1E7     		b	.L48
 740              	.L53:
 967:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 741              		.loc 1 967 16 view .LVU157
 742 006a 4FF00508 		mov	r8, #5
 743 006e DEE7     		b	.L48
 744              		.cfi_endproc
 745              	.LFE113:
 747              		.section	.text.SecureElementSetKey,"ax",%progbits
 748              		.align	1
 749              		.global	SecureElementSetKey
 750              		.syntax unified
 751              		.thumb
 752              		.thumb_func
 753              		.fpu softvfp
 755              	SecureElementSetKey:
 756              	.LVL63:
 757              	.LFB110:
 746:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( key == NULL )
 758              		.loc 1 746 1 is_stmt 1 view -0
 759              		.cfi_startproc
 760              		@ args = 0, pretend = 0, frame = 16
 761              		@ frame_needed = 0, uses_anonymous_args = 0
 746:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( key == NULL )
 762              		.loc 1 746 1 is_stmt 0 view .LVU159
 763 0000 30B5     		push	{r4, r5, lr}
 764              	.LCFI24:
 765              		.cfi_def_cfa_offset 12
 766              		.cfi_offset 4, -12
 767              		.cfi_offset 5, -8
 768              		.cfi_offset 14, -4
 769 0002 85B0     		sub	sp, sp, #20
 770              	.LCFI25:
 771              		.cfi_def_cfa_offset 32
 747:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 772              		.loc 1 747 5 is_stmt 1 view .LVU160
 747:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 773              		.loc 1 747 7 is_stmt 0 view .LVU161
 774 0004 0029     		cmp	r1, #0
 775 0006 38D0     		beq	.L62
 776 0008 8C46     		mov	ip, r1
 777              	.LBB6:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 778              		.loc 1 753 18 view .LVU162
 779 000a 0023     		movs	r3, #0
 780              	.LVL64:
 781              	.L58:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 782              		.loc 1 753 25 is_stmt 1 discriminator 1 view .LVU163
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 783              		.loc 1 753 5 is_stmt 0 discriminator 1 view .LVU164
 784 000c 092B     		cmp	r3, #9
 785 000e 30D8     		bhi	.L64
ARM GAS  /tmp/ccIGV0Yw.s 			page 34


 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 786              		.loc 1 755 9 is_stmt 1 view .LVU165
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 787              		.loc 1 755 18 is_stmt 0 view .LVU166
 788 0010 1B4A     		ldr	r2, .L67
 789 0012 1168     		ldr	r1, [r2]
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 790              		.loc 1 755 30 view .LVU167
 791 0014 1C46     		mov	r4, r3
 792 0016 03EB0312 		add	r2, r3, r3, lsl #4
 793 001a 0A44     		add	r2, r2, r1
 794 001c 127C     		ldrb	r2, [r2, #16]	@ zero_extendqisi2
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 795              		.loc 1 755 11 view .LVU168
 796 001e 8242     		cmp	r2, r0
 797 0020 02D0     		beq	.L65
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 798              		.loc 1 753 42 is_stmt 1 discriminator 2 view .LVU169
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 799              		.loc 1 753 43 is_stmt 0 discriminator 2 view .LVU170
 800 0022 0133     		adds	r3, r3, #1
 801              	.LVL65:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 802              		.loc 1 753 43 discriminator 2 view .LVU171
 803 0024 DBB2     		uxtb	r3, r3
 804              	.LVL66:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 805              		.loc 1 753 43 discriminator 2 view .LVU172
 806 0026 F1E7     		b	.L58
 807              	.L65:
 759:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 808              		.loc 1 759 13 is_stmt 1 view .LVU173
 759:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 809              		.loc 1 759 16 is_stmt 0 view .LVU174
 810 0028 8028     		cmp	r0, #128
 811 002a 0AD0     		beq	.L66
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 812              		.loc 1 775 17 is_stmt 1 view .LVU175
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 813              		.loc 1 775 43 is_stmt 0 view .LVU176
 814 002c 03EB0313 		add	r3, r3, r3, lsl #4
 815              	.LVL67:
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 816              		.loc 1 775 43 view .LVU177
 817 0030 1033     		adds	r3, r3, #16
 818 0032 0B44     		add	r3, r3, r1
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 819              		.loc 1 775 17 view .LVU178
 820 0034 1022     		movs	r2, #16
 821 0036 6146     		mov	r1, ip
 822 0038 581C     		adds	r0, r3, #1
 823              	.LVL68:
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 824              		.loc 1 775 17 view .LVU179
 825 003a FFF7FEFF 		bl	memcpy1
 826              	.LVL69:
 776:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
ARM GAS  /tmp/ccIGV0Yw.s 			page 35


 827              		.loc 1 776 17 is_stmt 1 view .LVU180
 776:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 828              		.loc 1 776 24 is_stmt 0 view .LVU181
 829 003e 0025     		movs	r5, #0
 830 0040 18E0     		b	.L57
 831              	.LVL70:
 832              	.L66:
 833              	.LBB7:
 765:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 uint8_t               decryptedKey[16] = { 0 };
 834              		.loc 1 765 17 is_stmt 1 view .LVU182
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 835              		.loc 1 766 17 view .LVU183
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 836              		.loc 1 766 39 is_stmt 0 view .LVU184
 837 0042 0023     		movs	r3, #0
 838              	.LVL71:
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 839              		.loc 1 766 39 view .LVU185
 840 0044 0093     		str	r3, [sp]
 841 0046 0193     		str	r3, [sp, #4]
 842 0048 0293     		str	r3, [sp, #8]
 843 004a 0393     		str	r3, [sp, #12]
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 844              		.loc 1 768 17 is_stmt 1 view .LVU186
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 845              		.loc 1 768 26 is_stmt 0 view .LVU187
 846 004c 6B46     		mov	r3, sp
 847 004e 7F22     		movs	r2, #127
 848 0050 1021     		movs	r1, #16
 849 0052 6046     		mov	r0, ip
 850              	.LVL72:
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 851              		.loc 1 768 26 view .LVU188
 852 0054 FFF7FEFF 		bl	SecureElementAesEncrypt
 853              	.LVL73:
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 854              		.loc 1 768 26 view .LVU189
 855 0058 0546     		mov	r5, r0
 856              	.LVL74:
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 857              		.loc 1 770 17 is_stmt 1 view .LVU190
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 858              		.loc 1 770 31 is_stmt 0 view .LVU191
 859 005a 094B     		ldr	r3, .L67
 860 005c 1868     		ldr	r0, [r3]
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 861              		.loc 1 770 43 view .LVU192
 862 005e 04EB0414 		add	r4, r4, r4, lsl #4
 863 0062 1034     		adds	r4, r4, #16
 864 0064 2044     		add	r0, r0, r4
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 865              		.loc 1 770 17 view .LVU193
 866 0066 1022     		movs	r2, #16
 867 0068 6946     		mov	r1, sp
 868 006a 0130     		adds	r0, r0, #1
 869 006c FFF7FEFF 		bl	memcpy1
 870              	.LVL75:
ARM GAS  /tmp/ccIGV0Yw.s 			page 36


 771:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 871              		.loc 1 771 17 is_stmt 1 view .LVU194
 872 0070 00E0     		b	.L57
 873              	.LVL76:
 874              	.L64:
 771:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 875              		.loc 1 771 17 is_stmt 0 view .LVU195
 876              	.LBE7:
 877              	.LBE6:
 781:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 878              		.loc 1 781 12 view .LVU196
 879 0072 0325     		movs	r5, #3
 880              	.LVL77:
 881              	.L57:
 873:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 882              		.loc 1 873 1 discriminator 1 view .LVU197
 883 0074 2846     		mov	r0, r5
 884 0076 05B0     		add	sp, sp, #20
 885              	.LCFI26:
 886              		.cfi_remember_state
 887              		.cfi_def_cfa_offset 12
 888              		@ sp needed
 889 0078 30BD     		pop	{r4, r5, pc}
 890              	.LVL78:
 891              	.L62:
 892              	.LCFI27:
 893              		.cfi_restore_state
 749:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 894              		.loc 1 749 16 view .LVU198
 895 007a 0225     		movs	r5, #2
 896 007c FAE7     		b	.L57
 897              	.L68:
 898 007e 00BF     		.align	2
 899              	.L67:
 900 0080 00000000 		.word	.LANCHOR0
 901              		.cfi_endproc
 902              	.LFE110:
 904              		.section	.text.SecureElementDeriveAndStoreKey,"ax",%progbits
 905              		.align	1
 906              		.global	SecureElementDeriveAndStoreKey
 907              		.syntax unified
 908              		.thumb
 909              		.thumb_func
 910              		.fpu softvfp
 912              	SecureElementDeriveAndStoreKey:
 913              	.LVL79:
 914              	.LFB114:
1044:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1045:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementDeriveAndStoreKey( uint8_t* input, KeyIdentifier_t rootKeyID,
1046:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       KeyIdentifier_t targetKeyID )
1047:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 915              		.loc 1 1047 1 is_stmt 1 view -0
 916              		.cfi_startproc
 917              		@ args = 0, pretend = 0, frame = 16
 918              		@ frame_needed = 0, uses_anonymous_args = 0
1048:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( input == NULL )
 919              		.loc 1 1048 5 view .LVU200
ARM GAS  /tmp/ccIGV0Yw.s 			page 37


 920              		.loc 1 1048 7 is_stmt 0 view .LVU201
 921 0000 D0B1     		cbz	r0, .L72
1047:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( input == NULL )
 922              		.loc 1 1047 1 view .LVU202
 923 0002 10B5     		push	{r4, lr}
 924              	.LCFI28:
 925              		.cfi_def_cfa_offset 8
 926              		.cfi_offset 4, -8
 927              		.cfi_offset 14, -4
 928 0004 84B0     		sub	sp, sp, #16
 929              	.LCFI29:
 930              		.cfi_def_cfa_offset 24
 931 0006 1446     		mov	r4, r2
 932 0008 8446     		mov	ip, r0
1049:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1050:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1051:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1052:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1053:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval  = SECURE_ELEMENT_ERROR;
 933              		.loc 1 1053 5 is_stmt 1 view .LVU203
 934              	.LVL80:
1054:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1055:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // In case of MC_KE_KEY, only McRootKey can be used as root key
1056:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( targetKeyID == MC_KE_KEY )
 935              		.loc 1 1056 5 view .LVU204
 936              		.loc 1 1056 7 is_stmt 0 view .LVU205
 937 000a 7F2A     		cmp	r2, #127
 938 000c 01D1     		bne	.L71
1057:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1058:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( rootKeyID != MC_ROOT_KEY )
 939              		.loc 1 1058 9 is_stmt 1 view .LVU206
 940              		.loc 1 1058 11 is_stmt 0 view .LVU207
 941 000e 0429     		cmp	r1, #4
 942 0010 14D1     		bne	.L73
 943              	.L71:
1059:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
1060:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
1061:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
1062:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1063:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1064:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
1065:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t key[16] = { 0 };
 944              		.loc 1 1065 5 is_stmt 1 view .LVU208
 945              		.loc 1 1065 13 is_stmt 0 view .LVU209
 946 0012 0023     		movs	r3, #0
 947 0014 0093     		str	r3, [sp]
 948 0016 0193     		str	r3, [sp, #4]
 949 0018 0293     		str	r3, [sp, #8]
 950 001a 0393     		str	r3, [sp, #12]
1066:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Derive key
1067:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementAesEncrypt( input, 16, rootKeyID, key );
 951              		.loc 1 1067 5 is_stmt 1 view .LVU210
 952              		.loc 1 1067 14 is_stmt 0 view .LVU211
 953 001c 6B46     		mov	r3, sp
 954 001e 0A46     		mov	r2, r1
 955              	.LVL81:
 956              		.loc 1 1067 14 view .LVU212
ARM GAS  /tmp/ccIGV0Yw.s 			page 38


 957 0020 1021     		movs	r1, #16
 958              	.LVL82:
 959              		.loc 1 1067 14 view .LVU213
 960 0022 6046     		mov	r0, ip
 961              	.LVL83:
 962              		.loc 1 1067 14 view .LVU214
 963 0024 FFF7FEFF 		bl	SecureElementAesEncrypt
 964              	.LVL84:
1068:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 965              		.loc 1 1068 5 is_stmt 1 view .LVU215
 966              		.loc 1 1068 7 is_stmt 0 view .LVU216
 967 0028 08B1     		cbz	r0, .L78
 968              	.LVL85:
 969              	.L70:
1069:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1070:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
1071:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1072:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1073:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Store key
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementSetKey( targetKeyID, key );
1075:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
1076:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1077:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
1078:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1079:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1080:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
1081:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
1082:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
1083:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
1084:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
1085:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Key derivation */
1086:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM            mech = {CKM_AES_ECB_ENCRYPT_DATA, input, SE_KEY_SIZE};
1087:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE  derived_object_handle;
1088:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE    rootkey_object_handle;
1089:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t specific_label[] = {GlobalTemplateLabel, 0UL};
1090:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE DeriveKey_template = {CKA_LABEL, (CK_VOID_PTR)specific_label, sizeof(specific_labe
1091:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1092:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Derive key */
1093:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetKeyIndexByID(rootKeyID, &rootkey_object_handle))
1094:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1095:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
1096:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1097:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1098:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetKeyIndexByID(targetKeyID, &derived_object_handle))
1099:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1100:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
1101:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1102:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1103:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != SecureElementDeleteDynamicKeys(targetKeyID, &specific_label[1]))
1104:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1105:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
1106:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1107:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1108:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
1109:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
1110:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1111:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Derive key with pass phrase */
ARM GAS  /tmp/ccIGV0Yw.s 			page 39


1112:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1113:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1114:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_DeriveKey(session, &(mech), rootkey_object_handle,
1115:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                          &DeriveKey_template, sizeof(DeriveKey_template) / sizeof(CK_ATTRIBUTE), &d
1116:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1117:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1118:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1119:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1120:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /* Store Derived Index in table */
1121:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SecureElementSetObjHandler(targetKeyID, derived_object_handle);
1122:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1123:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1124:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(targetKeyID);
1125:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1126:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close session with KMS */
1127:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
1128:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1129:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
1130:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1131:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
1132:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1133:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
1134:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
1135:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 970              		.loc 1 1135 1 view .LVU217
 971 002a 04B0     		add	sp, sp, #16
 972              	.LCFI30:
 973              		.cfi_remember_state
 974              		.cfi_def_cfa_offset 8
 975              		@ sp needed
 976 002c 10BD     		pop	{r4, pc}
 977              	.LVL86:
 978              	.L78:
 979              	.LCFI31:
 980              		.cfi_restore_state
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 981              		.loc 1 1074 5 is_stmt 1 view .LVU218
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 982              		.loc 1 1074 14 is_stmt 0 view .LVU219
 983 002e 6946     		mov	r1, sp
 984 0030 2046     		mov	r0, r4
 985              	.LVL87:
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 986              		.loc 1 1074 14 view .LVU220
 987 0032 FFF7FEFF 		bl	SecureElementSetKey
 988              	.LVL88:
1075:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 989              		.loc 1 1075 5 is_stmt 1 view .LVU221
 990 0036 F8E7     		b	.L70
 991              	.LVL89:
 992              	.L72:
 993              	.LCFI32:
 994              		.cfi_def_cfa_offset 0
 995              		.cfi_restore 4
 996              		.cfi_restore 14
1050:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 997              		.loc 1 1050 16 is_stmt 0 view .LVU222
ARM GAS  /tmp/ccIGV0Yw.s 			page 40


 998 0038 0220     		movs	r0, #2
 999              	.LVL90:
 1000              		.loc 1 1135 1 view .LVU223
 1001 003a 7047     		bx	lr
 1002              	.LVL91:
 1003              	.L73:
 1004              	.LCFI33:
 1005              		.cfi_def_cfa_offset 24
 1006              		.cfi_offset 4, -8
 1007              		.cfi_offset 14, -4
1060:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1008              		.loc 1 1060 20 view .LVU224
 1009 003c 0320     		movs	r0, #3
 1010              	.LVL92:
1060:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1011              		.loc 1 1060 20 view .LVU225
 1012 003e F4E7     		b	.L70
 1013              		.cfi_endproc
 1014              	.LFE114:
 1016              		.section	.text.SecureElementProcessJoinAccept,"ax",%progbits
 1017              		.align	1
 1018              		.global	SecureElementProcessJoinAccept
 1019              		.syntax unified
 1020              		.thumb
 1021              		.thumb_func
 1022              		.fpu softvfp
 1024              	SecureElementProcessJoinAccept:
 1025              	.LVL93:
 1026              	.LFB115:
1136:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1137:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementProcessJoinAccept( JoinReqIdentifier_t joinReqType, uint8_t* joi
1138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       uint16_t devNonce, uint8_t* encJoinAccept,
1139:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       uint8_t encJoinAcceptSize, uint8_t* decJoinAc
1140:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       uint8_t* versionMinor )
1141:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1027              		.loc 1 1141 1 is_stmt 1 view -0
 1028              		.cfi_startproc
 1029              		@ args = 12, pretend = 0, frame = 0
 1030              		@ frame_needed = 0, uses_anonymous_args = 0
 1031              		.loc 1 1141 1 is_stmt 0 view .LVU227
 1032 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1033              	.LCFI34:
 1034              		.cfi_def_cfa_offset 24
 1035              		.cfi_offset 4, -24
 1036              		.cfi_offset 5, -20
 1037              		.cfi_offset 6, -16
 1038              		.cfi_offset 7, -12
 1039              		.cfi_offset 8, -8
 1040              		.cfi_offset 14, -4
 1041 0004 9DF81840 		ldrb	r4, [sp, #24]	@ zero_extendqisi2
 1042 0008 079D     		ldr	r5, [sp, #28]
 1043 000a 089E     		ldr	r6, [sp, #32]
1142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( encJoinAccept == NULL ) || ( decJoinAccept == NULL ) || ( versionMinor == NULL ) )
 1044              		.loc 1 1142 5 is_stmt 1 view .LVU228
 1045              		.loc 1 1142 7 is_stmt 0 view .LVU229
 1046 000c 7BB3     		cbz	r3, .L81
 1047 000e 9846     		mov	r8, r3
ARM GAS  /tmp/ccIGV0Yw.s 			page 41


 1048              		.loc 1 1142 35 discriminator 1 view .LVU230
 1049 0010 7DB3     		cbz	r5, .L82
 1050              		.loc 1 1142 64 discriminator 2 view .LVU231
 1051 0012 86B3     		cbz	r6, .L83
1143:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1145:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1147:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Check that frame size isn't bigger than a JoinAccept with CFList size
1148:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( encJoinAcceptSize > LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE )
 1052              		.loc 1 1148 5 is_stmt 1 view .LVU232
 1053              		.loc 1 1148 7 is_stmt 0 view .LVU233
 1054 0014 212C     		cmp	r4, #33
 1055 0016 30D8     		bhi	.L84
1149:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_BUF_SIZE;
1151:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1152:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1153:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Determine decryption key
1154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     KeyIdentifier_t encKeyID = NWK_KEY;
 1056              		.loc 1 1154 5 is_stmt 1 view .LVU234
 1057              	.LVL94:
1155:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1156:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* ST_WORKAROUND_BEGIN: Keep NWK_KEY if 1.1.x keys are not defined */
1157:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( joinReqType != JOIN_REQ )
1159:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1160:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         encKeyID = J_S_ENC_KEY;
1161:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1163:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1164:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( decJoinAccept, encJoinAccept, encJoinAcceptSize );
 1058              		.loc 1 1164 5 view .LVU235
 1059 0018 A7B2     		uxth	r7, r4
 1060 001a 3A46     		mov	r2, r7
 1061              	.LVL95:
 1062              		.loc 1 1164 5 is_stmt 0 view .LVU236
 1063 001c 1946     		mov	r1, r3
 1064              	.LVL96:
 1065              		.loc 1 1164 5 view .LVU237
 1066 001e 2846     		mov	r0, r5
 1067              	.LVL97:
 1068              		.loc 1 1164 5 view .LVU238
 1069 0020 FFF7FEFF 		bl	memcpy1
 1070              	.LVL98:
1165:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Decrypt JoinAccept, skip MHDR
1167:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( SecureElementAesEncrypt( encJoinAccept + LORAMAC_MHDR_FIELD_SIZE, encJoinAcceptSize - LORAM
 1071              		.loc 1 1167 5 is_stmt 1 view .LVU239
 1072              		.loc 1 1167 9 is_stmt 0 view .LVU240
 1073 0024 791E     		subs	r1, r7, #1
 1074 0026 6B1C     		adds	r3, r5, #1
 1075 0028 0122     		movs	r2, #1
 1076 002a 89B2     		uxth	r1, r1
 1077 002c 08EB0200 		add	r0, r8, r2
 1078 0030 FFF7FEFF 		bl	SecureElementAesEncrypt
 1079              	.LVL99:
ARM GAS  /tmp/ccIGV0Yw.s 			page 42


 1080              		.loc 1 1167 7 view .LVU241
 1081 0034 20BB     		cbnz	r0, .L85
1168:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                  encKeyID, decJoinAccept + LORAMAC_MHDR_FIELD_SIZE ) != SECURE_ELEM
1169:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_FAIL_ENCRYPT;
1171:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1173:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *versionMinor = ( ( decJoinAccept[11] & 0x80 ) == 0x80 ) ? 1 : 0;
 1082              		.loc 1 1173 5 is_stmt 1 view .LVU242
 1083              		.loc 1 1173 66 is_stmt 0 view .LVU243
 1084 0036 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 1085 0038 DB09     		lsrs	r3, r3, #7
 1086              		.loc 1 1173 19 view .LVU244
 1087 003a 3370     		strb	r3, [r6]
1174:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1175:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t mic = 0;
 1088              		.loc 1 1175 5 is_stmt 1 view .LVU245
 1089              	.LVL100:
1176:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1177:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic = ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE] << 0 );
 1090              		.loc 1 1177 5 view .LVU246
 1091              		.loc 1 1177 39 is_stmt 0 view .LVU247
 1092 003c 2C44     		add	r4, r4, r5
 1093 003e 14F8042C 		ldrb	r2, [r4, #-4]	@ zero_extendqisi2
 1094              	.LVL101:
1178:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic |= ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE + 1] << 8 );
 1095              		.loc 1 1178 5 is_stmt 1 view .LVU248
 1096              		.loc 1 1178 40 is_stmt 0 view .LVU249
 1097 0042 14F8031C 		ldrb	r1, [r4, #-3]	@ zero_extendqisi2
 1098              		.loc 1 1178 9 view .LVU250
 1099 0046 42EA0122 		orr	r2, r2, r1, lsl #8
 1100              	.LVL102:
1179:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic |= ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE + 2] << 16 );
 1101              		.loc 1 1179 5 is_stmt 1 view .LVU251
 1102              		.loc 1 1179 40 is_stmt 0 view .LVU252
 1103 004a 14F8021C 		ldrb	r1, [r4, #-2]	@ zero_extendqisi2
 1104              		.loc 1 1179 9 view .LVU253
 1105 004e 42EA0142 		orr	r2, r2, r1, lsl #16
 1106              	.LVL103:
1180:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic |= ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE + 3] << 24 );
 1107              		.loc 1 1180 5 is_stmt 1 view .LVU254
 1108              		.loc 1 1180 40 is_stmt 0 view .LVU255
 1109 0052 14F8011C 		ldrb	r1, [r4, #-1]	@ zero_extendqisi2
 1110              		.loc 1 1180 9 view .LVU256
 1111 0056 42EA0162 		orr	r2, r2, r1, lsl #24
 1112              	.LVL104:
1181:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1182:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     //  - Header buffer to be used for MIC computation
1183:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     //        - LoRaWAN 1.0.x : micHeader = [MHDR(1)]
1184:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     //        - LoRaWAN 1.1.x : micHeader = [JoinReqType(1), JoinEUI(8), DevNonce(2), MHDR(1)]
1185:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1186:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Verify mic
1187:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( *versionMinor == 0 )
 1113              		.loc 1 1187 5 is_stmt 1 view .LVU257
 1114              		.loc 1 1187 7 is_stmt 0 view .LVU258
 1115 005a 9BB9     		cbnz	r3, .L86
1188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
ARM GAS  /tmp/ccIGV0Yw.s 			page 43


1189:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // For LoRaWAN 1.0.x
1190:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   cmac = aes128_cmac(NwkKey, MHDR |  JoinNonce | NetID | DevAddr | DLSettings | RxDelay 
1191:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   CFListType)
1192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SecureElementVerifyAesCmac( decJoinAccept, ( encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE
 1116              		.loc 1 1192 9 is_stmt 1 view .LVU259
 1117              		.loc 1 1192 13 is_stmt 0 view .LVU260
 1118 005c 391F     		subs	r1, r7, #4
 1119 005e 0123     		movs	r3, #1
 1120 0060 89B2     		uxth	r1, r1
 1121 0062 2846     		mov	r0, r5
 1122 0064 FFF7FEFF 		bl	SecureElementVerifyAesCmac
 1123              	.LVL105:
 1124              		.loc 1 1192 11 view .LVU261
 1125 0068 40B1     		cbz	r0, .L80
1193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             SECURE_ELEMENT_SUCCESS )
1194:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
1195:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_FAIL_CMAC;
 1126              		.loc 1 1195 20 view .LVU262
 1127 006a 0120     		movs	r0, #1
 1128 006c 06E0     		b	.L80
 1129              	.LVL106:
 1130              	.L81:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1131              		.loc 1 1144 16 view .LVU263
 1132 006e 0220     		movs	r0, #2
 1133              	.LVL107:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1134              		.loc 1 1144 16 view .LVU264
 1135 0070 04E0     		b	.L80
 1136              	.LVL108:
 1137              	.L82:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1138              		.loc 1 1144 16 view .LVU265
 1139 0072 0220     		movs	r0, #2
 1140              	.LVL109:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1141              		.loc 1 1144 16 view .LVU266
 1142 0074 02E0     		b	.L80
 1143              	.LVL110:
 1144              	.L83:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1145              		.loc 1 1144 16 view .LVU267
 1146 0076 0220     		movs	r0, #2
 1147              	.LVL111:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1148              		.loc 1 1144 16 view .LVU268
 1149 0078 00E0     		b	.L80
 1150              	.LVL112:
 1151              	.L84:
1150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1152              		.loc 1 1150 16 view .LVU269
 1153 007a 0520     		movs	r0, #5
 1154              	.LVL113:
 1155              	.L80:
1196:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
1197:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1198:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
ARM GAS  /tmp/ccIGV0Yw.s 			page 44


1199:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     else if( *versionMinor == 1 )
1200:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1201:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t  micHeader11[JOIN_ACCEPT_MIC_COMPUTATION_OFFSET] = { 0 };
1202:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint16_t bufItr                                          = 0;
1203:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1204:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         micHeader11[bufItr++] = ( uint8_t ) joinReqType;
1205:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1206:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpyr( micHeader11 + bufItr, joinEui, LORAMAC_JOIN_EUI_FIELD_SIZE );
1207:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         bufItr += LORAMAC_JOIN_EUI_FIELD_SIZE;
1208:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1209:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         micHeader11[bufItr++] = devNonce & 0xFF;
1210:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         micHeader11[bufItr++] = ( devNonce >> 8 ) & 0xFF;
1211:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1212:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // For LoRaWAN 1.1.x and later:
1213:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   cmac = aes128_cmac(JSIntKey, JoinReqType | JoinEUI | DevNonce | MHDR | JoinNonce | Net
1214:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   DLSettings | RxDelay | CFList | CFListType)
1215:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Prepare the msg for integrity check (adding JoinReqType, JoinEUI and DevNonce)
1216:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t localBuffer[LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE + JOIN_ACCEPT_MIC_COMPUTATION_OFFSET
1217:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1218:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1( localBuffer, micHeader11, JOIN_ACCEPT_MIC_COMPUTATION_OFFSET );
1219:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1( localBuffer + JOIN_ACCEPT_MIC_COMPUTATION_OFFSET - 1, decJoinAccept, encJoinAccept
1220:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1221:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SecureElementVerifyAesCmac( localBuffer,
1222:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                         encJoinAcceptSize + JOIN_ACCEPT_MIC_COMPUTATION_OFFSET -
1223:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                             LORAMAC_MHDR_FIELD_SIZE - LORAMAC_MIC_FIELD_SIZE,
1224:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                         mic, J_S_INT_KEY ) != SECURE_ELEMENT_SUCCESS )
1225:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
1226:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_FAIL_CMAC;
1227:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
1228:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1229:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1230:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     else
1231:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1232:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_INVALID_LORAWAM_SPEC_VERSION;
1233:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1234:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1235:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
1236:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1156              		.loc 1 1236 1 view .LVU270
 1157 007c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1158              	.LVL114:
 1159              	.L85:
1170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1160              		.loc 1 1170 16 view .LVU271
 1161 0080 0720     		movs	r0, #7
 1162 0082 FBE7     		b	.L80
 1163              	.LVL115:
 1164              	.L86:
1232:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1165              		.loc 1 1232 16 view .LVU272
 1166 0084 0420     		movs	r0, #4
 1167 0086 F9E7     		b	.L80
 1168              		.cfi_endproc
 1169              	.LFE115:
 1171              		.section	.text.SecureElementRandomNumber,"ax",%progbits
 1172              		.align	1
 1173              		.global	SecureElementRandomNumber
ARM GAS  /tmp/ccIGV0Yw.s 			page 45


 1174              		.syntax unified
 1175              		.thumb
 1176              		.thumb_func
 1177              		.fpu softvfp
 1179              	SecureElementRandomNumber:
 1180              	.LVL116:
 1181              	.LFB116:
1237:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1238:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementRandomNumber( uint32_t* randomNum )
1239:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1182              		.loc 1 1239 1 is_stmt 1 view -0
 1183              		.cfi_startproc
 1184              		@ args = 0, pretend = 0, frame = 0
 1185              		@ frame_needed = 0, uses_anonymous_args = 0
1240:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( randomNum == NULL )
 1186              		.loc 1 1240 5 view .LVU274
 1187              		.loc 1 1240 7 is_stmt 0 view .LVU275
 1188 0000 38B1     		cbz	r0, .L91
1239:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( randomNum == NULL )
 1189              		.loc 1 1239 1 view .LVU276
 1190 0002 10B5     		push	{r4, lr}
 1191              	.LCFI35:
 1192              		.cfi_def_cfa_offset 8
 1193              		.cfi_offset 4, -8
 1194              		.cfi_offset 14, -4
 1195 0004 0446     		mov	r4, r0
1241:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1242:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1243:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1244:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *randomNum = Radio.Random();
 1196              		.loc 1 1244 5 is_stmt 1 view .LVU277
 1197              		.loc 1 1244 23 is_stmt 0 view .LVU278
 1198 0006 044B     		ldr	r3, .L96
 1199 0008 5B69     		ldr	r3, [r3, #20]
 1200              		.loc 1 1244 18 view .LVU279
 1201 000a 9847     		blx	r3
 1202              	.LVL117:
 1203              		.loc 1 1244 16 view .LVU280
 1204 000c 2060     		str	r0, [r4]
1245:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 1205              		.loc 1 1245 5 is_stmt 1 view .LVU281
 1206              		.loc 1 1245 12 is_stmt 0 view .LVU282
 1207 000e 0020     		movs	r0, #0
1246:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1208              		.loc 1 1246 1 view .LVU283
 1209 0010 10BD     		pop	{r4, pc}
 1210              	.LVL118:
 1211              	.L91:
 1212              	.LCFI36:
 1213              		.cfi_def_cfa_offset 0
 1214              		.cfi_restore 4
 1215              		.cfi_restore 14
1242:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1216              		.loc 1 1242 16 view .LVU284
 1217 0012 0220     		movs	r0, #2
 1218              	.LVL119:
 1219              		.loc 1 1246 1 view .LVU285
ARM GAS  /tmp/ccIGV0Yw.s 			page 46


 1220 0014 7047     		bx	lr
 1221              	.L97:
 1222 0016 00BF     		.align	2
 1223              	.L96:
 1224 0018 00000000 		.word	Radio
 1225              		.cfi_endproc
 1226              	.LFE116:
 1228              		.section	.text.SecureElementSetDevEui,"ax",%progbits
 1229              		.align	1
 1230              		.global	SecureElementSetDevEui
 1231              		.syntax unified
 1232              		.thumb
 1233              		.thumb_func
 1234              		.fpu softvfp
 1236              	SecureElementSetDevEui:
 1237              	.LVL120:
 1238              	.LFB117:
1247:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1248:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetDevEui( uint8_t* devEui )
1249:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1239              		.loc 1 1249 1 is_stmt 1 view -0
 1240              		.cfi_startproc
 1241              		@ args = 0, pretend = 0, frame = 0
 1242              		@ frame_needed = 0, uses_anonymous_args = 0
1250:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( devEui == NULL )
 1243              		.loc 1 1250 5 view .LVU287
 1244              		.loc 1 1250 7 is_stmt 0 view .LVU288
 1245 0000 40B1     		cbz	r0, .L100
1249:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( devEui == NULL )
 1246              		.loc 1 1249 1 view .LVU289
 1247 0002 08B5     		push	{r3, lr}
 1248              	.LCFI37:
 1249              		.cfi_def_cfa_offset 8
 1250              		.cfi_offset 3, -8
 1251              		.cfi_offset 14, -4
 1252 0004 0146     		mov	r1, r0
1251:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1252:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1253:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1254:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( SeNvm->DevEui, devEui, SE_EUI_SIZE );
 1253              		.loc 1 1254 5 is_stmt 1 view .LVU290
 1254 0006 0822     		movs	r2, #8
 1255 0008 034B     		ldr	r3, .L105
 1256 000a 1868     		ldr	r0, [r3]
 1257              	.LVL121:
 1258              		.loc 1 1254 5 is_stmt 0 view .LVU291
 1259 000c FFF7FEFF 		bl	memcpy1
 1260              	.LVL122:
1255:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 1261              		.loc 1 1255 5 is_stmt 1 view .LVU292
 1262              		.loc 1 1255 12 is_stmt 0 view .LVU293
 1263 0010 0020     		movs	r0, #0
1256:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1264              		.loc 1 1256 1 view .LVU294
 1265 0012 08BD     		pop	{r3, pc}
 1266              	.LVL123:
 1267              	.L100:
ARM GAS  /tmp/ccIGV0Yw.s 			page 47


 1268              	.LCFI38:
 1269              		.cfi_def_cfa_offset 0
 1270              		.cfi_restore 3
 1271              		.cfi_restore 14
1252:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1272              		.loc 1 1252 16 view .LVU295
 1273 0014 0220     		movs	r0, #2
 1274              	.LVL124:
 1275              		.loc 1 1256 1 view .LVU296
 1276 0016 7047     		bx	lr
 1277              	.L106:
 1278              		.align	2
 1279              	.L105:
 1280 0018 00000000 		.word	.LANCHOR0
 1281              		.cfi_endproc
 1282              	.LFE117:
 1284              		.section	.text.SecureElementGetDevEui,"ax",%progbits
 1285              		.align	1
 1286              		.global	SecureElementGetDevEui
 1287              		.syntax unified
 1288              		.thumb
 1289              		.thumb_func
 1290              		.fpu softvfp
 1292              	SecureElementGetDevEui:
 1293              	.LFB118:
1257:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1258:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** uint8_t* SecureElementGetDevEui( void )
1259:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1294              		.loc 1 1259 1 is_stmt 1 view -0
 1295              		.cfi_startproc
 1296              		@ args = 0, pretend = 0, frame = 0
 1297              		@ frame_needed = 0, uses_anonymous_args = 0
 1298              		@ link register save eliminated.
1260:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SeNvm->DevEui;
 1299              		.loc 1 1260 5 view .LVU298
1261:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1300              		.loc 1 1261 1 is_stmt 0 view .LVU299
 1301 0000 014B     		ldr	r3, .L108
 1302 0002 1868     		ldr	r0, [r3]
 1303 0004 7047     		bx	lr
 1304              	.L109:
 1305 0006 00BF     		.align	2
 1306              	.L108:
 1307 0008 00000000 		.word	.LANCHOR0
 1308              		.cfi_endproc
 1309              	.LFE118:
 1311              		.section	.text.SecureElementSetJoinEui,"ax",%progbits
 1312              		.align	1
 1313              		.global	SecureElementSetJoinEui
 1314              		.syntax unified
 1315              		.thumb
 1316              		.thumb_func
 1317              		.fpu softvfp
 1319              	SecureElementSetJoinEui:
 1320              	.LVL125:
 1321              	.LFB119:
1262:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
ARM GAS  /tmp/ccIGV0Yw.s 			page 48


1263:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetJoinEui( uint8_t* joinEui )
1264:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1322              		.loc 1 1264 1 is_stmt 1 view -0
 1323              		.cfi_startproc
 1324              		@ args = 0, pretend = 0, frame = 0
 1325              		@ frame_needed = 0, uses_anonymous_args = 0
1265:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( joinEui == NULL )
 1326              		.loc 1 1265 5 view .LVU301
 1327              		.loc 1 1265 7 is_stmt 0 view .LVU302
 1328 0000 48B1     		cbz	r0, .L112
1264:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( joinEui == NULL )
 1329              		.loc 1 1264 1 view .LVU303
 1330 0002 08B5     		push	{r3, lr}
 1331              	.LCFI39:
 1332              		.cfi_def_cfa_offset 8
 1333              		.cfi_offset 3, -8
 1334              		.cfi_offset 14, -4
 1335 0004 0146     		mov	r1, r0
1266:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1267:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1268:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1269:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( SeNvm->JoinEui, joinEui, SE_EUI_SIZE );
 1336              		.loc 1 1269 5 is_stmt 1 view .LVU304
 1337              		.loc 1 1269 19 is_stmt 0 view .LVU305
 1338 0006 054B     		ldr	r3, .L117
 1339 0008 1868     		ldr	r0, [r3]
 1340              	.LVL126:
 1341              		.loc 1 1269 5 view .LVU306
 1342 000a 0822     		movs	r2, #8
 1343 000c 1044     		add	r0, r0, r2
 1344 000e FFF7FEFF 		bl	memcpy1
 1345              	.LVL127:
1270:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 1346              		.loc 1 1270 5 is_stmt 1 view .LVU307
 1347              		.loc 1 1270 12 is_stmt 0 view .LVU308
 1348 0012 0020     		movs	r0, #0
1271:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1349              		.loc 1 1271 1 view .LVU309
 1350 0014 08BD     		pop	{r3, pc}
 1351              	.LVL128:
 1352              	.L112:
 1353              	.LCFI40:
 1354              		.cfi_def_cfa_offset 0
 1355              		.cfi_restore 3
 1356              		.cfi_restore 14
1267:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1357              		.loc 1 1267 16 view .LVU310
 1358 0016 0220     		movs	r0, #2
 1359              	.LVL129:
 1360              		.loc 1 1271 1 view .LVU311
 1361 0018 7047     		bx	lr
 1362              	.L118:
 1363 001a 00BF     		.align	2
 1364              	.L117:
 1365 001c 00000000 		.word	.LANCHOR0
 1366              		.cfi_endproc
 1367              	.LFE119:
ARM GAS  /tmp/ccIGV0Yw.s 			page 49


 1369              		.section	.text.SecureElementGetJoinEui,"ax",%progbits
 1370              		.align	1
 1371              		.global	SecureElementGetJoinEui
 1372              		.syntax unified
 1373              		.thumb
 1374              		.thumb_func
 1375              		.fpu softvfp
 1377              	SecureElementGetJoinEui:
 1378              	.LFB120:
1272:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1273:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** uint8_t* SecureElementGetJoinEui( void )
1274:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1379              		.loc 1 1274 1 is_stmt 1 view -0
 1380              		.cfi_startproc
 1381              		@ args = 0, pretend = 0, frame = 0
 1382              		@ frame_needed = 0, uses_anonymous_args = 0
 1383              		@ link register save eliminated.
1275:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SeNvm->JoinEui;
 1384              		.loc 1 1275 5 view .LVU313
 1385              		.loc 1 1275 17 is_stmt 0 view .LVU314
 1386 0000 014B     		ldr	r3, .L120
 1387 0002 1868     		ldr	r0, [r3]
1276:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1388              		.loc 1 1276 1 view .LVU315
 1389 0004 0830     		adds	r0, r0, #8
 1390 0006 7047     		bx	lr
 1391              	.L121:
 1392              		.align	2
 1393              	.L120:
 1394 0008 00000000 		.word	.LANCHOR0
 1395              		.cfi_endproc
 1396              	.LFE120:
 1398              		.section	.rodata
 1399              		.align	2
 1400              		.set	.LANCHOR1,. + 0
 1401              	.LC0:
 1402 0000 0080E101 		.ascii	"\000\200\341\001\001\001\001\001"
 1402      01010101 
 1403              		.section	.bss.SeNvm,"aw",%nobits
 1404              		.align	2
 1405              		.set	.LANCHOR0,. + 0
 1408              	SeNvm:
 1409 0000 00000000 		.space	4
 1410              		.text
 1411              	.Letext0:
 1412              		.file 2 "/home/eatkinso/Downloads/gcc-arm-none-eabi-10.3-2021.07/gcc-arm-none-eabi-10.3-2021.07/ar
 1413              		.file 3 "/home/eatkinso/Downloads/gcc-arm-none-eabi-10.3-2021.07/gcc-arm-none-eabi-10.3-2021.07/ar
 1414              		.file 4 "Middlewares/Third_Party/SubGHz_Phy/radio.h"
 1415              		.file 5 "Middlewares/Third_Party/SubGHz_Phy/radio_ex.h"
 1416              		.file 6 "Middlewares/Third_Party/LoRaWAN/Crypto/lorawan_aes.h"
 1417              		.file 7 "Middlewares/Third_Party/LoRaWAN/Crypto/cmac.h"
 1418              		.file 8 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacTypes.h"
 1419              		.file 9 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element-nvm.h"
 1420              		.file 10 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element.h"
 1421              		.file 11 "Middlewares/Third_Party/LoRaWAN/Utilities/utilities.h"
 1422              		.file 12 "<built-in>"
ARM GAS  /tmp/ccIGV0Yw.s 			page 50


DEFINED SYMBOLS
                            *ABS*:0000000000000000 soft-se.c
     /tmp/ccIGV0Yw.s:16     .text.GetKeyByID:0000000000000000 $t
     /tmp/ccIGV0Yw.s:23     .text.GetKeyByID:0000000000000000 GetKeyByID
     /tmp/ccIGV0Yw.s:117    .text.GetKeyByID:000000000000003c $d
     /tmp/ccIGV0Yw.s:122    .text.ComputeCmac:0000000000000000 $t
     /tmp/ccIGV0Yw.s:128    .text.ComputeCmac:0000000000000000 ComputeCmac
     /tmp/ccIGV0Yw.s:255    .rodata.SecureElementInit.str1.4:0000000000000000 $d
     /tmp/ccIGV0Yw.s:262    .text.SecureElementInit:0000000000000000 $t
     /tmp/ccIGV0Yw.s:269    .text.SecureElementInit:0000000000000000 SecureElementInit
     /tmp/ccIGV0Yw.s:393    .text.SecureElementInit:00000000000000d8 $d
     /tmp/ccIGV0Yw.s:401    .text.SecureElementGetKeyByID:0000000000000000 $t
     /tmp/ccIGV0Yw.s:408    .text.SecureElementGetKeyByID:0000000000000000 SecureElementGetKeyByID
     /tmp/ccIGV0Yw.s:426    .text.SecureElementDeleteDynamicKeys:0000000000000000 $t
     /tmp/ccIGV0Yw.s:433    .text.SecureElementDeleteDynamicKeys:0000000000000000 SecureElementDeleteDynamicKeys
     /tmp/ccIGV0Yw.s:451    .text.SecureElementSetObjHandler:0000000000000000 $t
     /tmp/ccIGV0Yw.s:458    .text.SecureElementSetObjHandler:0000000000000000 SecureElementSetObjHandler
     /tmp/ccIGV0Yw.s:476    .text.SecureElementComputeAesCmac:0000000000000000 $t
     /tmp/ccIGV0Yw.s:483    .text.SecureElementComputeAesCmac:0000000000000000 SecureElementComputeAesCmac
     /tmp/ccIGV0Yw.s:528    .text.SecureElementVerifyAesCmac:0000000000000000 $t
     /tmp/ccIGV0Yw.s:535    .text.SecureElementVerifyAesCmac:0000000000000000 SecureElementVerifyAesCmac
     /tmp/ccIGV0Yw.s:608    .text.SecureElementAesEncrypt:0000000000000000 $t
     /tmp/ccIGV0Yw.s:615    .text.SecureElementAesEncrypt:0000000000000000 SecureElementAesEncrypt
     /tmp/ccIGV0Yw.s:748    .text.SecureElementSetKey:0000000000000000 $t
     /tmp/ccIGV0Yw.s:755    .text.SecureElementSetKey:0000000000000000 SecureElementSetKey
     /tmp/ccIGV0Yw.s:900    .text.SecureElementSetKey:0000000000000080 $d
     /tmp/ccIGV0Yw.s:905    .text.SecureElementDeriveAndStoreKey:0000000000000000 $t
     /tmp/ccIGV0Yw.s:912    .text.SecureElementDeriveAndStoreKey:0000000000000000 SecureElementDeriveAndStoreKey
     /tmp/ccIGV0Yw.s:1017   .text.SecureElementProcessJoinAccept:0000000000000000 $t
     /tmp/ccIGV0Yw.s:1024   .text.SecureElementProcessJoinAccept:0000000000000000 SecureElementProcessJoinAccept
     /tmp/ccIGV0Yw.s:1172   .text.SecureElementRandomNumber:0000000000000000 $t
     /tmp/ccIGV0Yw.s:1179   .text.SecureElementRandomNumber:0000000000000000 SecureElementRandomNumber
     /tmp/ccIGV0Yw.s:1224   .text.SecureElementRandomNumber:0000000000000018 $d
     /tmp/ccIGV0Yw.s:1229   .text.SecureElementSetDevEui:0000000000000000 $t
     /tmp/ccIGV0Yw.s:1236   .text.SecureElementSetDevEui:0000000000000000 SecureElementSetDevEui
     /tmp/ccIGV0Yw.s:1280   .text.SecureElementSetDevEui:0000000000000018 $d
     /tmp/ccIGV0Yw.s:1285   .text.SecureElementGetDevEui:0000000000000000 $t
     /tmp/ccIGV0Yw.s:1292   .text.SecureElementGetDevEui:0000000000000000 SecureElementGetDevEui
     /tmp/ccIGV0Yw.s:1307   .text.SecureElementGetDevEui:0000000000000008 $d
     /tmp/ccIGV0Yw.s:1312   .text.SecureElementSetJoinEui:0000000000000000 $t
     /tmp/ccIGV0Yw.s:1319   .text.SecureElementSetJoinEui:0000000000000000 SecureElementSetJoinEui
     /tmp/ccIGV0Yw.s:1365   .text.SecureElementSetJoinEui:000000000000001c $d
     /tmp/ccIGV0Yw.s:1370   .text.SecureElementGetJoinEui:0000000000000000 $t
     /tmp/ccIGV0Yw.s:1377   .text.SecureElementGetJoinEui:0000000000000000 SecureElementGetJoinEui
     /tmp/ccIGV0Yw.s:1394   .text.SecureElementGetJoinEui:0000000000000008 $d
     /tmp/ccIGV0Yw.s:1399   .rodata:0000000000000000 $d
     /tmp/ccIGV0Yw.s:1404   .bss.SeNvm:0000000000000000 $d
     /tmp/ccIGV0Yw.s:1408   .bss.SeNvm:0000000000000000 SeNvm

UNDEFINED SYMBOLS
AES_CMAC_Init
AES_CMAC_SetKey
AES_CMAC_Update
AES_CMAC_Final
memset
memcpy1
memset1
ARM GAS  /tmp/ccIGV0Yw.s 			page 51


lorawan_aes_set_key
lorawan_aes_encrypt
Radio
